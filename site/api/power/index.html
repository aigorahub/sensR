
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Thurstonian Models for Sensory Discrimination in Python">
      
      
      
        <link rel="canonical" href="https://aigorahub.github.io/sensPy/api/power/">
      
      
        <link rel="prev" href="../models/">
      
      
        <link rel="next" href="../roc/">
      
      
        
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.0">
    
    
      
        <title>Power & Sample Size - sensPy</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.618322db.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#power-sample-size" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="sensPy" class="md-header__button md-logo" aria-label="sensPy" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            sensPy
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Power & Sample Size
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/aigorahub/sensPy" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    aigorahub/sensPy
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="sensPy" class="md-nav__button md-logo" aria-label="sensPy" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    sensPy
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/aigorahub/sensPy" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    aigorahub/sensPy
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Getting Started
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Getting Started
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../getting-started/installation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Installation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../getting-started/quickstart/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Quick Start
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    User Guide
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    User Guide
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/protocols/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Discrimination Protocols
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/power/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Power Analysis
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/plotting/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Plotting
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    API Reference
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    API Reference
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../core/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Core Functions
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../discrimination/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Discrimination
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../models/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Models
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Power & Sample Size
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Power & Sample Size
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#power-analysis" class="md-nav__link">
    <span class="md-ellipsis">
      
        Power Analysis
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Power Analysis">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#discrim_power" class="md-nav__link">
    <span class="md-ellipsis">
      
        discrim_power
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#senspy.discrim_power" class="md-nav__link">
    <span class="md-ellipsis">
      
        discrim_power
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="discrim_power">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dprime_power" class="md-nav__link">
    <span class="md-ellipsis">
      
        dprime_power
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#senspy.dprime_power" class="md-nav__link">
    <span class="md-ellipsis">
      
        dprime_power
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="dprime_power">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dod_power" class="md-nav__link">
    <span class="md-ellipsis">
      
        dod_power
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#senspy.dod_power" class="md-nav__link">
    <span class="md-ellipsis">
      
        dod_power
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sample-size-calculation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Sample Size Calculation
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Sample Size Calculation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#discrim_sample_size" class="md-nav__link">
    <span class="md-ellipsis">
      
        discrim_sample_size
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#senspy.discrim_sample_size" class="md-nav__link">
    <span class="md-ellipsis">
      
        discrim_sample_size
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="discrim_sample_size">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dprime_sample_size" class="md-nav__link">
    <span class="md-ellipsis">
      
        dprime_sample_size
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#senspy.dprime_sample_size" class="md-nav__link">
    <span class="md-ellipsis">
      
        dprime_sample_size
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#d-prime-hypothesis-testing" class="md-nav__link">
    <span class="md-ellipsis">
      
        D-Prime Hypothesis Testing
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="D-Prime Hypothesis Testing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dprime_test" class="md-nav__link">
    <span class="md-ellipsis">
      
        dprime_test
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#senspy.dprime_test" class="md-nav__link">
    <span class="md-ellipsis">
      
        dprime_test
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="dprime_test">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dprime_compare" class="md-nav__link">
    <span class="md-ellipsis">
      
        dprime_compare
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#senspy.dprime_compare" class="md-nav__link">
    <span class="md-ellipsis">
      
        dprime_compare
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="dprime_compare">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#posthoc" class="md-nav__link">
    <span class="md-ellipsis">
      
        posthoc
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#senspy.posthoc" class="md-nav__link">
    <span class="md-ellipsis">
      
        posthoc
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="posthoc">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dprime_table" class="md-nav__link">
    <span class="md-ellipsis">
      
        dprime_table
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#senspy.dprime_table" class="md-nav__link">
    <span class="md-ellipsis">
      
        dprime_table
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#result-classes" class="md-nav__link">
    <span class="md-ellipsis">
      
        Result Classes
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Result Classes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dprimetestresult" class="md-nav__link">
    <span class="md-ellipsis">
      
        DprimeTestResult
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#senspy.DprimeTestResult" class="md-nav__link">
    <span class="md-ellipsis">
      
        DprimeTestResult
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DprimeTestResult">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dprimecompareresult" class="md-nav__link">
    <span class="md-ellipsis">
      
        DprimeCompareResult
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#senspy.DprimeCompareResult" class="md-nav__link">
    <span class="md-ellipsis">
      
        DprimeCompareResult
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DprimeCompareResult">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#posthocresult" class="md-nav__link">
    <span class="md-ellipsis">
      
        PosthocResult
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#senspy.PosthocResult" class="md-nav__link">
    <span class="md-ellipsis">
      
        PosthocResult
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="PosthocResult">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dodpowerresult" class="md-nav__link">
    <span class="md-ellipsis">
      
        DODPowerResult
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#senspy.DODPowerResult" class="md-nav__link">
    <span class="md-ellipsis">
      
        DODPowerResult
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../roc/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ROC & AUC
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../plotting/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Plotting
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    About
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    About
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../changelog/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Changelog
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#power-analysis" class="md-nav__link">
    <span class="md-ellipsis">
      
        Power Analysis
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Power Analysis">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#discrim_power" class="md-nav__link">
    <span class="md-ellipsis">
      
        discrim_power
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#senspy.discrim_power" class="md-nav__link">
    <span class="md-ellipsis">
      
        discrim_power
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="discrim_power">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dprime_power" class="md-nav__link">
    <span class="md-ellipsis">
      
        dprime_power
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#senspy.dprime_power" class="md-nav__link">
    <span class="md-ellipsis">
      
        dprime_power
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="dprime_power">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dod_power" class="md-nav__link">
    <span class="md-ellipsis">
      
        dod_power
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#senspy.dod_power" class="md-nav__link">
    <span class="md-ellipsis">
      
        dod_power
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sample-size-calculation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Sample Size Calculation
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Sample Size Calculation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#discrim_sample_size" class="md-nav__link">
    <span class="md-ellipsis">
      
        discrim_sample_size
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#senspy.discrim_sample_size" class="md-nav__link">
    <span class="md-ellipsis">
      
        discrim_sample_size
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="discrim_sample_size">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dprime_sample_size" class="md-nav__link">
    <span class="md-ellipsis">
      
        dprime_sample_size
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#senspy.dprime_sample_size" class="md-nav__link">
    <span class="md-ellipsis">
      
        dprime_sample_size
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#d-prime-hypothesis-testing" class="md-nav__link">
    <span class="md-ellipsis">
      
        D-Prime Hypothesis Testing
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="D-Prime Hypothesis Testing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dprime_test" class="md-nav__link">
    <span class="md-ellipsis">
      
        dprime_test
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#senspy.dprime_test" class="md-nav__link">
    <span class="md-ellipsis">
      
        dprime_test
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="dprime_test">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dprime_compare" class="md-nav__link">
    <span class="md-ellipsis">
      
        dprime_compare
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#senspy.dprime_compare" class="md-nav__link">
    <span class="md-ellipsis">
      
        dprime_compare
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="dprime_compare">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#posthoc" class="md-nav__link">
    <span class="md-ellipsis">
      
        posthoc
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#senspy.posthoc" class="md-nav__link">
    <span class="md-ellipsis">
      
        posthoc
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="posthoc">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dprime_table" class="md-nav__link">
    <span class="md-ellipsis">
      
        dprime_table
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#senspy.dprime_table" class="md-nav__link">
    <span class="md-ellipsis">
      
        dprime_table
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#result-classes" class="md-nav__link">
    <span class="md-ellipsis">
      
        Result Classes
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Result Classes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dprimetestresult" class="md-nav__link">
    <span class="md-ellipsis">
      
        DprimeTestResult
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#senspy.DprimeTestResult" class="md-nav__link">
    <span class="md-ellipsis">
      
        DprimeTestResult
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DprimeTestResult">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dprimecompareresult" class="md-nav__link">
    <span class="md-ellipsis">
      
        DprimeCompareResult
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#senspy.DprimeCompareResult" class="md-nav__link">
    <span class="md-ellipsis">
      
        DprimeCompareResult
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DprimeCompareResult">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#posthocresult" class="md-nav__link">
    <span class="md-ellipsis">
      
        PosthocResult
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#senspy.PosthocResult" class="md-nav__link">
    <span class="md-ellipsis">
      
        PosthocResult
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="PosthocResult">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dodpowerresult" class="md-nav__link">
    <span class="md-ellipsis">
      
        DODPowerResult
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#senspy.DODPowerResult" class="md-nav__link">
    <span class="md-ellipsis">
      
        DODPowerResult
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="power-sample-size">Power &amp; Sample Size</h1>
<h2 id="power-analysis">Power Analysis</h2>
<h3 id="discrim_power">discrim_power</h3>


<div class="doc doc-object doc-function">


<h2 id="senspy.discrim_power" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">discrim_power</span><span class="p">(</span><span class="n">pd_a</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">sample_size</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">pd_0</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">alpha</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">,</span> <span class="n">p_guess</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">test</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;difference&#39;</span><span class="p">,</span> <span class="n">statistic</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;exact&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span></code>

</h2>


    <div class="doc doc-contents first">

        <p>Compute power for a discrimination test.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>pd_a</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True proportion of discriminators (alternative hypothesis).
Must be between 0 and 1.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>sample_size</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of trials in the experiment.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>pd_0</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Null hypothesis proportion of discriminators.</p>
              </div>
            </td>
            <td>
                  <code>0.0</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>alpha</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Significance level (Type I error rate).</p>
              </div>
            </td>
            <td>
                  <code>0.05</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>p_guess</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Guessing probability for the protocol (e.g., 1/3 for triangle).</p>
              </div>
            </td>
            <td>
                  <code>0.5</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>test</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Type of test: "difference" (H1: pd &gt; pd_0) or
"similarity" (H1: pd &lt; pd_0).</p>
              </div>
            </td>
            <td>
                  <code>&#34;difference&#34;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>statistic</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Method for computing power:
- "exact": Exact binomial test
- "normal": Normal approximation
- "cont.normal": Normal approximation with continuity correction</p>
              </div>
            </td>
            <td>
                  <code>&#34;exact&#34;</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Statistical power (probability of rejecting H0 when H1 is true).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Power for triangle test with 30% discriminators, n=100</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">discrim_power</span><span class="p">(</span><span class="n">pd_a</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">sample_size</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">p_guess</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="go">0.869...</span>
</code></pre></div>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Power for similarity test</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">discrim_power</span><span class="p">(</span><span class="n">pd_a</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">sample_size</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">pd_0</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">... </span>              <span class="n">p_guess</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="n">test</span><span class="o">=</span><span class="s2">&quot;similarity&quot;</span><span class="p">)</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="go">0.78...</span>
</code></pre></div>


<details class="note" open>
  <summary>Notes</summary>
  <p>Corresponds to <code>discrimPwr()</code> in sensR.</p>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>senspy/power.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-142" name="__codelineno-0-142"></a><span class="k">def</span><span class="w"> </span><span class="nf">discrim_power</span><span class="p">(</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a>    <span class="n">pd_a</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a>    <span class="n">sample_size</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a>    <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a>    <span class="n">pd_0</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a>    <span class="n">alpha</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">,</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a>    <span class="n">p_guess</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a>    <span class="n">test</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;difference&quot;</span><span class="p">,</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a>    <span class="n">statistic</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;exact&quot;</span><span class="p">,</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute power for a discrimination test.</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a><span class="sd">    pd_a : float</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a><span class="sd">        True proportion of discriminators (alternative hypothesis).</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a><span class="sd">        Must be between 0 and 1.</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a><span class="sd">    sample_size : int</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a><span class="sd">        Number of trials in the experiment.</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a><span class="sd">    pd_0 : float, default 0.0</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a><span class="sd">        Null hypothesis proportion of discriminators.</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a><span class="sd">    alpha : float, default 0.05</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a><span class="sd">        Significance level (Type I error rate).</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a><span class="sd">    p_guess : float, default 0.5</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a><span class="sd">        Guessing probability for the protocol (e.g., 1/3 for triangle).</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a><span class="sd">    test : str, default &quot;difference&quot;</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a><span class="sd">        Type of test: &quot;difference&quot; (H1: pd &gt; pd_0) or</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a><span class="sd">        &quot;similarity&quot; (H1: pd &lt; pd_0).</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a><span class="sd">    statistic : str, default &quot;exact&quot;</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a><span class="sd">        Method for computing power:</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a><span class="sd">        - &quot;exact&quot;: Exact binomial test</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a><span class="sd">        - &quot;normal&quot;: Normal approximation</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a><span class="sd">        - &quot;cont.normal&quot;: Normal approximation with continuity correction</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a><span class="sd">    -------</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a><span class="sd">    float</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a><span class="sd">        Statistical power (probability of rejecting H0 when H1 is true).</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a><span class="sd">    Examples</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a><span class="sd">    --------</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a><span class="sd">    &gt;&gt;&gt; # Power for triangle test with 30% discriminators, n=100</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a><span class="sd">    &gt;&gt;&gt; discrim_power(pd_a=0.3, sample_size=100, p_guess=1/3)</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a><span class="sd">    0.869...</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a><span class="sd">    &gt;&gt;&gt; # Power for similarity test</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a><span class="sd">    &gt;&gt;&gt; discrim_power(pd_a=0.1, sample_size=100, pd_0=0.3,</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a><span class="sd">    ...               p_guess=1/3, test=&quot;similarity&quot;)</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a><span class="sd">    0.78...</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a><span class="sd">    Notes</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a><span class="sd">    -----</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a><span class="sd">    Corresponds to `discrimPwr()` in sensR.</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a>    <span class="c1"># Validate inputs</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">pd_a</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;&#39;pd_a&#39; must be between 0 and 1&quot;</span><span class="p">)</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">pd_0</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;&#39;pd_0&#39; must be between 0 and 1&quot;</span><span class="p">)</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sample_size</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">integer</span><span class="p">))</span> <span class="ow">or</span> <span class="n">sample_size</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;&#39;sample_size&#39; must be a positive integer&quot;</span><span class="p">)</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="mi">0</span> <span class="o">&lt;</span> <span class="n">alpha</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;&#39;alpha&#39; must be between 0 and 1&quot;</span><span class="p">)</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">p_guess</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;&#39;p_guess&#39; must be between 0 and 1&quot;</span><span class="p">)</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a>    <span class="n">sample_size</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">sample_size</span><span class="p">)</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a>    <span class="c1"># Validate test type</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a>    <span class="n">test</span> <span class="o">=</span> <span class="n">test</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a>    <span class="k">if</span> <span class="n">test</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;difference&quot;</span><span class="p">,</span> <span class="s2">&quot;similarity&quot;</span><span class="p">):</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;&#39;test&#39; must be &#39;difference&#39; or &#39;similarity&#39;&quot;</span><span class="p">)</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a>    <span class="c1"># Validate pd_a vs pd_0 for test type</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a>    <span class="k">if</span> <span class="n">test</span> <span class="o">==</span> <span class="s2">&quot;difference&quot;</span> <span class="ow">and</span> <span class="n">pd_a</span> <span class="o">&lt;</span> <span class="n">pd_0</span><span class="p">:</span>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;&#39;pd_a&#39; must be &gt;= &#39;pd_0&#39; for difference tests&quot;</span><span class="p">)</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a>    <span class="k">if</span> <span class="n">test</span> <span class="o">==</span> <span class="s2">&quot;similarity&quot;</span> <span class="ow">and</span> <span class="n">pd_a</span> <span class="o">&gt;</span> <span class="n">pd_0</span><span class="p">:</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;&#39;pd_a&#39; must be &lt;= &#39;pd_0&#39; for similarity tests&quot;</span><span class="p">)</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a>    <span class="c1"># Validate statistic</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a>    <span class="n">statistic</span> <span class="o">=</span> <span class="n">_normalize_statistic</span><span class="p">(</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a>        <span class="n">statistic</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;exact&quot;</span><span class="p">,</span> <span class="s2">&quot;normal&quot;</span><span class="p">,</span> <span class="s2">&quot;cont_normal&quot;</span><span class="p">}</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a>    <span class="p">)</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a>    <span class="c1"># Compute power</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a>    <span class="k">if</span> <span class="n">statistic</span> <span class="o">==</span> <span class="s2">&quot;normal&quot;</span><span class="p">:</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a>        <span class="k">return</span> <span class="n">_normal_power</span><span class="p">(</span><span class="n">pd_a</span><span class="p">,</span> <span class="n">pd_0</span><span class="p">,</span> <span class="n">sample_size</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">p_guess</span><span class="p">,</span> <span class="n">test</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a>    <span class="k">elif</span> <span class="n">statistic</span> <span class="o">==</span> <span class="s2">&quot;cont_normal&quot;</span><span class="p">:</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a>        <span class="k">return</span> <span class="n">_normal_power</span><span class="p">(</span><span class="n">pd_a</span><span class="p">,</span> <span class="n">pd_0</span><span class="p">,</span> <span class="n">sample_size</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">p_guess</span><span class="p">,</span> <span class="n">test</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a>    <span class="k">else</span><span class="p">:</span>  <span class="c1"># exact</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a>        <span class="k">return</span> <span class="n">_exact_power</span><span class="p">(</span><span class="n">pd_a</span><span class="p">,</span> <span class="n">pd_0</span><span class="p">,</span> <span class="n">sample_size</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">p_guess</span><span class="p">,</span> <span class="n">test</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div><h3 id="dprime_power">dprime_power</h3>


<div class="doc doc-object doc-function">


<h2 id="senspy.dprime_power" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">dprime_power</span><span class="p">(</span><span class="n">d_prime_a</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">sample_size</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">method</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Protocol</span> <span class="o">=</span> <span class="s1">&#39;triangle&#39;</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">d_prime_0</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">alpha</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">,</span> <span class="n">test</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;difference&#39;</span><span class="p">,</span> <span class="n">statistic</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;exact&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span></code>

</h2>


    <div class="doc doc-contents first">

        <p>Compute power for a discrimination test using d-prime.</p>
<p>This is a convenience wrapper around <code>discrim_power()</code> that converts
d-prime values to proportion of discriminators.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>d_prime_a</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True d-prime value (alternative hypothesis). Must be non-negative.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>sample_size</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of trials in the experiment.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>method</code>
            </td>
            <td>
                  <code><span title="str">str</span> or <span title="senspy.core.types.Protocol">Protocol</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Discrimination protocol.</p>
              </div>
            </td>
            <td>
                  <code>&#34;triangle&#34;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>d_prime_0</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Null hypothesis d-prime value.</p>
              </div>
            </td>
            <td>
                  <code>0.0</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>alpha</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Significance level (Type I error rate).</p>
              </div>
            </td>
            <td>
                  <code>0.05</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>test</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Type of test: "difference" or "similarity".</p>
              </div>
            </td>
            <td>
                  <code>&#34;difference&#34;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>statistic</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Method for computing power: "exact", "normal", or "cont.normal".</p>
              </div>
            </td>
            <td>
                  <code>&#34;exact&#34;</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Statistical power.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Power for triangle test with d&#39;=1.5, n=100</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">dprime_power</span><span class="p">(</span><span class="n">d_prime_a</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">sample_size</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;triangle&quot;</span><span class="p">)</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="go">0.86...</span>
</code></pre></div>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Power for 2-AFC test</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">dprime_power</span><span class="p">(</span><span class="n">d_prime_a</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">sample_size</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;twoafc&quot;</span><span class="p">)</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="go">0.74...</span>
</code></pre></div>


<details class="note" open>
  <summary>Notes</summary>
  <p>Corresponds to <code>d.primePwr()</code> in sensR.</p>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>senspy/power.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span>
<span class="normal"><a href="#__codelineno-0-276">276</a></span>
<span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span>
<span class="normal"><a href="#__codelineno-0-292">292</a></span>
<span class="normal"><a href="#__codelineno-0-293">293</a></span>
<span class="normal"><a href="#__codelineno-0-294">294</a></span>
<span class="normal"><a href="#__codelineno-0-295">295</a></span>
<span class="normal"><a href="#__codelineno-0-296">296</a></span>
<span class="normal"><a href="#__codelineno-0-297">297</a></span>
<span class="normal"><a href="#__codelineno-0-298">298</a></span>
<span class="normal"><a href="#__codelineno-0-299">299</a></span>
<span class="normal"><a href="#__codelineno-0-300">300</a></span>
<span class="normal"><a href="#__codelineno-0-301">301</a></span>
<span class="normal"><a href="#__codelineno-0-302">302</a></span>
<span class="normal"><a href="#__codelineno-0-303">303</a></span>
<span class="normal"><a href="#__codelineno-0-304">304</a></span>
<span class="normal"><a href="#__codelineno-0-305">305</a></span>
<span class="normal"><a href="#__codelineno-0-306">306</a></span>
<span class="normal"><a href="#__codelineno-0-307">307</a></span>
<span class="normal"><a href="#__codelineno-0-308">308</a></span>
<span class="normal"><a href="#__codelineno-0-309">309</a></span>
<span class="normal"><a href="#__codelineno-0-310">310</a></span>
<span class="normal"><a href="#__codelineno-0-311">311</a></span>
<span class="normal"><a href="#__codelineno-0-312">312</a></span>
<span class="normal"><a href="#__codelineno-0-313">313</a></span>
<span class="normal"><a href="#__codelineno-0-314">314</a></span>
<span class="normal"><a href="#__codelineno-0-315">315</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-235" name="__codelineno-0-235"></a><span class="k">def</span><span class="w"> </span><span class="nf">dprime_power</span><span class="p">(</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a>    <span class="n">d_prime_a</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a>    <span class="n">sample_size</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a>    <span class="n">method</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Protocol</span> <span class="o">=</span> <span class="s2">&quot;triangle&quot;</span><span class="p">,</span>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a>    <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a>    <span class="n">d_prime_0</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a>    <span class="n">alpha</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">,</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a>    <span class="n">test</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;difference&quot;</span><span class="p">,</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a>    <span class="n">statistic</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;exact&quot;</span><span class="p">,</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute power for a discrimination test using d-prime.</span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a><span class="sd">    This is a convenience wrapper around `discrim_power()` that converts</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a><span class="sd">    d-prime values to proportion of discriminators.</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a><span class="sd">    d_prime_a : float</span>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a><span class="sd">        True d-prime value (alternative hypothesis). Must be non-negative.</span>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a><span class="sd">    sample_size : int</span>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a><span class="sd">        Number of trials in the experiment.</span>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a><span class="sd">    method : str or Protocol, default &quot;triangle&quot;</span>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a><span class="sd">        Discrimination protocol.</span>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a><span class="sd">    d_prime_0 : float, default 0.0</span>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a><span class="sd">        Null hypothesis d-prime value.</span>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a><span class="sd">    alpha : float, default 0.05</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a><span class="sd">        Significance level (Type I error rate).</span>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a><span class="sd">    test : str, default &quot;difference&quot;</span>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a><span class="sd">        Type of test: &quot;difference&quot; or &quot;similarity&quot;.</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a><span class="sd">    statistic : str, default &quot;exact&quot;</span>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a><span class="sd">        Method for computing power: &quot;exact&quot;, &quot;normal&quot;, or &quot;cont.normal&quot;.</span>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a><span class="sd">    -------</span>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a><span class="sd">    float</span>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a><span class="sd">        Statistical power.</span>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a><span class="sd">    Examples</span>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a><span class="sd">    --------</span>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a><span class="sd">    &gt;&gt;&gt; # Power for triangle test with d&#39;=1.5, n=100</span>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a><span class="sd">    &gt;&gt;&gt; dprime_power(d_prime_a=1.5, sample_size=100, method=&quot;triangle&quot;)</span>
<a id="__codelineno-0-276" name="__codelineno-0-276"></a><span class="sd">    0.86...</span>
<a id="__codelineno-0-277" name="__codelineno-0-277"></a>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a><span class="sd">    &gt;&gt;&gt; # Power for 2-AFC test</span>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a><span class="sd">    &gt;&gt;&gt; dprime_power(d_prime_a=1.0, sample_size=50, method=&quot;twoafc&quot;)</span>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a><span class="sd">    0.74...</span>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a><span class="sd">    Notes</span>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a><span class="sd">    -----</span>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a><span class="sd">    Corresponds to `d.primePwr()` in sensR.</span>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a>    <span class="c1"># Validate d-prime values</span>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a>    <span class="k">if</span> <span class="n">d_prime_a</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;&#39;d_prime_a&#39; must be non-negative&quot;</span><span class="p">)</span>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a>    <span class="k">if</span> <span class="n">d_prime_0</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;&#39;d_prime_0&#39; must be non-negative&quot;</span><span class="p">)</span>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a>
<a id="__codelineno-0-292" name="__codelineno-0-292"></a>    <span class="c1"># Parse protocol</span>
<a id="__codelineno-0-293" name="__codelineno-0-293"></a>    <span class="n">protocol</span> <span class="o">=</span> <span class="n">parse_protocol</span><span class="p">(</span><span class="n">method</span><span class="p">)</span>
<a id="__codelineno-0-294" name="__codelineno-0-294"></a>    <span class="n">p_guess</span> <span class="o">=</span> <span class="n">protocol</span><span class="o">.</span><span class="n">p_guess</span>
<a id="__codelineno-0-295" name="__codelineno-0-295"></a>
<a id="__codelineno-0-296" name="__codelineno-0-296"></a>    <span class="c1"># Defensive check (protocols should never have p_guess &gt;= 1)</span>
<a id="__codelineno-0-297" name="__codelineno-0-297"></a>    <span class="k">if</span> <span class="n">p_guess</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-298" name="__codelineno-0-298"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Protocol p_guess must be &lt; 1&quot;</span><span class="p">)</span>
<a id="__codelineno-0-299" name="__codelineno-0-299"></a>
<a id="__codelineno-0-300" name="__codelineno-0-300"></a>    <span class="c1"># Convert d-prime to pc, then to pd</span>
<a id="__codelineno-0-301" name="__codelineno-0-301"></a>    <span class="n">pc_a</span> <span class="o">=</span> <span class="n">psy_fun</span><span class="p">(</span><span class="n">d_prime_a</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="n">protocol</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-302" name="__codelineno-0-302"></a>    <span class="n">pc_0</span> <span class="o">=</span> <span class="n">psy_fun</span><span class="p">(</span><span class="n">d_prime_0</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="n">protocol</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-303" name="__codelineno-0-303"></a>
<a id="__codelineno-0-304" name="__codelineno-0-304"></a>    <span class="n">pd_a</span> <span class="o">=</span> <span class="p">(</span><span class="n">pc_a</span> <span class="o">-</span> <span class="n">p_guess</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">p_guess</span><span class="p">)</span>
<a id="__codelineno-0-305" name="__codelineno-0-305"></a>    <span class="n">pd_0</span> <span class="o">=</span> <span class="p">(</span><span class="n">pc_0</span> <span class="o">-</span> <span class="n">p_guess</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">p_guess</span><span class="p">)</span>
<a id="__codelineno-0-306" name="__codelineno-0-306"></a>
<a id="__codelineno-0-307" name="__codelineno-0-307"></a>    <span class="k">return</span> <span class="n">discrim_power</span><span class="p">(</span>
<a id="__codelineno-0-308" name="__codelineno-0-308"></a>        <span class="n">pd_a</span><span class="o">=</span><span class="n">pd_a</span><span class="p">,</span>
<a id="__codelineno-0-309" name="__codelineno-0-309"></a>        <span class="n">sample_size</span><span class="o">=</span><span class="n">sample_size</span><span class="p">,</span>
<a id="__codelineno-0-310" name="__codelineno-0-310"></a>        <span class="n">pd_0</span><span class="o">=</span><span class="n">pd_0</span><span class="p">,</span>
<a id="__codelineno-0-311" name="__codelineno-0-311"></a>        <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span>
<a id="__codelineno-0-312" name="__codelineno-0-312"></a>        <span class="n">p_guess</span><span class="o">=</span><span class="n">p_guess</span><span class="p">,</span>
<a id="__codelineno-0-313" name="__codelineno-0-313"></a>        <span class="n">test</span><span class="o">=</span><span class="n">test</span><span class="p">,</span>
<a id="__codelineno-0-314" name="__codelineno-0-314"></a>        <span class="n">statistic</span><span class="o">=</span><span class="n">statistic</span><span class="p">,</span>
<a id="__codelineno-0-315" name="__codelineno-0-315"></a>    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div><h3 id="dod_power">dod_power</h3>


<div class="doc doc-object doc-function">


<h2 id="senspy.dod_power" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">dod_power</span><span class="p">(</span><span class="n">d_primeA</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">d_prime0</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">ncat</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span> <span class="n">sample_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">nsim</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">,</span> <span class="n">alpha</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">,</span> <span class="n">method_tau</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;equi_prob&#39;</span><span class="p">,</span> <span class="s1">&#39;LR_max&#39;</span><span class="p">,</span> <span class="s1">&#39;se_min&#39;</span><span class="p">,</span> <span class="s1">&#39;user_defined&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;LR_max&#39;</span><span class="p">,</span> <span class="n">statistic</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;likelihood&#39;</span><span class="p">,</span> <span class="s1">&#39;Wilcoxon&#39;</span><span class="p">,</span> <span class="s1">&#39;Pearson&#39;</span><span class="p">,</span> <span class="s1">&#39;Wald&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;likelihood&#39;</span><span class="p">,</span> <span class="n">alternative</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;difference&#39;</span><span class="p">,</span> <span class="s1">&#39;similarity&#39;</span><span class="p">,</span> <span class="s1">&#39;two.sided&#39;</span><span class="p">,</span> <span class="s1">&#39;less&#39;</span><span class="p">,</span> <span class="s1">&#39;greater&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;difference&#39;</span><span class="p">,</span> <span class="n">tau</span><span class="p">:</span> <span class="n">NDArray</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">random_state</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">Generator</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DODPowerResult</span></code>

</h2>


    <div class="doc doc-contents first">

        <p>Compute power for DOD discrimination test via simulation.</p>
<p>This function estimates the power of a DOD (Degree-of-Difference) test
by simulating data under the alternative hypothesis and computing the
proportion of simulations that would reject the null hypothesis.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>d_primeA</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True d-prime value (alternative hypothesis).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>d_prime0</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Null hypothesis d-prime value. Default is 0.</p>
              </div>
            </td>
            <td>
                  <code>0.0</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>ncat</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of response categories. Default is 4.</p>
              </div>
            </td>
            <td>
                  <code>4</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>sample_size</code>
            </td>
            <td>
                  <code><span title="int">int</span> | <span title="tuple">tuple</span>[<span title="int">int</span>, <span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Sample size. If int, same size for both same-pairs and diff-pairs.
If tuple, (same_size, diff_size). Default is 100.</p>
              </div>
            </td>
            <td>
                  <code>100</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>nsim</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of simulations. Default is 1000.</p>
              </div>
            </td>
            <td>
                  <code>1000</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>alpha</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Significance level. Default is 0.05.</p>
              </div>
            </td>
            <td>
                  <code>0.05</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>method_tau</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Method for determining tau values:
- "LR_max": Maximum likelihood ratio (default)
- "equi_prob": Equal category probabilities
- "se_min": Minimum standard error
- "user_defined": Use provided tau values</p>
              </div>
            </td>
            <td>
                  <code>&#39;LR_max&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>statistic</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Test statistic:
- "likelihood": Likelihood ratio test (default)
- "Pearson": Pearson chi-square
- "Wilcoxon": Wilcoxon rank-sum test (requires d_prime0=0)
- "Wald": Wald test</p>
              </div>
            </td>
            <td>
                  <code>&#39;likelihood&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>alternative</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Alternative hypothesis:
- "difference" or "greater": d-prime &gt; d_prime0 (default)
- "similarity" or "less": d-prime &lt; d_prime0
- "two.sided": d-prime != d_prime0</p>
              </div>
            </td>
            <td>
                  <code>&#39;difference&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>tau</code>
            </td>
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Boundary parameters (required if method_tau="user_defined").</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>random_state</code>
            </td>
            <td>
                  <code><span title="int">int</span> | <span title="numpy.random.Generator">Generator</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Random state for reproducibility.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="DODPowerResult(power: float, se_power: float, n_used: int, d_primeA: float, d_prime0: float, sample_size: tuple[int, int], nsim: int, alpha: float, statistic: str, alternative: str, tau: NDArray)

  
      dataclass
   (senspy.dod.DODPowerResult)" href="../models/#senspy.dod.DODPowerResult">DODPowerResult</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Power analysis results including power estimate and standard error.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If inputs are invalid or incompatible.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">dod_power</span><span class="p">(</span><span class="n">d_primeA</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">sample_size</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">nsim</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Power: </span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">power</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> (SE: </span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">se_power</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
</code></pre></div>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="c1"># With specific tau values</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">dod_power</span><span class="p">(</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">... </span>    <span class="n">d_primeA</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">... </span>    <span class="n">method_tau</span><span class="o">=</span><span class="s2">&quot;user_defined&quot;</span><span class="p">,</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="gp">... </span>    <span class="n">tau</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">])</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="gp">... </span><span class="p">)</span>
</code></pre></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>senspy/dod.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1181">1181</a></span>
<span class="normal"><a href="#__codelineno-0-1182">1182</a></span>
<span class="normal"><a href="#__codelineno-0-1183">1183</a></span>
<span class="normal"><a href="#__codelineno-0-1184">1184</a></span>
<span class="normal"><a href="#__codelineno-0-1185">1185</a></span>
<span class="normal"><a href="#__codelineno-0-1186">1186</a></span>
<span class="normal"><a href="#__codelineno-0-1187">1187</a></span>
<span class="normal"><a href="#__codelineno-0-1188">1188</a></span>
<span class="normal"><a href="#__codelineno-0-1189">1189</a></span>
<span class="normal"><a href="#__codelineno-0-1190">1190</a></span>
<span class="normal"><a href="#__codelineno-0-1191">1191</a></span>
<span class="normal"><a href="#__codelineno-0-1192">1192</a></span>
<span class="normal"><a href="#__codelineno-0-1193">1193</a></span>
<span class="normal"><a href="#__codelineno-0-1194">1194</a></span>
<span class="normal"><a href="#__codelineno-0-1195">1195</a></span>
<span class="normal"><a href="#__codelineno-0-1196">1196</a></span>
<span class="normal"><a href="#__codelineno-0-1197">1197</a></span>
<span class="normal"><a href="#__codelineno-0-1198">1198</a></span>
<span class="normal"><a href="#__codelineno-0-1199">1199</a></span>
<span class="normal"><a href="#__codelineno-0-1200">1200</a></span>
<span class="normal"><a href="#__codelineno-0-1201">1201</a></span>
<span class="normal"><a href="#__codelineno-0-1202">1202</a></span>
<span class="normal"><a href="#__codelineno-0-1203">1203</a></span>
<span class="normal"><a href="#__codelineno-0-1204">1204</a></span>
<span class="normal"><a href="#__codelineno-0-1205">1205</a></span>
<span class="normal"><a href="#__codelineno-0-1206">1206</a></span>
<span class="normal"><a href="#__codelineno-0-1207">1207</a></span>
<span class="normal"><a href="#__codelineno-0-1208">1208</a></span>
<span class="normal"><a href="#__codelineno-0-1209">1209</a></span>
<span class="normal"><a href="#__codelineno-0-1210">1210</a></span>
<span class="normal"><a href="#__codelineno-0-1211">1211</a></span>
<span class="normal"><a href="#__codelineno-0-1212">1212</a></span>
<span class="normal"><a href="#__codelineno-0-1213">1213</a></span>
<span class="normal"><a href="#__codelineno-0-1214">1214</a></span>
<span class="normal"><a href="#__codelineno-0-1215">1215</a></span>
<span class="normal"><a href="#__codelineno-0-1216">1216</a></span>
<span class="normal"><a href="#__codelineno-0-1217">1217</a></span>
<span class="normal"><a href="#__codelineno-0-1218">1218</a></span>
<span class="normal"><a href="#__codelineno-0-1219">1219</a></span>
<span class="normal"><a href="#__codelineno-0-1220">1220</a></span>
<span class="normal"><a href="#__codelineno-0-1221">1221</a></span>
<span class="normal"><a href="#__codelineno-0-1222">1222</a></span>
<span class="normal"><a href="#__codelineno-0-1223">1223</a></span>
<span class="normal"><a href="#__codelineno-0-1224">1224</a></span>
<span class="normal"><a href="#__codelineno-0-1225">1225</a></span>
<span class="normal"><a href="#__codelineno-0-1226">1226</a></span>
<span class="normal"><a href="#__codelineno-0-1227">1227</a></span>
<span class="normal"><a href="#__codelineno-0-1228">1228</a></span>
<span class="normal"><a href="#__codelineno-0-1229">1229</a></span>
<span class="normal"><a href="#__codelineno-0-1230">1230</a></span>
<span class="normal"><a href="#__codelineno-0-1231">1231</a></span>
<span class="normal"><a href="#__codelineno-0-1232">1232</a></span>
<span class="normal"><a href="#__codelineno-0-1233">1233</a></span>
<span class="normal"><a href="#__codelineno-0-1234">1234</a></span>
<span class="normal"><a href="#__codelineno-0-1235">1235</a></span>
<span class="normal"><a href="#__codelineno-0-1236">1236</a></span>
<span class="normal"><a href="#__codelineno-0-1237">1237</a></span>
<span class="normal"><a href="#__codelineno-0-1238">1238</a></span>
<span class="normal"><a href="#__codelineno-0-1239">1239</a></span>
<span class="normal"><a href="#__codelineno-0-1240">1240</a></span>
<span class="normal"><a href="#__codelineno-0-1241">1241</a></span>
<span class="normal"><a href="#__codelineno-0-1242">1242</a></span>
<span class="normal"><a href="#__codelineno-0-1243">1243</a></span>
<span class="normal"><a href="#__codelineno-0-1244">1244</a></span>
<span class="normal"><a href="#__codelineno-0-1245">1245</a></span>
<span class="normal"><a href="#__codelineno-0-1246">1246</a></span>
<span class="normal"><a href="#__codelineno-0-1247">1247</a></span>
<span class="normal"><a href="#__codelineno-0-1248">1248</a></span>
<span class="normal"><a href="#__codelineno-0-1249">1249</a></span>
<span class="normal"><a href="#__codelineno-0-1250">1250</a></span>
<span class="normal"><a href="#__codelineno-0-1251">1251</a></span>
<span class="normal"><a href="#__codelineno-0-1252">1252</a></span>
<span class="normal"><a href="#__codelineno-0-1253">1253</a></span>
<span class="normal"><a href="#__codelineno-0-1254">1254</a></span>
<span class="normal"><a href="#__codelineno-0-1255">1255</a></span>
<span class="normal"><a href="#__codelineno-0-1256">1256</a></span>
<span class="normal"><a href="#__codelineno-0-1257">1257</a></span>
<span class="normal"><a href="#__codelineno-0-1258">1258</a></span>
<span class="normal"><a href="#__codelineno-0-1259">1259</a></span>
<span class="normal"><a href="#__codelineno-0-1260">1260</a></span>
<span class="normal"><a href="#__codelineno-0-1261">1261</a></span>
<span class="normal"><a href="#__codelineno-0-1262">1262</a></span>
<span class="normal"><a href="#__codelineno-0-1263">1263</a></span>
<span class="normal"><a href="#__codelineno-0-1264">1264</a></span>
<span class="normal"><a href="#__codelineno-0-1265">1265</a></span>
<span class="normal"><a href="#__codelineno-0-1266">1266</a></span>
<span class="normal"><a href="#__codelineno-0-1267">1267</a></span>
<span class="normal"><a href="#__codelineno-0-1268">1268</a></span>
<span class="normal"><a href="#__codelineno-0-1269">1269</a></span>
<span class="normal"><a href="#__codelineno-0-1270">1270</a></span>
<span class="normal"><a href="#__codelineno-0-1271">1271</a></span>
<span class="normal"><a href="#__codelineno-0-1272">1272</a></span>
<span class="normal"><a href="#__codelineno-0-1273">1273</a></span>
<span class="normal"><a href="#__codelineno-0-1274">1274</a></span>
<span class="normal"><a href="#__codelineno-0-1275">1275</a></span>
<span class="normal"><a href="#__codelineno-0-1276">1276</a></span>
<span class="normal"><a href="#__codelineno-0-1277">1277</a></span>
<span class="normal"><a href="#__codelineno-0-1278">1278</a></span>
<span class="normal"><a href="#__codelineno-0-1279">1279</a></span>
<span class="normal"><a href="#__codelineno-0-1280">1280</a></span>
<span class="normal"><a href="#__codelineno-0-1281">1281</a></span>
<span class="normal"><a href="#__codelineno-0-1282">1282</a></span>
<span class="normal"><a href="#__codelineno-0-1283">1283</a></span>
<span class="normal"><a href="#__codelineno-0-1284">1284</a></span>
<span class="normal"><a href="#__codelineno-0-1285">1285</a></span>
<span class="normal"><a href="#__codelineno-0-1286">1286</a></span>
<span class="normal"><a href="#__codelineno-0-1287">1287</a></span>
<span class="normal"><a href="#__codelineno-0-1288">1288</a></span>
<span class="normal"><a href="#__codelineno-0-1289">1289</a></span>
<span class="normal"><a href="#__codelineno-0-1290">1290</a></span>
<span class="normal"><a href="#__codelineno-0-1291">1291</a></span>
<span class="normal"><a href="#__codelineno-0-1292">1292</a></span>
<span class="normal"><a href="#__codelineno-0-1293">1293</a></span>
<span class="normal"><a href="#__codelineno-0-1294">1294</a></span>
<span class="normal"><a href="#__codelineno-0-1295">1295</a></span>
<span class="normal"><a href="#__codelineno-0-1296">1296</a></span>
<span class="normal"><a href="#__codelineno-0-1297">1297</a></span>
<span class="normal"><a href="#__codelineno-0-1298">1298</a></span>
<span class="normal"><a href="#__codelineno-0-1299">1299</a></span>
<span class="normal"><a href="#__codelineno-0-1300">1300</a></span>
<span class="normal"><a href="#__codelineno-0-1301">1301</a></span>
<span class="normal"><a href="#__codelineno-0-1302">1302</a></span>
<span class="normal"><a href="#__codelineno-0-1303">1303</a></span>
<span class="normal"><a href="#__codelineno-0-1304">1304</a></span>
<span class="normal"><a href="#__codelineno-0-1305">1305</a></span>
<span class="normal"><a href="#__codelineno-0-1306">1306</a></span>
<span class="normal"><a href="#__codelineno-0-1307">1307</a></span>
<span class="normal"><a href="#__codelineno-0-1308">1308</a></span>
<span class="normal"><a href="#__codelineno-0-1309">1309</a></span>
<span class="normal"><a href="#__codelineno-0-1310">1310</a></span>
<span class="normal"><a href="#__codelineno-0-1311">1311</a></span>
<span class="normal"><a href="#__codelineno-0-1312">1312</a></span>
<span class="normal"><a href="#__codelineno-0-1313">1313</a></span>
<span class="normal"><a href="#__codelineno-0-1314">1314</a></span>
<span class="normal"><a href="#__codelineno-0-1315">1315</a></span>
<span class="normal"><a href="#__codelineno-0-1316">1316</a></span>
<span class="normal"><a href="#__codelineno-0-1317">1317</a></span>
<span class="normal"><a href="#__codelineno-0-1318">1318</a></span>
<span class="normal"><a href="#__codelineno-0-1319">1319</a></span>
<span class="normal"><a href="#__codelineno-0-1320">1320</a></span>
<span class="normal"><a href="#__codelineno-0-1321">1321</a></span>
<span class="normal"><a href="#__codelineno-0-1322">1322</a></span>
<span class="normal"><a href="#__codelineno-0-1323">1323</a></span>
<span class="normal"><a href="#__codelineno-0-1324">1324</a></span>
<span class="normal"><a href="#__codelineno-0-1325">1325</a></span>
<span class="normal"><a href="#__codelineno-0-1326">1326</a></span>
<span class="normal"><a href="#__codelineno-0-1327">1327</a></span>
<span class="normal"><a href="#__codelineno-0-1328">1328</a></span>
<span class="normal"><a href="#__codelineno-0-1329">1329</a></span>
<span class="normal"><a href="#__codelineno-0-1330">1330</a></span>
<span class="normal"><a href="#__codelineno-0-1331">1331</a></span>
<span class="normal"><a href="#__codelineno-0-1332">1332</a></span>
<span class="normal"><a href="#__codelineno-0-1333">1333</a></span>
<span class="normal"><a href="#__codelineno-0-1334">1334</a></span>
<span class="normal"><a href="#__codelineno-0-1335">1335</a></span>
<span class="normal"><a href="#__codelineno-0-1336">1336</a></span>
<span class="normal"><a href="#__codelineno-0-1337">1337</a></span>
<span class="normal"><a href="#__codelineno-0-1338">1338</a></span>
<span class="normal"><a href="#__codelineno-0-1339">1339</a></span>
<span class="normal"><a href="#__codelineno-0-1340">1340</a></span>
<span class="normal"><a href="#__codelineno-0-1341">1341</a></span>
<span class="normal"><a href="#__codelineno-0-1342">1342</a></span>
<span class="normal"><a href="#__codelineno-0-1343">1343</a></span>
<span class="normal"><a href="#__codelineno-0-1344">1344</a></span>
<span class="normal"><a href="#__codelineno-0-1345">1345</a></span>
<span class="normal"><a href="#__codelineno-0-1346">1346</a></span>
<span class="normal"><a href="#__codelineno-0-1347">1347</a></span>
<span class="normal"><a href="#__codelineno-0-1348">1348</a></span>
<span class="normal"><a href="#__codelineno-0-1349">1349</a></span>
<span class="normal"><a href="#__codelineno-0-1350">1350</a></span>
<span class="normal"><a href="#__codelineno-0-1351">1351</a></span>
<span class="normal"><a href="#__codelineno-0-1352">1352</a></span>
<span class="normal"><a href="#__codelineno-0-1353">1353</a></span>
<span class="normal"><a href="#__codelineno-0-1354">1354</a></span>
<span class="normal"><a href="#__codelineno-0-1355">1355</a></span>
<span class="normal"><a href="#__codelineno-0-1356">1356</a></span>
<span class="normal"><a href="#__codelineno-0-1357">1357</a></span>
<span class="normal"><a href="#__codelineno-0-1358">1358</a></span>
<span class="normal"><a href="#__codelineno-0-1359">1359</a></span>
<span class="normal"><a href="#__codelineno-0-1360">1360</a></span>
<span class="normal"><a href="#__codelineno-0-1361">1361</a></span>
<span class="normal"><a href="#__codelineno-0-1362">1362</a></span>
<span class="normal"><a href="#__codelineno-0-1363">1363</a></span>
<span class="normal"><a href="#__codelineno-0-1364">1364</a></span>
<span class="normal"><a href="#__codelineno-0-1365">1365</a></span>
<span class="normal"><a href="#__codelineno-0-1366">1366</a></span>
<span class="normal"><a href="#__codelineno-0-1367">1367</a></span>
<span class="normal"><a href="#__codelineno-0-1368">1368</a></span>
<span class="normal"><a href="#__codelineno-0-1369">1369</a></span>
<span class="normal"><a href="#__codelineno-0-1370">1370</a></span>
<span class="normal"><a href="#__codelineno-0-1371">1371</a></span>
<span class="normal"><a href="#__codelineno-0-1372">1372</a></span>
<span class="normal"><a href="#__codelineno-0-1373">1373</a></span>
<span class="normal"><a href="#__codelineno-0-1374">1374</a></span>
<span class="normal"><a href="#__codelineno-0-1375">1375</a></span>
<span class="normal"><a href="#__codelineno-0-1376">1376</a></span>
<span class="normal"><a href="#__codelineno-0-1377">1377</a></span>
<span class="normal"><a href="#__codelineno-0-1378">1378</a></span>
<span class="normal"><a href="#__codelineno-0-1379">1379</a></span>
<span class="normal"><a href="#__codelineno-0-1380">1380</a></span>
<span class="normal"><a href="#__codelineno-0-1381">1381</a></span>
<span class="normal"><a href="#__codelineno-0-1382">1382</a></span>
<span class="normal"><a href="#__codelineno-0-1383">1383</a></span>
<span class="normal"><a href="#__codelineno-0-1384">1384</a></span>
<span class="normal"><a href="#__codelineno-0-1385">1385</a></span>
<span class="normal"><a href="#__codelineno-0-1386">1386</a></span>
<span class="normal"><a href="#__codelineno-0-1387">1387</a></span>
<span class="normal"><a href="#__codelineno-0-1388">1388</a></span>
<span class="normal"><a href="#__codelineno-0-1389">1389</a></span>
<span class="normal"><a href="#__codelineno-0-1390">1390</a></span>
<span class="normal"><a href="#__codelineno-0-1391">1391</a></span>
<span class="normal"><a href="#__codelineno-0-1392">1392</a></span>
<span class="normal"><a href="#__codelineno-0-1393">1393</a></span>
<span class="normal"><a href="#__codelineno-0-1394">1394</a></span>
<span class="normal"><a href="#__codelineno-0-1395">1395</a></span>
<span class="normal"><a href="#__codelineno-0-1396">1396</a></span>
<span class="normal"><a href="#__codelineno-0-1397">1397</a></span>
<span class="normal"><a href="#__codelineno-0-1398">1398</a></span>
<span class="normal"><a href="#__codelineno-0-1399">1399</a></span>
<span class="normal"><a href="#__codelineno-0-1400">1400</a></span>
<span class="normal"><a href="#__codelineno-0-1401">1401</a></span>
<span class="normal"><a href="#__codelineno-0-1402">1402</a></span>
<span class="normal"><a href="#__codelineno-0-1403">1403</a></span>
<span class="normal"><a href="#__codelineno-0-1404">1404</a></span>
<span class="normal"><a href="#__codelineno-0-1405">1405</a></span>
<span class="normal"><a href="#__codelineno-0-1406">1406</a></span>
<span class="normal"><a href="#__codelineno-0-1407">1407</a></span>
<span class="normal"><a href="#__codelineno-0-1408">1408</a></span>
<span class="normal"><a href="#__codelineno-0-1409">1409</a></span>
<span class="normal"><a href="#__codelineno-0-1410">1410</a></span>
<span class="normal"><a href="#__codelineno-0-1411">1411</a></span>
<span class="normal"><a href="#__codelineno-0-1412">1412</a></span>
<span class="normal"><a href="#__codelineno-0-1413">1413</a></span>
<span class="normal"><a href="#__codelineno-0-1414">1414</a></span>
<span class="normal"><a href="#__codelineno-0-1415">1415</a></span>
<span class="normal"><a href="#__codelineno-0-1416">1416</a></span>
<span class="normal"><a href="#__codelineno-0-1417">1417</a></span>
<span class="normal"><a href="#__codelineno-0-1418">1418</a></span>
<span class="normal"><a href="#__codelineno-0-1419">1419</a></span>
<span class="normal"><a href="#__codelineno-0-1420">1420</a></span>
<span class="normal"><a href="#__codelineno-0-1421">1421</a></span>
<span class="normal"><a href="#__codelineno-0-1422">1422</a></span>
<span class="normal"><a href="#__codelineno-0-1423">1423</a></span>
<span class="normal"><a href="#__codelineno-0-1424">1424</a></span>
<span class="normal"><a href="#__codelineno-0-1425">1425</a></span>
<span class="normal"><a href="#__codelineno-0-1426">1426</a></span>
<span class="normal"><a href="#__codelineno-0-1427">1427</a></span>
<span class="normal"><a href="#__codelineno-0-1428">1428</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1181" name="__codelineno-0-1181"></a><span class="k">def</span><span class="w"> </span><span class="nf">dod_power</span><span class="p">(</span>
<a id="__codelineno-0-1182" name="__codelineno-0-1182"></a>    <span class="n">d_primeA</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
<a id="__codelineno-0-1183" name="__codelineno-0-1183"></a>    <span class="n">d_prime0</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
<a id="__codelineno-0-1184" name="__codelineno-0-1184"></a>    <span class="n">ncat</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span>
<a id="__codelineno-0-1185" name="__codelineno-0-1185"></a>    <span class="n">sample_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span>
<a id="__codelineno-0-1186" name="__codelineno-0-1186"></a>    <span class="n">nsim</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">,</span>
<a id="__codelineno-0-1187" name="__codelineno-0-1187"></a>    <span class="n">alpha</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">,</span>
<a id="__codelineno-0-1188" name="__codelineno-0-1188"></a>    <span class="n">method_tau</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;equi_prob&quot;</span><span class="p">,</span> <span class="s2">&quot;LR_max&quot;</span><span class="p">,</span> <span class="s2">&quot;se_min&quot;</span><span class="p">,</span> <span class="s2">&quot;user_defined&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;LR_max&quot;</span><span class="p">,</span>
<a id="__codelineno-0-1189" name="__codelineno-0-1189"></a>    <span class="n">statistic</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;likelihood&quot;</span><span class="p">,</span> <span class="s2">&quot;Wilcoxon&quot;</span><span class="p">,</span> <span class="s2">&quot;Pearson&quot;</span><span class="p">,</span> <span class="s2">&quot;Wald&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;likelihood&quot;</span><span class="p">,</span>
<a id="__codelineno-0-1190" name="__codelineno-0-1190"></a>    <span class="n">alternative</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span>
<a id="__codelineno-0-1191" name="__codelineno-0-1191"></a>        <span class="s2">&quot;difference&quot;</span><span class="p">,</span> <span class="s2">&quot;similarity&quot;</span><span class="p">,</span> <span class="s2">&quot;two.sided&quot;</span><span class="p">,</span> <span class="s2">&quot;less&quot;</span><span class="p">,</span> <span class="s2">&quot;greater&quot;</span>
<a id="__codelineno-0-1192" name="__codelineno-0-1192"></a>    <span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;difference&quot;</span><span class="p">,</span>
<a id="__codelineno-0-1193" name="__codelineno-0-1193"></a>    <span class="n">tau</span><span class="p">:</span> <span class="n">NDArray</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1194" name="__codelineno-0-1194"></a>    <span class="n">random_state</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">Generator</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1195" name="__codelineno-0-1195"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DODPowerResult</span><span class="p">:</span>
<a id="__codelineno-0-1196" name="__codelineno-0-1196"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute power for DOD discrimination test via simulation.</span>
<a id="__codelineno-0-1197" name="__codelineno-0-1197"></a>
<a id="__codelineno-0-1198" name="__codelineno-0-1198"></a><span class="sd">    This function estimates the power of a DOD (Degree-of-Difference) test</span>
<a id="__codelineno-0-1199" name="__codelineno-0-1199"></a><span class="sd">    by simulating data under the alternative hypothesis and computing the</span>
<a id="__codelineno-0-1200" name="__codelineno-0-1200"></a><span class="sd">    proportion of simulations that would reject the null hypothesis.</span>
<a id="__codelineno-0-1201" name="__codelineno-0-1201"></a>
<a id="__codelineno-0-1202" name="__codelineno-0-1202"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-1203" name="__codelineno-0-1203"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-1204" name="__codelineno-0-1204"></a><span class="sd">    d_primeA : float</span>
<a id="__codelineno-0-1205" name="__codelineno-0-1205"></a><span class="sd">        True d-prime value (alternative hypothesis).</span>
<a id="__codelineno-0-1206" name="__codelineno-0-1206"></a><span class="sd">    d_prime0 : float</span>
<a id="__codelineno-0-1207" name="__codelineno-0-1207"></a><span class="sd">        Null hypothesis d-prime value. Default is 0.</span>
<a id="__codelineno-0-1208" name="__codelineno-0-1208"></a><span class="sd">    ncat : int</span>
<a id="__codelineno-0-1209" name="__codelineno-0-1209"></a><span class="sd">        Number of response categories. Default is 4.</span>
<a id="__codelineno-0-1210" name="__codelineno-0-1210"></a><span class="sd">    sample_size : int | tuple[int, int]</span>
<a id="__codelineno-0-1211" name="__codelineno-0-1211"></a><span class="sd">        Sample size. If int, same size for both same-pairs and diff-pairs.</span>
<a id="__codelineno-0-1212" name="__codelineno-0-1212"></a><span class="sd">        If tuple, (same_size, diff_size). Default is 100.</span>
<a id="__codelineno-0-1213" name="__codelineno-0-1213"></a><span class="sd">    nsim : int</span>
<a id="__codelineno-0-1214" name="__codelineno-0-1214"></a><span class="sd">        Number of simulations. Default is 1000.</span>
<a id="__codelineno-0-1215" name="__codelineno-0-1215"></a><span class="sd">    alpha : float</span>
<a id="__codelineno-0-1216" name="__codelineno-0-1216"></a><span class="sd">        Significance level. Default is 0.05.</span>
<a id="__codelineno-0-1217" name="__codelineno-0-1217"></a><span class="sd">    method_tau : str</span>
<a id="__codelineno-0-1218" name="__codelineno-0-1218"></a><span class="sd">        Method for determining tau values:</span>
<a id="__codelineno-0-1219" name="__codelineno-0-1219"></a><span class="sd">        - &quot;LR_max&quot;: Maximum likelihood ratio (default)</span>
<a id="__codelineno-0-1220" name="__codelineno-0-1220"></a><span class="sd">        - &quot;equi_prob&quot;: Equal category probabilities</span>
<a id="__codelineno-0-1221" name="__codelineno-0-1221"></a><span class="sd">        - &quot;se_min&quot;: Minimum standard error</span>
<a id="__codelineno-0-1222" name="__codelineno-0-1222"></a><span class="sd">        - &quot;user_defined&quot;: Use provided tau values</span>
<a id="__codelineno-0-1223" name="__codelineno-0-1223"></a><span class="sd">    statistic : str</span>
<a id="__codelineno-0-1224" name="__codelineno-0-1224"></a><span class="sd">        Test statistic:</span>
<a id="__codelineno-0-1225" name="__codelineno-0-1225"></a><span class="sd">        - &quot;likelihood&quot;: Likelihood ratio test (default)</span>
<a id="__codelineno-0-1226" name="__codelineno-0-1226"></a><span class="sd">        - &quot;Pearson&quot;: Pearson chi-square</span>
<a id="__codelineno-0-1227" name="__codelineno-0-1227"></a><span class="sd">        - &quot;Wilcoxon&quot;: Wilcoxon rank-sum test (requires d_prime0=0)</span>
<a id="__codelineno-0-1228" name="__codelineno-0-1228"></a><span class="sd">        - &quot;Wald&quot;: Wald test</span>
<a id="__codelineno-0-1229" name="__codelineno-0-1229"></a><span class="sd">    alternative : str</span>
<a id="__codelineno-0-1230" name="__codelineno-0-1230"></a><span class="sd">        Alternative hypothesis:</span>
<a id="__codelineno-0-1231" name="__codelineno-0-1231"></a><span class="sd">        - &quot;difference&quot; or &quot;greater&quot;: d-prime &gt; d_prime0 (default)</span>
<a id="__codelineno-0-1232" name="__codelineno-0-1232"></a><span class="sd">        - &quot;similarity&quot; or &quot;less&quot;: d-prime &lt; d_prime0</span>
<a id="__codelineno-0-1233" name="__codelineno-0-1233"></a><span class="sd">        - &quot;two.sided&quot;: d-prime != d_prime0</span>
<a id="__codelineno-0-1234" name="__codelineno-0-1234"></a><span class="sd">    tau : NDArray | None</span>
<a id="__codelineno-0-1235" name="__codelineno-0-1235"></a><span class="sd">        Boundary parameters (required if method_tau=&quot;user_defined&quot;).</span>
<a id="__codelineno-0-1236" name="__codelineno-0-1236"></a><span class="sd">    random_state : int | np.random.Generator | None</span>
<a id="__codelineno-0-1237" name="__codelineno-0-1237"></a><span class="sd">        Random state for reproducibility.</span>
<a id="__codelineno-0-1238" name="__codelineno-0-1238"></a>
<a id="__codelineno-0-1239" name="__codelineno-0-1239"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-1240" name="__codelineno-0-1240"></a><span class="sd">    -------</span>
<a id="__codelineno-0-1241" name="__codelineno-0-1241"></a><span class="sd">    DODPowerResult</span>
<a id="__codelineno-0-1242" name="__codelineno-0-1242"></a><span class="sd">        Power analysis results including power estimate and standard error.</span>
<a id="__codelineno-0-1243" name="__codelineno-0-1243"></a>
<a id="__codelineno-0-1244" name="__codelineno-0-1244"></a><span class="sd">    Raises</span>
<a id="__codelineno-0-1245" name="__codelineno-0-1245"></a><span class="sd">    ------</span>
<a id="__codelineno-0-1246" name="__codelineno-0-1246"></a><span class="sd">    ValueError</span>
<a id="__codelineno-0-1247" name="__codelineno-0-1247"></a><span class="sd">        If inputs are invalid or incompatible.</span>
<a id="__codelineno-0-1248" name="__codelineno-0-1248"></a>
<a id="__codelineno-0-1249" name="__codelineno-0-1249"></a><span class="sd">    Examples</span>
<a id="__codelineno-0-1250" name="__codelineno-0-1250"></a><span class="sd">    --------</span>
<a id="__codelineno-0-1251" name="__codelineno-0-1251"></a><span class="sd">    &gt;&gt;&gt; result = dod_power(d_primeA=1.0, sample_size=100, nsim=500)</span>
<a id="__codelineno-0-1252" name="__codelineno-0-1252"></a><span class="sd">    &gt;&gt;&gt; print(f&quot;Power: {result.power:.3f} (SE: {result.se_power:.3f})&quot;)</span>
<a id="__codelineno-0-1253" name="__codelineno-0-1253"></a>
<a id="__codelineno-0-1254" name="__codelineno-0-1254"></a><span class="sd">    &gt;&gt;&gt; # With specific tau values</span>
<a id="__codelineno-0-1255" name="__codelineno-0-1255"></a><span class="sd">    &gt;&gt;&gt; result = dod_power(</span>
<a id="__codelineno-0-1256" name="__codelineno-0-1256"></a><span class="sd">    ...     d_primeA=1.5,</span>
<a id="__codelineno-0-1257" name="__codelineno-0-1257"></a><span class="sd">    ...     method_tau=&quot;user_defined&quot;,</span>
<a id="__codelineno-0-1258" name="__codelineno-0-1258"></a><span class="sd">    ...     tau=np.array([0.5, 1.0, 1.5])</span>
<a id="__codelineno-0-1259" name="__codelineno-0-1259"></a><span class="sd">    ... )</span>
<a id="__codelineno-0-1260" name="__codelineno-0-1260"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1261" name="__codelineno-0-1261"></a>    <span class="c1"># Validate inputs</span>
<a id="__codelineno-0-1262" name="__codelineno-0-1262"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">d_primeA</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">))</span> <span class="ow">and</span> <span class="n">d_primeA</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">np</span><span class="o">.</span><span class="n">isfinite</span><span class="p">(</span><span class="n">d_primeA</span><span class="p">)):</span>
<a id="__codelineno-0-1263" name="__codelineno-0-1263"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;d_primeA must be a finite non-negative number&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1264" name="__codelineno-0-1264"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">d_prime0</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">))</span> <span class="ow">and</span> <span class="n">d_prime0</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">np</span><span class="o">.</span><span class="n">isfinite</span><span class="p">(</span><span class="n">d_prime0</span><span class="p">)):</span>
<a id="__codelineno-0-1265" name="__codelineno-0-1265"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;d_prime0 must be a finite non-negative number&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1266" name="__codelineno-0-1266"></a>    <span class="k">if</span> <span class="n">nsim</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="ow">or</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">nsim</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">)):</span>
<a id="__codelineno-0-1267" name="__codelineno-0-1267"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;nsim must be a positive number&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1268" name="__codelineno-0-1268"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">alpha</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">):</span>
<a id="__codelineno-0-1269" name="__codelineno-0-1269"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;alpha must be between 0 and 1&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1270" name="__codelineno-0-1270"></a>
<a id="__codelineno-0-1271" name="__codelineno-0-1271"></a>    <span class="n">nsim</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">nsim</span><span class="p">))</span>
<a id="__codelineno-0-1272" name="__codelineno-0-1272"></a>
<a id="__codelineno-0-1273" name="__codelineno-0-1273"></a>    <span class="c1"># Handle sample size</span>
<a id="__codelineno-0-1274" name="__codelineno-0-1274"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sample_size</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
<a id="__codelineno-0-1275" name="__codelineno-0-1275"></a>        <span class="n">size</span> <span class="o">=</span> <span class="p">(</span><span class="n">sample_size</span><span class="p">,</span> <span class="n">sample_size</span><span class="p">)</span>
<a id="__codelineno-0-1276" name="__codelineno-0-1276"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1277" name="__codelineno-0-1277"></a>        <span class="n">size</span> <span class="o">=</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">sample_size</span><span class="p">[</span><span class="mi">0</span><span class="p">])),</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">sample_size</span><span class="p">[</span><span class="mi">1</span><span class="p">])))</span>
<a id="__codelineno-0-1278" name="__codelineno-0-1278"></a>
<a id="__codelineno-0-1279" name="__codelineno-0-1279"></a>    <span class="c1"># Map alternative names</span>
<a id="__codelineno-0-1280" name="__codelineno-0-1280"></a>    <span class="n">alt</span> <span class="o">=</span> <span class="n">alternative</span>
<a id="__codelineno-0-1281" name="__codelineno-0-1281"></a>    <span class="k">if</span> <span class="n">alt</span> <span class="o">==</span> <span class="s2">&quot;difference&quot;</span><span class="p">:</span>
<a id="__codelineno-0-1282" name="__codelineno-0-1282"></a>        <span class="n">alt</span> <span class="o">=</span> <span class="s2">&quot;greater&quot;</span>
<a id="__codelineno-0-1283" name="__codelineno-0-1283"></a>    <span class="k">elif</span> <span class="n">alt</span> <span class="o">==</span> <span class="s2">&quot;similarity&quot;</span><span class="p">:</span>
<a id="__codelineno-0-1284" name="__codelineno-0-1284"></a>        <span class="n">alt</span> <span class="o">=</span> <span class="s2">&quot;less&quot;</span>
<a id="__codelineno-0-1285" name="__codelineno-0-1285"></a>
<a id="__codelineno-0-1286" name="__codelineno-0-1286"></a>    <span class="c1"># Check d_primeA, d_prime0 consistency with alternative</span>
<a id="__codelineno-0-1287" name="__codelineno-0-1287"></a>    <span class="k">if</span> <span class="n">alt</span> <span class="o">==</span> <span class="s2">&quot;greater&quot;</span> <span class="ow">and</span> <span class="n">d_primeA</span> <span class="o">&lt;</span> <span class="n">d_prime0</span><span class="p">:</span>
<a id="__codelineno-0-1288" name="__codelineno-0-1288"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-1289" name="__codelineno-0-1289"></a>            <span class="sa">f</span><span class="s2">&quot;Need d_primeA &gt;= d_prime0 when alternative is &#39;</span><span class="si">{</span><span class="n">alternative</span><span class="si">}</span><span class="s2">&#39;&quot;</span>
<a id="__codelineno-0-1290" name="__codelineno-0-1290"></a>        <span class="p">)</span>
<a id="__codelineno-0-1291" name="__codelineno-0-1291"></a>    <span class="k">if</span> <span class="n">alt</span> <span class="o">==</span> <span class="s2">&quot;less&quot;</span> <span class="ow">and</span> <span class="n">d_primeA</span> <span class="o">&gt;</span> <span class="n">d_prime0</span><span class="p">:</span>
<a id="__codelineno-0-1292" name="__codelineno-0-1292"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-1293" name="__codelineno-0-1293"></a>            <span class="sa">f</span><span class="s2">&quot;Need d_primeA &lt;= d_prime0 when alternative is &#39;</span><span class="si">{</span><span class="n">alternative</span><span class="si">}</span><span class="s2">&#39;&quot;</span>
<a id="__codelineno-0-1294" name="__codelineno-0-1294"></a>        <span class="p">)</span>
<a id="__codelineno-0-1295" name="__codelineno-0-1295"></a>
<a id="__codelineno-0-1296" name="__codelineno-0-1296"></a>    <span class="c1"># Wilcoxon requires d_prime0 = 0</span>
<a id="__codelineno-0-1297" name="__codelineno-0-1297"></a>    <span class="k">if</span> <span class="n">statistic</span> <span class="o">==</span> <span class="s2">&quot;Wilcoxon&quot;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">d_prime0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">):</span>
<a id="__codelineno-0-1298" name="__codelineno-0-1298"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Wilcoxon statistic only available with d_prime0=0&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1299" name="__codelineno-0-1299"></a>
<a id="__codelineno-0-1300" name="__codelineno-0-1300"></a>    <span class="c1"># Get tau values</span>
<a id="__codelineno-0-1301" name="__codelineno-0-1301"></a>    <span class="k">if</span> <span class="n">method_tau</span> <span class="o">!=</span> <span class="s2">&quot;user_defined&quot;</span><span class="p">:</span>
<a id="__codelineno-0-1302" name="__codelineno-0-1302"></a>        <span class="n">method_map</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-1303" name="__codelineno-0-1303"></a>            <span class="s2">&quot;equi_prob&quot;</span><span class="p">:</span> <span class="s2">&quot;equi_prob&quot;</span><span class="p">,</span>
<a id="__codelineno-0-1304" name="__codelineno-0-1304"></a>            <span class="s2">&quot;LR_max&quot;</span><span class="p">:</span> <span class="s2">&quot;LR_max&quot;</span><span class="p">,</span>
<a id="__codelineno-0-1305" name="__codelineno-0-1305"></a>            <span class="s2">&quot;se_min&quot;</span><span class="p">:</span> <span class="s2">&quot;se_min&quot;</span><span class="p">,</span>
<a id="__codelineno-0-1306" name="__codelineno-0-1306"></a>        <span class="p">}</span>
<a id="__codelineno-0-1307" name="__codelineno-0-1307"></a>        <span class="n">tau_result</span> <span class="o">=</span> <span class="n">optimal_tau</span><span class="p">(</span>
<a id="__codelineno-0-1308" name="__codelineno-0-1308"></a>            <span class="n">d_prime</span><span class="o">=</span><span class="n">d_primeA</span><span class="p">,</span>
<a id="__codelineno-0-1309" name="__codelineno-0-1309"></a>            <span class="n">d_prime0</span><span class="o">=</span><span class="n">d_prime0</span><span class="p">,</span>
<a id="__codelineno-0-1310" name="__codelineno-0-1310"></a>            <span class="n">ncat</span><span class="o">=</span><span class="n">ncat</span><span class="p">,</span>
<a id="__codelineno-0-1311" name="__codelineno-0-1311"></a>            <span class="n">method</span><span class="o">=</span><span class="n">method_map</span><span class="p">[</span><span class="n">method_tau</span><span class="p">],</span>
<a id="__codelineno-0-1312" name="__codelineno-0-1312"></a>            <span class="n">do_warn</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-1313" name="__codelineno-0-1313"></a>        <span class="p">)</span>
<a id="__codelineno-0-1314" name="__codelineno-0-1314"></a>        <span class="n">tau_arr</span> <span class="o">=</span> <span class="n">tau_result</span><span class="p">[</span><span class="s2">&quot;tau&quot;</span><span class="p">]</span>
<a id="__codelineno-0-1315" name="__codelineno-0-1315"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1316" name="__codelineno-0-1316"></a>        <span class="k">if</span> <span class="n">tau</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1317" name="__codelineno-0-1317"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;tau must be provided when method_tau=&#39;user_defined&#39;&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1318" name="__codelineno-0-1318"></a>        <span class="n">tau_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">tau</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
<a id="__codelineno-0-1319" name="__codelineno-0-1319"></a>
<a id="__codelineno-0-1320" name="__codelineno-0-1320"></a>    <span class="c1"># Handle random state</span>
<a id="__codelineno-0-1321" name="__codelineno-0-1321"></a>    <span class="k">if</span> <span class="n">random_state</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1322" name="__codelineno-0-1322"></a>        <span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">()</span>
<a id="__codelineno-0-1323" name="__codelineno-0-1323"></a>    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">random_state</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
<a id="__codelineno-0-1324" name="__codelineno-0-1324"></a>        <span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="n">random_state</span><span class="p">)</span>
<a id="__codelineno-0-1325" name="__codelineno-0-1325"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1326" name="__codelineno-0-1326"></a>        <span class="n">rng</span> <span class="o">=</span> <span class="n">random_state</span>
<a id="__codelineno-0-1327" name="__codelineno-0-1327"></a>
<a id="__codelineno-0-1328" name="__codelineno-0-1328"></a>    <span class="c1"># Run simulations</span>
<a id="__codelineno-0-1329" name="__codelineno-0-1329"></a>    <span class="n">pvals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">nsim</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
<a id="__codelineno-0-1330" name="__codelineno-0-1330"></a>    <span class="n">ctrl</span> <span class="o">=</span> <span class="n">DODControl</span><span class="p">(</span><span class="n">get_vcov</span><span class="o">=</span><span class="n">statistic</span> <span class="o">==</span> <span class="s2">&quot;Wald&quot;</span><span class="p">,</span> <span class="n">get_grad</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">do_warn</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-0-1331" name="__codelineno-0-1331"></a>
<a id="__codelineno-0-1332" name="__codelineno-0-1332"></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nsim</span><span class="p">):</span>
<a id="__codelineno-0-1333" name="__codelineno-0-1333"></a>        <span class="c1"># Simulate data under alternative</span>
<a id="__codelineno-0-1334" name="__codelineno-0-1334"></a>        <span class="n">data</span> <span class="o">=</span> <span class="n">dod_sim</span><span class="p">(</span>
<a id="__codelineno-0-1335" name="__codelineno-0-1335"></a>            <span class="n">d_prime</span><span class="o">=</span><span class="n">d_primeA</span><span class="p">,</span>
<a id="__codelineno-0-1336" name="__codelineno-0-1336"></a>            <span class="n">sample_size</span><span class="o">=</span><span class="n">size</span><span class="p">,</span>
<a id="__codelineno-0-1337" name="__codelineno-0-1337"></a>            <span class="n">method_tau</span><span class="o">=</span><span class="s2">&quot;user_defined&quot;</span><span class="p">,</span>
<a id="__codelineno-0-1338" name="__codelineno-0-1338"></a>            <span class="n">tau</span><span class="o">=</span><span class="n">tau_arr</span><span class="p">,</span>
<a id="__codelineno-0-1339" name="__codelineno-0-1339"></a>            <span class="n">random_state</span><span class="o">=</span><span class="n">rng</span><span class="p">,</span>
<a id="__codelineno-0-1340" name="__codelineno-0-1340"></a>        <span class="p">)</span>
<a id="__codelineno-0-1341" name="__codelineno-0-1341"></a>        <span class="n">same_sim</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span>
<a id="__codelineno-0-1342" name="__codelineno-0-1342"></a>        <span class="n">diff_sim</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span>
<a id="__codelineno-0-1343" name="__codelineno-0-1343"></a>
<a id="__codelineno-0-1344" name="__codelineno-0-1344"></a>        <span class="k">if</span> <span class="n">statistic</span> <span class="o">==</span> <span class="s2">&quot;Wilcoxon&quot;</span><span class="p">:</span>
<a id="__codelineno-0-1345" name="__codelineno-0-1345"></a>            <span class="c1"># Special case: Wilcoxon test without DOD fitting</span>
<a id="__codelineno-0-1346" name="__codelineno-0-1346"></a>            <span class="kn">from</span><span class="w"> </span><span class="nn">scipy.stats</span><span class="w"> </span><span class="kn">import</span> <span class="n">mannwhitneyu</span>
<a id="__codelineno-0-1347" name="__codelineno-0-1347"></a>
<a id="__codelineno-0-1348" name="__codelineno-0-1348"></a>            <span class="n">nlev</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-1349" name="__codelineno-0-1349"></a>            <span class="c1"># Expand rating categories by their counts for each pair type</span>
<a id="__codelineno-0-1350" name="__codelineno-0-1350"></a>            <span class="n">diff_pair_ratings</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">nlev</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="n">diff_sim</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">))</span>
<a id="__codelineno-0-1351" name="__codelineno-0-1351"></a>            <span class="n">same_pair_ratings</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">nlev</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="n">same_sim</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">))</span>
<a id="__codelineno-0-1352" name="__codelineno-0-1352"></a>
<a id="__codelineno-0-1353" name="__codelineno-0-1353"></a>            <span class="k">if</span> <span class="n">alt</span> <span class="o">==</span> <span class="s2">&quot;two.sided&quot;</span><span class="p">:</span>
<a id="__codelineno-0-1354" name="__codelineno-0-1354"></a>                <span class="n">alt_mwu</span> <span class="o">=</span> <span class="s2">&quot;two-sided&quot;</span>
<a id="__codelineno-0-1355" name="__codelineno-0-1355"></a>            <span class="k">elif</span> <span class="n">alt</span> <span class="o">==</span> <span class="s2">&quot;greater&quot;</span><span class="p">:</span>
<a id="__codelineno-0-1356" name="__codelineno-0-1356"></a>                <span class="n">alt_mwu</span> <span class="o">=</span> <span class="s2">&quot;greater&quot;</span>
<a id="__codelineno-0-1357" name="__codelineno-0-1357"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1358" name="__codelineno-0-1358"></a>                <span class="n">alt_mwu</span> <span class="o">=</span> <span class="s2">&quot;less&quot;</span>
<a id="__codelineno-0-1359" name="__codelineno-0-1359"></a>
<a id="__codelineno-0-1360" name="__codelineno-0-1360"></a>            <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-1361" name="__codelineno-0-1361"></a>                <span class="c1"># Test if diff-pair ratings are stochastically greater than same-pair ratings</span>
<a id="__codelineno-0-1362" name="__codelineno-0-1362"></a>                <span class="n">mwu_result</span> <span class="o">=</span> <span class="n">mannwhitneyu</span><span class="p">(</span><span class="n">diff_pair_ratings</span><span class="p">,</span> <span class="n">same_pair_ratings</span><span class="p">,</span> <span class="n">alternative</span><span class="o">=</span><span class="n">alt_mwu</span><span class="p">)</span>
<a id="__codelineno-0-1363" name="__codelineno-0-1363"></a>                <span class="n">pvals</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">mwu_result</span><span class="o">.</span><span class="n">pvalue</span>
<a id="__codelineno-0-1364" name="__codelineno-0-1364"></a>            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
<a id="__codelineno-0-1365" name="__codelineno-0-1365"></a>                <span class="k">pass</span>
<a id="__codelineno-0-1366" name="__codelineno-0-1366"></a>
<a id="__codelineno-0-1367" name="__codelineno-0-1367"></a>        <span class="k">elif</span> <span class="n">statistic</span> <span class="o">==</span> <span class="s2">&quot;Wald&quot;</span><span class="p">:</span>
<a id="__codelineno-0-1368" name="__codelineno-0-1368"></a>            <span class="c1"># Wald test</span>
<a id="__codelineno-0-1369" name="__codelineno-0-1369"></a>            <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-1370" name="__codelineno-0-1370"></a>                <span class="n">fit</span> <span class="o">=</span> <span class="n">dod_fit</span><span class="p">(</span><span class="n">same_sim</span><span class="p">,</span> <span class="n">diff_sim</span><span class="p">,</span> <span class="n">control</span><span class="o">=</span><span class="n">ctrl</span><span class="p">)</span>
<a id="__codelineno-0-1371" name="__codelineno-0-1371"></a>                <span class="k">if</span> <span class="n">fit</span><span class="o">.</span><span class="n">vcov</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isfinite</span><span class="p">(</span><span class="n">fit</span><span class="o">.</span><span class="n">vcov</span><span class="p">)):</span>
<a id="__codelineno-0-1372" name="__codelineno-0-1372"></a>                    <span class="n">std_err</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">fit</span><span class="o">.</span><span class="n">vcov</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<a id="__codelineno-0-1373" name="__codelineno-0-1373"></a>                    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isfinite</span><span class="p">(</span><span class="n">std_err</span><span class="p">)</span> <span class="ow">and</span> <span class="n">std_err</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-1374" name="__codelineno-0-1374"></a>                        <span class="n">stat_value</span> <span class="o">=</span> <span class="p">(</span><span class="n">fit</span><span class="o">.</span><span class="n">d_prime</span> <span class="o">-</span> <span class="n">d_prime0</span><span class="p">)</span> <span class="o">/</span> <span class="n">std_err</span>
<a id="__codelineno-0-1375" name="__codelineno-0-1375"></a>                        <span class="n">p_val</span> <span class="o">=</span> <span class="n">normal_pvalue</span><span class="p">(</span><span class="n">stat_value</span><span class="p">,</span> <span class="n">alt</span><span class="p">)</span>
<a id="__codelineno-0-1376" name="__codelineno-0-1376"></a>                        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">p_val</span><span class="p">,</span> <span class="s1">&#39;item&#39;</span><span class="p">):</span>
<a id="__codelineno-0-1377" name="__codelineno-0-1377"></a>                            <span class="n">p_val</span> <span class="o">=</span> <span class="n">p_val</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
<a id="__codelineno-0-1378" name="__codelineno-0-1378"></a>                        <span class="n">pvals</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">p_val</span>
<a id="__codelineno-0-1379" name="__codelineno-0-1379"></a>            <span class="k">except</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="ne">RuntimeError</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">LinAlgError</span><span class="p">):</span>
<a id="__codelineno-0-1380" name="__codelineno-0-1380"></a>                <span class="c1"># Optimization or numerical errors - skip this simulation</span>
<a id="__codelineno-0-1381" name="__codelineno-0-1381"></a>                <span class="k">pass</span>
<a id="__codelineno-0-1382" name="__codelineno-0-1382"></a>
<a id="__codelineno-0-1383" name="__codelineno-0-1383"></a>        <span class="k">else</span><span class="p">:</span>  <span class="c1"># likelihood or Pearson</span>
<a id="__codelineno-0-1384" name="__codelineno-0-1384"></a>            <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-1385" name="__codelineno-0-1385"></a>                <span class="n">result</span> <span class="o">=</span> <span class="n">dod</span><span class="p">(</span>
<a id="__codelineno-0-1386" name="__codelineno-0-1386"></a>                    <span class="n">same_sim</span><span class="p">,</span> <span class="n">diff_sim</span><span class="p">,</span>
<a id="__codelineno-0-1387" name="__codelineno-0-1387"></a>                    <span class="n">d_prime0</span><span class="o">=</span><span class="n">d_prime0</span><span class="p">,</span>
<a id="__codelineno-0-1388" name="__codelineno-0-1388"></a>                    <span class="n">alternative</span><span class="o">=</span><span class="n">alt</span><span class="p">,</span>
<a id="__codelineno-0-1389" name="__codelineno-0-1389"></a>                    <span class="n">statistic</span><span class="o">=</span><span class="n">statistic</span><span class="p">,</span>
<a id="__codelineno-0-1390" name="__codelineno-0-1390"></a>                    <span class="n">control</span><span class="o">=</span><span class="n">ctrl</span><span class="p">,</span>
<a id="__codelineno-0-1391" name="__codelineno-0-1391"></a>                <span class="p">)</span>
<a id="__codelineno-0-1392" name="__codelineno-0-1392"></a>                <span class="k">if</span> <span class="n">result</span><span class="o">.</span><span class="n">convergence</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-1393" name="__codelineno-0-1393"></a>                    <span class="c1"># p_value may be array, extract scalar</span>
<a id="__codelineno-0-1394" name="__codelineno-0-1394"></a>                    <span class="n">p_val</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">p_value</span>
<a id="__codelineno-0-1395" name="__codelineno-0-1395"></a>                    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">p_val</span><span class="p">,</span> <span class="s1">&#39;item&#39;</span><span class="p">):</span>
<a id="__codelineno-0-1396" name="__codelineno-0-1396"></a>                        <span class="n">p_val</span> <span class="o">=</span> <span class="n">p_val</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
<a id="__codelineno-0-1397" name="__codelineno-0-1397"></a>                    <span class="n">pvals</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">p_val</span>
<a id="__codelineno-0-1398" name="__codelineno-0-1398"></a>            <span class="k">except</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="ne">RuntimeError</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">LinAlgError</span><span class="p">):</span>
<a id="__codelineno-0-1399" name="__codelineno-0-1399"></a>                <span class="c1"># Optimization or numerical errors - skip this simulation</span>
<a id="__codelineno-0-1400" name="__codelineno-0-1400"></a>                <span class="k">pass</span>
<a id="__codelineno-0-1401" name="__codelineno-0-1401"></a>
<a id="__codelineno-0-1402" name="__codelineno-0-1402"></a>    <span class="c1"># Compute power</span>
<a id="__codelineno-0-1403" name="__codelineno-0-1403"></a>    <span class="n">valid_pvals</span> <span class="o">=</span> <span class="n">pvals</span><span class="p">[</span><span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">pvals</span><span class="p">)]</span>
<a id="__codelineno-0-1404" name="__codelineno-0-1404"></a>    <span class="n">n_used</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">valid_pvals</span><span class="p">)</span>
<a id="__codelineno-0-1405" name="__codelineno-0-1405"></a>
<a id="__codelineno-0-1406" name="__codelineno-0-1406"></a>    <span class="k">if</span> <span class="n">n_used</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-1407" name="__codelineno-0-1407"></a>        <span class="n">power</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
<a id="__codelineno-0-1408" name="__codelineno-0-1408"></a>        <span class="n">se_power</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
<a id="__codelineno-0-1409" name="__codelineno-0-1409"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1410" name="__codelineno-0-1410"></a>        <span class="n">power</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">valid_pvals</span> <span class="o">&lt;</span> <span class="n">alpha</span><span class="p">)</span>
<a id="__codelineno-0-1411" name="__codelineno-0-1411"></a>        <span class="k">if</span> <span class="n">power</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">power</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">isfinite</span><span class="p">(</span><span class="n">power</span><span class="p">):</span>
<a id="__codelineno-0-1412" name="__codelineno-0-1412"></a>            <span class="n">se_power</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
<a id="__codelineno-0-1413" name="__codelineno-0-1413"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1414" name="__codelineno-0-1414"></a>            <span class="n">se_power</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">power</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">power</span><span class="p">)</span> <span class="o">/</span> <span class="n">n_used</span><span class="p">)</span>
<a id="__codelineno-0-1415" name="__codelineno-0-1415"></a>
<a id="__codelineno-0-1416" name="__codelineno-0-1416"></a>    <span class="k">return</span> <span class="n">DODPowerResult</span><span class="p">(</span>
<a id="__codelineno-0-1417" name="__codelineno-0-1417"></a>        <span class="n">power</span><span class="o">=</span><span class="n">power</span><span class="p">,</span>
<a id="__codelineno-0-1418" name="__codelineno-0-1418"></a>        <span class="n">se_power</span><span class="o">=</span><span class="n">se_power</span><span class="p">,</span>
<a id="__codelineno-0-1419" name="__codelineno-0-1419"></a>        <span class="n">n_used</span><span class="o">=</span><span class="n">n_used</span><span class="p">,</span>
<a id="__codelineno-0-1420" name="__codelineno-0-1420"></a>        <span class="n">d_primeA</span><span class="o">=</span><span class="n">d_primeA</span><span class="p">,</span>
<a id="__codelineno-0-1421" name="__codelineno-0-1421"></a>        <span class="n">d_prime0</span><span class="o">=</span><span class="n">d_prime0</span><span class="p">,</span>
<a id="__codelineno-0-1422" name="__codelineno-0-1422"></a>        <span class="n">sample_size</span><span class="o">=</span><span class="n">size</span><span class="p">,</span>
<a id="__codelineno-0-1423" name="__codelineno-0-1423"></a>        <span class="n">nsim</span><span class="o">=</span><span class="n">nsim</span><span class="p">,</span>
<a id="__codelineno-0-1424" name="__codelineno-0-1424"></a>        <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span>
<a id="__codelineno-0-1425" name="__codelineno-0-1425"></a>        <span class="n">statistic</span><span class="o">=</span><span class="n">statistic</span><span class="p">,</span>
<a id="__codelineno-0-1426" name="__codelineno-0-1426"></a>        <span class="n">alternative</span><span class="o">=</span><span class="n">alt</span><span class="p">,</span>
<a id="__codelineno-0-1427" name="__codelineno-0-1427"></a>        <span class="n">tau</span><span class="o">=</span><span class="n">tau_arr</span><span class="p">,</span>
<a id="__codelineno-0-1428" name="__codelineno-0-1428"></a>    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div><h2 id="sample-size-calculation">Sample Size Calculation</h2>
<h3 id="discrim_sample_size">discrim_sample_size</h3>


<div class="doc doc-object doc-function">


<h2 id="senspy.discrim_sample_size" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">discrim_sample_size</span><span class="p">(</span><span class="n">pd_a</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">pd_0</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">target_power</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.9</span><span class="p">,</span> <span class="n">alpha</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">,</span> <span class="n">p_guess</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">test</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;difference&#39;</span><span class="p">,</span> <span class="n">statistic</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;exact&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span></code>

</h2>


    <div class="doc doc-contents first">

        <p>Compute required sample size for a discrimination test.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>pd_a</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True proportion of discriminators (alternative hypothesis).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>pd_0</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Null hypothesis proportion of discriminators.</p>
              </div>
            </td>
            <td>
                  <code>0.0</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>target_power</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Desired statistical power.</p>
              </div>
            </td>
            <td>
                  <code>0.90</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>alpha</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Significance level.</p>
              </div>
            </td>
            <td>
                  <code>0.05</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>p_guess</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Guessing probability for the protocol.</p>
              </div>
            </td>
            <td>
                  <code>0.5</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>test</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Type of test: "difference" or "similarity".</p>
              </div>
            </td>
            <td>
                  <code>&#34;difference&#34;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>statistic</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Method for computing sample size:
- "exact": First n where exact power exceeds target
- "stable.exact": Stable n (power stays above target)
- "normal": Normal approximation
- "cont.normal": Normal approximation with continuity correction</p>
              </div>
            </td>
            <td>
                  <code>&#34;exact&#34;</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Required sample size.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Sample size for triangle test with 30% discriminators</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">discrim_sample_size</span><span class="p">(</span><span class="n">pd_a</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">p_guess</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="go">85</span>
</code></pre></div>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Using normal approximation</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">discrim_sample_size</span><span class="p">(</span><span class="n">pd_a</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">p_guess</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="n">statistic</span><span class="o">=</span><span class="s2">&quot;normal&quot;</span><span class="p">)</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="go">83</span>
</code></pre></div>


<details class="note" open>
  <summary>Notes</summary>
  <p>Corresponds to <code>discrimSS()</code> in sensR.</p>
<p>The "exact" method finds the first sample size where power exceeds
the target. Due to the discrete nature of the binomial distribution,
power may drop below target for slightly larger n. Use "stable.exact"
if you need power to remain above target for all larger sample sizes.</p>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>senspy/power.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-451">451</a></span>
<span class="normal"><a href="#__codelineno-0-452">452</a></span>
<span class="normal"><a href="#__codelineno-0-453">453</a></span>
<span class="normal"><a href="#__codelineno-0-454">454</a></span>
<span class="normal"><a href="#__codelineno-0-455">455</a></span>
<span class="normal"><a href="#__codelineno-0-456">456</a></span>
<span class="normal"><a href="#__codelineno-0-457">457</a></span>
<span class="normal"><a href="#__codelineno-0-458">458</a></span>
<span class="normal"><a href="#__codelineno-0-459">459</a></span>
<span class="normal"><a href="#__codelineno-0-460">460</a></span>
<span class="normal"><a href="#__codelineno-0-461">461</a></span>
<span class="normal"><a href="#__codelineno-0-462">462</a></span>
<span class="normal"><a href="#__codelineno-0-463">463</a></span>
<span class="normal"><a href="#__codelineno-0-464">464</a></span>
<span class="normal"><a href="#__codelineno-0-465">465</a></span>
<span class="normal"><a href="#__codelineno-0-466">466</a></span>
<span class="normal"><a href="#__codelineno-0-467">467</a></span>
<span class="normal"><a href="#__codelineno-0-468">468</a></span>
<span class="normal"><a href="#__codelineno-0-469">469</a></span>
<span class="normal"><a href="#__codelineno-0-470">470</a></span>
<span class="normal"><a href="#__codelineno-0-471">471</a></span>
<span class="normal"><a href="#__codelineno-0-472">472</a></span>
<span class="normal"><a href="#__codelineno-0-473">473</a></span>
<span class="normal"><a href="#__codelineno-0-474">474</a></span>
<span class="normal"><a href="#__codelineno-0-475">475</a></span>
<span class="normal"><a href="#__codelineno-0-476">476</a></span>
<span class="normal"><a href="#__codelineno-0-477">477</a></span>
<span class="normal"><a href="#__codelineno-0-478">478</a></span>
<span class="normal"><a href="#__codelineno-0-479">479</a></span>
<span class="normal"><a href="#__codelineno-0-480">480</a></span>
<span class="normal"><a href="#__codelineno-0-481">481</a></span>
<span class="normal"><a href="#__codelineno-0-482">482</a></span>
<span class="normal"><a href="#__codelineno-0-483">483</a></span>
<span class="normal"><a href="#__codelineno-0-484">484</a></span>
<span class="normal"><a href="#__codelineno-0-485">485</a></span>
<span class="normal"><a href="#__codelineno-0-486">486</a></span>
<span class="normal"><a href="#__codelineno-0-487">487</a></span>
<span class="normal"><a href="#__codelineno-0-488">488</a></span>
<span class="normal"><a href="#__codelineno-0-489">489</a></span>
<span class="normal"><a href="#__codelineno-0-490">490</a></span>
<span class="normal"><a href="#__codelineno-0-491">491</a></span>
<span class="normal"><a href="#__codelineno-0-492">492</a></span>
<span class="normal"><a href="#__codelineno-0-493">493</a></span>
<span class="normal"><a href="#__codelineno-0-494">494</a></span>
<span class="normal"><a href="#__codelineno-0-495">495</a></span>
<span class="normal"><a href="#__codelineno-0-496">496</a></span>
<span class="normal"><a href="#__codelineno-0-497">497</a></span>
<span class="normal"><a href="#__codelineno-0-498">498</a></span>
<span class="normal"><a href="#__codelineno-0-499">499</a></span>
<span class="normal"><a href="#__codelineno-0-500">500</a></span>
<span class="normal"><a href="#__codelineno-0-501">501</a></span>
<span class="normal"><a href="#__codelineno-0-502">502</a></span>
<span class="normal"><a href="#__codelineno-0-503">503</a></span>
<span class="normal"><a href="#__codelineno-0-504">504</a></span>
<span class="normal"><a href="#__codelineno-0-505">505</a></span>
<span class="normal"><a href="#__codelineno-0-506">506</a></span>
<span class="normal"><a href="#__codelineno-0-507">507</a></span>
<span class="normal"><a href="#__codelineno-0-508">508</a></span>
<span class="normal"><a href="#__codelineno-0-509">509</a></span>
<span class="normal"><a href="#__codelineno-0-510">510</a></span>
<span class="normal"><a href="#__codelineno-0-511">511</a></span>
<span class="normal"><a href="#__codelineno-0-512">512</a></span>
<span class="normal"><a href="#__codelineno-0-513">513</a></span>
<span class="normal"><a href="#__codelineno-0-514">514</a></span>
<span class="normal"><a href="#__codelineno-0-515">515</a></span>
<span class="normal"><a href="#__codelineno-0-516">516</a></span>
<span class="normal"><a href="#__codelineno-0-517">517</a></span>
<span class="normal"><a href="#__codelineno-0-518">518</a></span>
<span class="normal"><a href="#__codelineno-0-519">519</a></span>
<span class="normal"><a href="#__codelineno-0-520">520</a></span>
<span class="normal"><a href="#__codelineno-0-521">521</a></span>
<span class="normal"><a href="#__codelineno-0-522">522</a></span>
<span class="normal"><a href="#__codelineno-0-523">523</a></span>
<span class="normal"><a href="#__codelineno-0-524">524</a></span>
<span class="normal"><a href="#__codelineno-0-525">525</a></span>
<span class="normal"><a href="#__codelineno-0-526">526</a></span>
<span class="normal"><a href="#__codelineno-0-527">527</a></span>
<span class="normal"><a href="#__codelineno-0-528">528</a></span>
<span class="normal"><a href="#__codelineno-0-529">529</a></span>
<span class="normal"><a href="#__codelineno-0-530">530</a></span>
<span class="normal"><a href="#__codelineno-0-531">531</a></span>
<span class="normal"><a href="#__codelineno-0-532">532</a></span>
<span class="normal"><a href="#__codelineno-0-533">533</a></span>
<span class="normal"><a href="#__codelineno-0-534">534</a></span>
<span class="normal"><a href="#__codelineno-0-535">535</a></span>
<span class="normal"><a href="#__codelineno-0-536">536</a></span>
<span class="normal"><a href="#__codelineno-0-537">537</a></span>
<span class="normal"><a href="#__codelineno-0-538">538</a></span>
<span class="normal"><a href="#__codelineno-0-539">539</a></span>
<span class="normal"><a href="#__codelineno-0-540">540</a></span>
<span class="normal"><a href="#__codelineno-0-541">541</a></span>
<span class="normal"><a href="#__codelineno-0-542">542</a></span>
<span class="normal"><a href="#__codelineno-0-543">543</a></span>
<span class="normal"><a href="#__codelineno-0-544">544</a></span>
<span class="normal"><a href="#__codelineno-0-545">545</a></span>
<span class="normal"><a href="#__codelineno-0-546">546</a></span>
<span class="normal"><a href="#__codelineno-0-547">547</a></span>
<span class="normal"><a href="#__codelineno-0-548">548</a></span>
<span class="normal"><a href="#__codelineno-0-549">549</a></span>
<span class="normal"><a href="#__codelineno-0-550">550</a></span>
<span class="normal"><a href="#__codelineno-0-551">551</a></span>
<span class="normal"><a href="#__codelineno-0-552">552</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-451" name="__codelineno-0-451"></a><span class="k">def</span><span class="w"> </span><span class="nf">discrim_sample_size</span><span class="p">(</span>
<a id="__codelineno-0-452" name="__codelineno-0-452"></a>    <span class="n">pd_a</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
<a id="__codelineno-0-453" name="__codelineno-0-453"></a>    <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-454" name="__codelineno-0-454"></a>    <span class="n">pd_0</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
<a id="__codelineno-0-455" name="__codelineno-0-455"></a>    <span class="n">target_power</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.90</span><span class="p">,</span>
<a id="__codelineno-0-456" name="__codelineno-0-456"></a>    <span class="n">alpha</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">,</span>
<a id="__codelineno-0-457" name="__codelineno-0-457"></a>    <span class="n">p_guess</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span>
<a id="__codelineno-0-458" name="__codelineno-0-458"></a>    <span class="n">test</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;difference&quot;</span><span class="p">,</span>
<a id="__codelineno-0-459" name="__codelineno-0-459"></a>    <span class="n">statistic</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;exact&quot;</span><span class="p">,</span>
<a id="__codelineno-0-460" name="__codelineno-0-460"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<a id="__codelineno-0-461" name="__codelineno-0-461"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute required sample size for a discrimination test.</span>
<a id="__codelineno-0-462" name="__codelineno-0-462"></a>
<a id="__codelineno-0-463" name="__codelineno-0-463"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-464" name="__codelineno-0-464"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-465" name="__codelineno-0-465"></a><span class="sd">    pd_a : float</span>
<a id="__codelineno-0-466" name="__codelineno-0-466"></a><span class="sd">        True proportion of discriminators (alternative hypothesis).</span>
<a id="__codelineno-0-467" name="__codelineno-0-467"></a><span class="sd">    pd_0 : float, default 0.0</span>
<a id="__codelineno-0-468" name="__codelineno-0-468"></a><span class="sd">        Null hypothesis proportion of discriminators.</span>
<a id="__codelineno-0-469" name="__codelineno-0-469"></a><span class="sd">    target_power : float, default 0.90</span>
<a id="__codelineno-0-470" name="__codelineno-0-470"></a><span class="sd">        Desired statistical power.</span>
<a id="__codelineno-0-471" name="__codelineno-0-471"></a><span class="sd">    alpha : float, default 0.05</span>
<a id="__codelineno-0-472" name="__codelineno-0-472"></a><span class="sd">        Significance level.</span>
<a id="__codelineno-0-473" name="__codelineno-0-473"></a><span class="sd">    p_guess : float, default 0.5</span>
<a id="__codelineno-0-474" name="__codelineno-0-474"></a><span class="sd">        Guessing probability for the protocol.</span>
<a id="__codelineno-0-475" name="__codelineno-0-475"></a><span class="sd">    test : str, default &quot;difference&quot;</span>
<a id="__codelineno-0-476" name="__codelineno-0-476"></a><span class="sd">        Type of test: &quot;difference&quot; or &quot;similarity&quot;.</span>
<a id="__codelineno-0-477" name="__codelineno-0-477"></a><span class="sd">    statistic : str, default &quot;exact&quot;</span>
<a id="__codelineno-0-478" name="__codelineno-0-478"></a><span class="sd">        Method for computing sample size:</span>
<a id="__codelineno-0-479" name="__codelineno-0-479"></a><span class="sd">        - &quot;exact&quot;: First n where exact power exceeds target</span>
<a id="__codelineno-0-480" name="__codelineno-0-480"></a><span class="sd">        - &quot;stable.exact&quot;: Stable n (power stays above target)</span>
<a id="__codelineno-0-481" name="__codelineno-0-481"></a><span class="sd">        - &quot;normal&quot;: Normal approximation</span>
<a id="__codelineno-0-482" name="__codelineno-0-482"></a><span class="sd">        - &quot;cont.normal&quot;: Normal approximation with continuity correction</span>
<a id="__codelineno-0-483" name="__codelineno-0-483"></a>
<a id="__codelineno-0-484" name="__codelineno-0-484"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-485" name="__codelineno-0-485"></a><span class="sd">    -------</span>
<a id="__codelineno-0-486" name="__codelineno-0-486"></a><span class="sd">    int</span>
<a id="__codelineno-0-487" name="__codelineno-0-487"></a><span class="sd">        Required sample size.</span>
<a id="__codelineno-0-488" name="__codelineno-0-488"></a>
<a id="__codelineno-0-489" name="__codelineno-0-489"></a><span class="sd">    Examples</span>
<a id="__codelineno-0-490" name="__codelineno-0-490"></a><span class="sd">    --------</span>
<a id="__codelineno-0-491" name="__codelineno-0-491"></a><span class="sd">    &gt;&gt;&gt; # Sample size for triangle test with 30% discriminators</span>
<a id="__codelineno-0-492" name="__codelineno-0-492"></a><span class="sd">    &gt;&gt;&gt; discrim_sample_size(pd_a=0.3, p_guess=1/3)</span>
<a id="__codelineno-0-493" name="__codelineno-0-493"></a><span class="sd">    85</span>
<a id="__codelineno-0-494" name="__codelineno-0-494"></a>
<a id="__codelineno-0-495" name="__codelineno-0-495"></a><span class="sd">    &gt;&gt;&gt; # Using normal approximation</span>
<a id="__codelineno-0-496" name="__codelineno-0-496"></a><span class="sd">    &gt;&gt;&gt; discrim_sample_size(pd_a=0.3, p_guess=1/3, statistic=&quot;normal&quot;)</span>
<a id="__codelineno-0-497" name="__codelineno-0-497"></a><span class="sd">    83</span>
<a id="__codelineno-0-498" name="__codelineno-0-498"></a>
<a id="__codelineno-0-499" name="__codelineno-0-499"></a><span class="sd">    Notes</span>
<a id="__codelineno-0-500" name="__codelineno-0-500"></a><span class="sd">    -----</span>
<a id="__codelineno-0-501" name="__codelineno-0-501"></a><span class="sd">    Corresponds to `discrimSS()` in sensR.</span>
<a id="__codelineno-0-502" name="__codelineno-0-502"></a>
<a id="__codelineno-0-503" name="__codelineno-0-503"></a><span class="sd">    The &quot;exact&quot; method finds the first sample size where power exceeds</span>
<a id="__codelineno-0-504" name="__codelineno-0-504"></a><span class="sd">    the target. Due to the discrete nature of the binomial distribution,</span>
<a id="__codelineno-0-505" name="__codelineno-0-505"></a><span class="sd">    power may drop below target for slightly larger n. Use &quot;stable.exact&quot;</span>
<a id="__codelineno-0-506" name="__codelineno-0-506"></a><span class="sd">    if you need power to remain above target for all larger sample sizes.</span>
<a id="__codelineno-0-507" name="__codelineno-0-507"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-508" name="__codelineno-0-508"></a>    <span class="c1"># Validate inputs</span>
<a id="__codelineno-0-509" name="__codelineno-0-509"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="mi">0</span> <span class="o">&lt;</span> <span class="n">pd_a</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-510" name="__codelineno-0-510"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;&#39;pd_a&#39; must be between 0 and 1 (exclusive of 0)&quot;</span><span class="p">)</span>
<a id="__codelineno-0-511" name="__codelineno-0-511"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">pd_0</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-512" name="__codelineno-0-512"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;&#39;pd_0&#39; must be between 0 and 1&quot;</span><span class="p">)</span>
<a id="__codelineno-0-513" name="__codelineno-0-513"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="mi">0</span> <span class="o">&lt;</span> <span class="n">target_power</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-514" name="__codelineno-0-514"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;&#39;target_power&#39; must be between 0 and 1&quot;</span><span class="p">)</span>
<a id="__codelineno-0-515" name="__codelineno-0-515"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="mi">0</span> <span class="o">&lt;</span> <span class="n">alpha</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-516" name="__codelineno-0-516"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;&#39;alpha&#39; must be between 0 and 1&quot;</span><span class="p">)</span>
<a id="__codelineno-0-517" name="__codelineno-0-517"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">p_guess</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-518" name="__codelineno-0-518"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;&#39;p_guess&#39; must be between 0 and 1&quot;</span><span class="p">)</span>
<a id="__codelineno-0-519" name="__codelineno-0-519"></a>
<a id="__codelineno-0-520" name="__codelineno-0-520"></a>    <span class="c1"># Validate test type</span>
<a id="__codelineno-0-521" name="__codelineno-0-521"></a>    <span class="n">test</span> <span class="o">=</span> <span class="n">test</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
<a id="__codelineno-0-522" name="__codelineno-0-522"></a>    <span class="k">if</span> <span class="n">test</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;difference&quot;</span><span class="p">,</span> <span class="s2">&quot;similarity&quot;</span><span class="p">):</span>
<a id="__codelineno-0-523" name="__codelineno-0-523"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;&#39;test&#39; must be &#39;difference&#39; or &#39;similarity&#39;&quot;</span><span class="p">)</span>
<a id="__codelineno-0-524" name="__codelineno-0-524"></a>
<a id="__codelineno-0-525" name="__codelineno-0-525"></a>    <span class="c1"># Validate pd_a vs pd_0 for test type</span>
<a id="__codelineno-0-526" name="__codelineno-0-526"></a>    <span class="k">if</span> <span class="n">test</span> <span class="o">==</span> <span class="s2">&quot;difference&quot;</span> <span class="ow">and</span> <span class="n">pd_a</span> <span class="o">&lt;=</span> <span class="n">pd_0</span><span class="p">:</span>
<a id="__codelineno-0-527" name="__codelineno-0-527"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;&#39;pd_a&#39; must be &gt; &#39;pd_0&#39; for difference tests&quot;</span><span class="p">)</span>
<a id="__codelineno-0-528" name="__codelineno-0-528"></a>    <span class="k">if</span> <span class="n">test</span> <span class="o">==</span> <span class="s2">&quot;similarity&quot;</span> <span class="ow">and</span> <span class="n">pd_a</span> <span class="o">&gt;=</span> <span class="n">pd_0</span><span class="p">:</span>
<a id="__codelineno-0-529" name="__codelineno-0-529"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;&#39;pd_a&#39; must be &lt; &#39;pd_0&#39; for similarity tests&quot;</span><span class="p">)</span>
<a id="__codelineno-0-530" name="__codelineno-0-530"></a>
<a id="__codelineno-0-531" name="__codelineno-0-531"></a>    <span class="c1"># Validate statistic</span>
<a id="__codelineno-0-532" name="__codelineno-0-532"></a>    <span class="n">statistic</span> <span class="o">=</span> <span class="n">_normalize_statistic</span><span class="p">(</span>
<a id="__codelineno-0-533" name="__codelineno-0-533"></a>        <span class="n">statistic</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;exact&quot;</span><span class="p">,</span> <span class="s2">&quot;stable_exact&quot;</span><span class="p">,</span> <span class="s2">&quot;normal&quot;</span><span class="p">,</span> <span class="s2">&quot;cont_normal&quot;</span><span class="p">}</span>
<a id="__codelineno-0-534" name="__codelineno-0-534"></a>    <span class="p">)</span>
<a id="__codelineno-0-535" name="__codelineno-0-535"></a>
<a id="__codelineno-0-536" name="__codelineno-0-536"></a>    <span class="c1"># Compute sample size</span>
<a id="__codelineno-0-537" name="__codelineno-0-537"></a>    <span class="k">if</span> <span class="n">statistic</span> <span class="o">==</span> <span class="s2">&quot;normal&quot;</span><span class="p">:</span>
<a id="__codelineno-0-538" name="__codelineno-0-538"></a>        <span class="k">return</span> <span class="n">_normal_sample_size</span><span class="p">(</span>
<a id="__codelineno-0-539" name="__codelineno-0-539"></a>            <span class="n">pd_a</span><span class="p">,</span> <span class="n">pd_0</span><span class="p">,</span> <span class="n">target_power</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">p_guess</span><span class="p">,</span> <span class="n">test</span><span class="p">,</span> <span class="n">continuity</span><span class="o">=</span><span class="kc">False</span>
<a id="__codelineno-0-540" name="__codelineno-0-540"></a>        <span class="p">)</span>
<a id="__codelineno-0-541" name="__codelineno-0-541"></a>    <span class="k">elif</span> <span class="n">statistic</span> <span class="o">==</span> <span class="s2">&quot;cont_normal&quot;</span><span class="p">:</span>
<a id="__codelineno-0-542" name="__codelineno-0-542"></a>        <span class="k">return</span> <span class="n">_normal_sample_size</span><span class="p">(</span>
<a id="__codelineno-0-543" name="__codelineno-0-543"></a>            <span class="n">pd_a</span><span class="p">,</span> <span class="n">pd_0</span><span class="p">,</span> <span class="n">target_power</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">p_guess</span><span class="p">,</span> <span class="n">test</span><span class="p">,</span> <span class="n">continuity</span><span class="o">=</span><span class="kc">True</span>
<a id="__codelineno-0-544" name="__codelineno-0-544"></a>        <span class="p">)</span>
<a id="__codelineno-0-545" name="__codelineno-0-545"></a>    <span class="k">elif</span> <span class="n">statistic</span> <span class="o">==</span> <span class="s2">&quot;exact&quot;</span><span class="p">:</span>
<a id="__codelineno-0-546" name="__codelineno-0-546"></a>        <span class="k">return</span> <span class="n">_exact_sample_size</span><span class="p">(</span>
<a id="__codelineno-0-547" name="__codelineno-0-547"></a>            <span class="n">pd_a</span><span class="p">,</span> <span class="n">pd_0</span><span class="p">,</span> <span class="n">target_power</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">p_guess</span><span class="p">,</span> <span class="n">test</span><span class="p">,</span> <span class="n">stable</span><span class="o">=</span><span class="kc">False</span>
<a id="__codelineno-0-548" name="__codelineno-0-548"></a>        <span class="p">)</span>
<a id="__codelineno-0-549" name="__codelineno-0-549"></a>    <span class="k">else</span><span class="p">:</span>  <span class="c1"># stable_exact</span>
<a id="__codelineno-0-550" name="__codelineno-0-550"></a>        <span class="k">return</span> <span class="n">_exact_sample_size</span><span class="p">(</span>
<a id="__codelineno-0-551" name="__codelineno-0-551"></a>            <span class="n">pd_a</span><span class="p">,</span> <span class="n">pd_0</span><span class="p">,</span> <span class="n">target_power</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">p_guess</span><span class="p">,</span> <span class="n">test</span><span class="p">,</span> <span class="n">stable</span><span class="o">=</span><span class="kc">True</span>
<a id="__codelineno-0-552" name="__codelineno-0-552"></a>        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div><h3 id="dprime_sample_size">dprime_sample_size</h3>


<div class="doc doc-object doc-function">


<h2 id="senspy.dprime_sample_size" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">dprime_sample_size</span><span class="p">(</span><span class="n">d_prime_a</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">method</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Protocol</span> <span class="o">=</span> <span class="s1">&#39;triangle&#39;</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">d_prime_0</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">target_power</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.9</span><span class="p">,</span> <span class="n">alpha</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">,</span> <span class="n">test</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;difference&#39;</span><span class="p">,</span> <span class="n">statistic</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;exact&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span></code>

</h2>


    <div class="doc doc-contents first">

        <p>Compute required sample size using d-prime.</p>
<p>This is a convenience wrapper around <code>discrim_sample_size()</code> that
converts d-prime values to proportion of discriminators.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>d_prime_a</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True d-prime value (alternative hypothesis).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>method</code>
            </td>
            <td>
                  <code><span title="str">str</span> or <span title="senspy.core.types.Protocol">Protocol</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Discrimination protocol.</p>
              </div>
            </td>
            <td>
                  <code>&#34;triangle&#34;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>d_prime_0</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Null hypothesis d-prime value.</p>
              </div>
            </td>
            <td>
                  <code>0.0</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>target_power</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Desired statistical power.</p>
              </div>
            </td>
            <td>
                  <code>0.90</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>alpha</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Significance level.</p>
              </div>
            </td>
            <td>
                  <code>0.05</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>test</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Type of test: "difference" or "similarity".</p>
              </div>
            </td>
            <td>
                  <code>&#34;difference&#34;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>statistic</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Method: "exact", "stable.exact", "normal", or "cont.normal".</p>
              </div>
            </td>
            <td>
                  <code>&#34;exact&#34;</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Required sample size.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Sample size for triangle test with d&#39;=1.5</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">dprime_sample_size</span><span class="p">(</span><span class="n">d_prime_a</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;triangle&quot;</span><span class="p">)</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="go">62</span>
</code></pre></div>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Sample size for 2-AFC test with 80% power</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">dprime_sample_size</span><span class="p">(</span><span class="n">d_prime_a</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;twoafc&quot;</span><span class="p">,</span> <span class="n">target_power</span><span class="o">=</span><span class="mf">0.80</span><span class="p">)</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="go">47</span>
</code></pre></div>


<details class="note" open>
  <summary>Notes</summary>
  <p>Corresponds to <code>d.primeSS()</code> in sensR.</p>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>senspy/power.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-555">555</a></span>
<span class="normal"><a href="#__codelineno-0-556">556</a></span>
<span class="normal"><a href="#__codelineno-0-557">557</a></span>
<span class="normal"><a href="#__codelineno-0-558">558</a></span>
<span class="normal"><a href="#__codelineno-0-559">559</a></span>
<span class="normal"><a href="#__codelineno-0-560">560</a></span>
<span class="normal"><a href="#__codelineno-0-561">561</a></span>
<span class="normal"><a href="#__codelineno-0-562">562</a></span>
<span class="normal"><a href="#__codelineno-0-563">563</a></span>
<span class="normal"><a href="#__codelineno-0-564">564</a></span>
<span class="normal"><a href="#__codelineno-0-565">565</a></span>
<span class="normal"><a href="#__codelineno-0-566">566</a></span>
<span class="normal"><a href="#__codelineno-0-567">567</a></span>
<span class="normal"><a href="#__codelineno-0-568">568</a></span>
<span class="normal"><a href="#__codelineno-0-569">569</a></span>
<span class="normal"><a href="#__codelineno-0-570">570</a></span>
<span class="normal"><a href="#__codelineno-0-571">571</a></span>
<span class="normal"><a href="#__codelineno-0-572">572</a></span>
<span class="normal"><a href="#__codelineno-0-573">573</a></span>
<span class="normal"><a href="#__codelineno-0-574">574</a></span>
<span class="normal"><a href="#__codelineno-0-575">575</a></span>
<span class="normal"><a href="#__codelineno-0-576">576</a></span>
<span class="normal"><a href="#__codelineno-0-577">577</a></span>
<span class="normal"><a href="#__codelineno-0-578">578</a></span>
<span class="normal"><a href="#__codelineno-0-579">579</a></span>
<span class="normal"><a href="#__codelineno-0-580">580</a></span>
<span class="normal"><a href="#__codelineno-0-581">581</a></span>
<span class="normal"><a href="#__codelineno-0-582">582</a></span>
<span class="normal"><a href="#__codelineno-0-583">583</a></span>
<span class="normal"><a href="#__codelineno-0-584">584</a></span>
<span class="normal"><a href="#__codelineno-0-585">585</a></span>
<span class="normal"><a href="#__codelineno-0-586">586</a></span>
<span class="normal"><a href="#__codelineno-0-587">587</a></span>
<span class="normal"><a href="#__codelineno-0-588">588</a></span>
<span class="normal"><a href="#__codelineno-0-589">589</a></span>
<span class="normal"><a href="#__codelineno-0-590">590</a></span>
<span class="normal"><a href="#__codelineno-0-591">591</a></span>
<span class="normal"><a href="#__codelineno-0-592">592</a></span>
<span class="normal"><a href="#__codelineno-0-593">593</a></span>
<span class="normal"><a href="#__codelineno-0-594">594</a></span>
<span class="normal"><a href="#__codelineno-0-595">595</a></span>
<span class="normal"><a href="#__codelineno-0-596">596</a></span>
<span class="normal"><a href="#__codelineno-0-597">597</a></span>
<span class="normal"><a href="#__codelineno-0-598">598</a></span>
<span class="normal"><a href="#__codelineno-0-599">599</a></span>
<span class="normal"><a href="#__codelineno-0-600">600</a></span>
<span class="normal"><a href="#__codelineno-0-601">601</a></span>
<span class="normal"><a href="#__codelineno-0-602">602</a></span>
<span class="normal"><a href="#__codelineno-0-603">603</a></span>
<span class="normal"><a href="#__codelineno-0-604">604</a></span>
<span class="normal"><a href="#__codelineno-0-605">605</a></span>
<span class="normal"><a href="#__codelineno-0-606">606</a></span>
<span class="normal"><a href="#__codelineno-0-607">607</a></span>
<span class="normal"><a href="#__codelineno-0-608">608</a></span>
<span class="normal"><a href="#__codelineno-0-609">609</a></span>
<span class="normal"><a href="#__codelineno-0-610">610</a></span>
<span class="normal"><a href="#__codelineno-0-611">611</a></span>
<span class="normal"><a href="#__codelineno-0-612">612</a></span>
<span class="normal"><a href="#__codelineno-0-613">613</a></span>
<span class="normal"><a href="#__codelineno-0-614">614</a></span>
<span class="normal"><a href="#__codelineno-0-615">615</a></span>
<span class="normal"><a href="#__codelineno-0-616">616</a></span>
<span class="normal"><a href="#__codelineno-0-617">617</a></span>
<span class="normal"><a href="#__codelineno-0-618">618</a></span>
<span class="normal"><a href="#__codelineno-0-619">619</a></span>
<span class="normal"><a href="#__codelineno-0-620">620</a></span>
<span class="normal"><a href="#__codelineno-0-621">621</a></span>
<span class="normal"><a href="#__codelineno-0-622">622</a></span>
<span class="normal"><a href="#__codelineno-0-623">623</a></span>
<span class="normal"><a href="#__codelineno-0-624">624</a></span>
<span class="normal"><a href="#__codelineno-0-625">625</a></span>
<span class="normal"><a href="#__codelineno-0-626">626</a></span>
<span class="normal"><a href="#__codelineno-0-627">627</a></span>
<span class="normal"><a href="#__codelineno-0-628">628</a></span>
<span class="normal"><a href="#__codelineno-0-629">629</a></span>
<span class="normal"><a href="#__codelineno-0-630">630</a></span>
<span class="normal"><a href="#__codelineno-0-631">631</a></span>
<span class="normal"><a href="#__codelineno-0-632">632</a></span>
<span class="normal"><a href="#__codelineno-0-633">633</a></span>
<span class="normal"><a href="#__codelineno-0-634">634</a></span>
<span class="normal"><a href="#__codelineno-0-635">635</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-555" name="__codelineno-0-555"></a><span class="k">def</span><span class="w"> </span><span class="nf">dprime_sample_size</span><span class="p">(</span>
<a id="__codelineno-0-556" name="__codelineno-0-556"></a>    <span class="n">d_prime_a</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
<a id="__codelineno-0-557" name="__codelineno-0-557"></a>    <span class="n">method</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Protocol</span> <span class="o">=</span> <span class="s2">&quot;triangle&quot;</span><span class="p">,</span>
<a id="__codelineno-0-558" name="__codelineno-0-558"></a>    <span class="o">*</span><span class="p">,</span>
<a id="__codelineno-0-559" name="__codelineno-0-559"></a>    <span class="n">d_prime_0</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
<a id="__codelineno-0-560" name="__codelineno-0-560"></a>    <span class="n">target_power</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.90</span><span class="p">,</span>
<a id="__codelineno-0-561" name="__codelineno-0-561"></a>    <span class="n">alpha</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">,</span>
<a id="__codelineno-0-562" name="__codelineno-0-562"></a>    <span class="n">test</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;difference&quot;</span><span class="p">,</span>
<a id="__codelineno-0-563" name="__codelineno-0-563"></a>    <span class="n">statistic</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;exact&quot;</span><span class="p">,</span>
<a id="__codelineno-0-564" name="__codelineno-0-564"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<a id="__codelineno-0-565" name="__codelineno-0-565"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute required sample size using d-prime.</span>
<a id="__codelineno-0-566" name="__codelineno-0-566"></a>
<a id="__codelineno-0-567" name="__codelineno-0-567"></a><span class="sd">    This is a convenience wrapper around `discrim_sample_size()` that</span>
<a id="__codelineno-0-568" name="__codelineno-0-568"></a><span class="sd">    converts d-prime values to proportion of discriminators.</span>
<a id="__codelineno-0-569" name="__codelineno-0-569"></a>
<a id="__codelineno-0-570" name="__codelineno-0-570"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-571" name="__codelineno-0-571"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-572" name="__codelineno-0-572"></a><span class="sd">    d_prime_a : float</span>
<a id="__codelineno-0-573" name="__codelineno-0-573"></a><span class="sd">        True d-prime value (alternative hypothesis).</span>
<a id="__codelineno-0-574" name="__codelineno-0-574"></a><span class="sd">    method : str or Protocol, default &quot;triangle&quot;</span>
<a id="__codelineno-0-575" name="__codelineno-0-575"></a><span class="sd">        Discrimination protocol.</span>
<a id="__codelineno-0-576" name="__codelineno-0-576"></a><span class="sd">    d_prime_0 : float, default 0.0</span>
<a id="__codelineno-0-577" name="__codelineno-0-577"></a><span class="sd">        Null hypothesis d-prime value.</span>
<a id="__codelineno-0-578" name="__codelineno-0-578"></a><span class="sd">    target_power : float, default 0.90</span>
<a id="__codelineno-0-579" name="__codelineno-0-579"></a><span class="sd">        Desired statistical power.</span>
<a id="__codelineno-0-580" name="__codelineno-0-580"></a><span class="sd">    alpha : float, default 0.05</span>
<a id="__codelineno-0-581" name="__codelineno-0-581"></a><span class="sd">        Significance level.</span>
<a id="__codelineno-0-582" name="__codelineno-0-582"></a><span class="sd">    test : str, default &quot;difference&quot;</span>
<a id="__codelineno-0-583" name="__codelineno-0-583"></a><span class="sd">        Type of test: &quot;difference&quot; or &quot;similarity&quot;.</span>
<a id="__codelineno-0-584" name="__codelineno-0-584"></a><span class="sd">    statistic : str, default &quot;exact&quot;</span>
<a id="__codelineno-0-585" name="__codelineno-0-585"></a><span class="sd">        Method: &quot;exact&quot;, &quot;stable.exact&quot;, &quot;normal&quot;, or &quot;cont.normal&quot;.</span>
<a id="__codelineno-0-586" name="__codelineno-0-586"></a>
<a id="__codelineno-0-587" name="__codelineno-0-587"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-588" name="__codelineno-0-588"></a><span class="sd">    -------</span>
<a id="__codelineno-0-589" name="__codelineno-0-589"></a><span class="sd">    int</span>
<a id="__codelineno-0-590" name="__codelineno-0-590"></a><span class="sd">        Required sample size.</span>
<a id="__codelineno-0-591" name="__codelineno-0-591"></a>
<a id="__codelineno-0-592" name="__codelineno-0-592"></a><span class="sd">    Examples</span>
<a id="__codelineno-0-593" name="__codelineno-0-593"></a><span class="sd">    --------</span>
<a id="__codelineno-0-594" name="__codelineno-0-594"></a><span class="sd">    &gt;&gt;&gt; # Sample size for triangle test with d&#39;=1.5</span>
<a id="__codelineno-0-595" name="__codelineno-0-595"></a><span class="sd">    &gt;&gt;&gt; dprime_sample_size(d_prime_a=1.5, method=&quot;triangle&quot;)</span>
<a id="__codelineno-0-596" name="__codelineno-0-596"></a><span class="sd">    62</span>
<a id="__codelineno-0-597" name="__codelineno-0-597"></a>
<a id="__codelineno-0-598" name="__codelineno-0-598"></a><span class="sd">    &gt;&gt;&gt; # Sample size for 2-AFC test with 80% power</span>
<a id="__codelineno-0-599" name="__codelineno-0-599"></a><span class="sd">    &gt;&gt;&gt; dprime_sample_size(d_prime_a=1.0, method=&quot;twoafc&quot;, target_power=0.80)</span>
<a id="__codelineno-0-600" name="__codelineno-0-600"></a><span class="sd">    47</span>
<a id="__codelineno-0-601" name="__codelineno-0-601"></a>
<a id="__codelineno-0-602" name="__codelineno-0-602"></a><span class="sd">    Notes</span>
<a id="__codelineno-0-603" name="__codelineno-0-603"></a><span class="sd">    -----</span>
<a id="__codelineno-0-604" name="__codelineno-0-604"></a><span class="sd">    Corresponds to `d.primeSS()` in sensR.</span>
<a id="__codelineno-0-605" name="__codelineno-0-605"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-606" name="__codelineno-0-606"></a>    <span class="c1"># Validate d-prime values</span>
<a id="__codelineno-0-607" name="__codelineno-0-607"></a>    <span class="k">if</span> <span class="n">d_prime_a</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-608" name="__codelineno-0-608"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;&#39;d_prime_a&#39; must be positive&quot;</span><span class="p">)</span>
<a id="__codelineno-0-609" name="__codelineno-0-609"></a>    <span class="k">if</span> <span class="n">d_prime_0</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-610" name="__codelineno-0-610"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;&#39;d_prime_0&#39; must be non-negative&quot;</span><span class="p">)</span>
<a id="__codelineno-0-611" name="__codelineno-0-611"></a>
<a id="__codelineno-0-612" name="__codelineno-0-612"></a>    <span class="c1"># Parse protocol</span>
<a id="__codelineno-0-613" name="__codelineno-0-613"></a>    <span class="n">protocol</span> <span class="o">=</span> <span class="n">parse_protocol</span><span class="p">(</span><span class="n">method</span><span class="p">)</span>
<a id="__codelineno-0-614" name="__codelineno-0-614"></a>    <span class="n">p_guess</span> <span class="o">=</span> <span class="n">protocol</span><span class="o">.</span><span class="n">p_guess</span>
<a id="__codelineno-0-615" name="__codelineno-0-615"></a>
<a id="__codelineno-0-616" name="__codelineno-0-616"></a>    <span class="c1"># Defensive check (protocols should never have p_guess &gt;= 1)</span>
<a id="__codelineno-0-617" name="__codelineno-0-617"></a>    <span class="k">if</span> <span class="n">p_guess</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-618" name="__codelineno-0-618"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Protocol p_guess must be &lt; 1&quot;</span><span class="p">)</span>
<a id="__codelineno-0-619" name="__codelineno-0-619"></a>
<a id="__codelineno-0-620" name="__codelineno-0-620"></a>    <span class="c1"># Convert d-prime to pc, then to pd</span>
<a id="__codelineno-0-621" name="__codelineno-0-621"></a>    <span class="n">pc_a</span> <span class="o">=</span> <span class="n">psy_fun</span><span class="p">(</span><span class="n">d_prime_a</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="n">protocol</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-622" name="__codelineno-0-622"></a>    <span class="n">pc_0</span> <span class="o">=</span> <span class="n">psy_fun</span><span class="p">(</span><span class="n">d_prime_0</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="n">protocol</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-623" name="__codelineno-0-623"></a>
<a id="__codelineno-0-624" name="__codelineno-0-624"></a>    <span class="n">pd_a</span> <span class="o">=</span> <span class="p">(</span><span class="n">pc_a</span> <span class="o">-</span> <span class="n">p_guess</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">p_guess</span><span class="p">)</span>
<a id="__codelineno-0-625" name="__codelineno-0-625"></a>    <span class="n">pd_0</span> <span class="o">=</span> <span class="p">(</span><span class="n">pc_0</span> <span class="o">-</span> <span class="n">p_guess</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">p_guess</span><span class="p">)</span>
<a id="__codelineno-0-626" name="__codelineno-0-626"></a>
<a id="__codelineno-0-627" name="__codelineno-0-627"></a>    <span class="k">return</span> <span class="n">discrim_sample_size</span><span class="p">(</span>
<a id="__codelineno-0-628" name="__codelineno-0-628"></a>        <span class="n">pd_a</span><span class="o">=</span><span class="n">pd_a</span><span class="p">,</span>
<a id="__codelineno-0-629" name="__codelineno-0-629"></a>        <span class="n">pd_0</span><span class="o">=</span><span class="n">pd_0</span><span class="p">,</span>
<a id="__codelineno-0-630" name="__codelineno-0-630"></a>        <span class="n">target_power</span><span class="o">=</span><span class="n">target_power</span><span class="p">,</span>
<a id="__codelineno-0-631" name="__codelineno-0-631"></a>        <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span>
<a id="__codelineno-0-632" name="__codelineno-0-632"></a>        <span class="n">p_guess</span><span class="o">=</span><span class="n">p_guess</span><span class="p">,</span>
<a id="__codelineno-0-633" name="__codelineno-0-633"></a>        <span class="n">test</span><span class="o">=</span><span class="n">test</span><span class="p">,</span>
<a id="__codelineno-0-634" name="__codelineno-0-634"></a>        <span class="n">statistic</span><span class="o">=</span><span class="n">statistic</span><span class="p">,</span>
<a id="__codelineno-0-635" name="__codelineno-0-635"></a>    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div><h2 id="d-prime-hypothesis-testing">D-Prime Hypothesis Testing</h2>
<h3 id="dprime_test">dprime_test</h3>


<div class="doc doc-object doc-function">


<h2 id="senspy.dprime_test" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">dprime_test</span><span class="p">(</span><span class="n">correct</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span> <span class="n">total</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span> <span class="n">protocol</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span> <span class="n">conf_level</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.95</span><span class="p">,</span> <span class="n">dprime0</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">statistic</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;likelihood&#39;</span><span class="p">,</span> <span class="s1">&#39;Wald&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;likelihood&#39;</span><span class="p">,</span> <span class="n">alternative</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;difference&#39;</span><span class="p">,</span> <span class="s1">&#39;similarity&#39;</span><span class="p">,</span> <span class="s1">&#39;two.sided&#39;</span><span class="p">,</span> <span class="s1">&#39;less&#39;</span><span class="p">,</span> <span class="s1">&#39;greater&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;difference&#39;</span><span class="p">,</span> <span class="n">estim</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;ML&#39;</span><span class="p">,</span> <span class="s1">&#39;weighted_avg&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;ML&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DprimeTestResult</span></code>

</h2>


    <div class="doc doc-contents first">

        <p>Test if a common d-prime equals a specified value.</p>
<p>This function estimates a common d-prime from multiple groups (potentially
using different protocols) and tests whether it equals a specified null
hypothesis value.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>correct</code>
            </td>
            <td>
                  <code><span title="numpy.typing.ArrayLike">ArrayLike</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of correct responses in each group.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>total</code>
            </td>
            <td>
                  <code><span title="numpy.typing.ArrayLike">ArrayLike</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Total number of trials in each group.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>protocol</code>
            </td>
            <td>
                  <code><span title="numpy.typing.ArrayLike">ArrayLike</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Protocol name for each group (e.g., "triangle", "duotrio").</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>conf_level</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Confidence level for interval. Default is 0.95.</p>
              </div>
            </td>
            <td>
                  <code>0.95</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dprime0</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Null hypothesis value for d-prime. Default is 0.</p>
              </div>
            </td>
            <td>
                  <code>0.0</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>statistic</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Test statistic: "likelihood" or "Wald". Default is "likelihood".</p>
              </div>
            </td>
            <td>
                  <code>&#39;likelihood&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>alternative</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Alternative hypothesis:
- "difference" or "greater": d-prime &gt; dprime0 (default)
- "similarity" or "less": d-prime &lt; dprime0
- "two.sided": d-prime != dprime0</p>
              </div>
            </td>
            <td>
                  <code>&#39;difference&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>estim</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Estimation method: "ML" or "weighted_avg". Default is "ML".</p>
              </div>
            </td>
            <td>
                  <code>&#39;ML&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="DprimeTestResult(d_prime: float, se_d_prime: float, conf_int: tuple[float, float], conf_level: float, conf_method: str, stat_value: float, p_value: float, statistic: str, alternative: str, dprime0: float, estim: str, data: list[DprimeTableRow])

  
      dataclass
   (senspy.dprime_tests.DprimeTestResult)" href="#senspy.DprimeTestResult">DprimeTestResult</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Test results including estimate, confidence interval, and p-value.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If inputs are invalid.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">dprime_test</span><span class="p">(</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">... </span>    <span class="n">correct</span><span class="o">=</span><span class="p">[</span><span class="mi">60</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">55</span><span class="p">],</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">... </span>    <span class="n">total</span><span class="o">=</span><span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">],</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">... </span>    <span class="n">protocol</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;triangle&quot;</span><span class="p">,</span> <span class="s2">&quot;duotrio&quot;</span><span class="p">,</span> <span class="s2">&quot;twoAFC&quot;</span><span class="p">]</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="gp">... </span><span class="p">)</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Common d-prime: </span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">d_prime</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;p-value: </span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">p_value</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>senspy/dprime_tests.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-369">369</a></span>
<span class="normal"><a href="#__codelineno-0-370">370</a></span>
<span class="normal"><a href="#__codelineno-0-371">371</a></span>
<span class="normal"><a href="#__codelineno-0-372">372</a></span>
<span class="normal"><a href="#__codelineno-0-373">373</a></span>
<span class="normal"><a href="#__codelineno-0-374">374</a></span>
<span class="normal"><a href="#__codelineno-0-375">375</a></span>
<span class="normal"><a href="#__codelineno-0-376">376</a></span>
<span class="normal"><a href="#__codelineno-0-377">377</a></span>
<span class="normal"><a href="#__codelineno-0-378">378</a></span>
<span class="normal"><a href="#__codelineno-0-379">379</a></span>
<span class="normal"><a href="#__codelineno-0-380">380</a></span>
<span class="normal"><a href="#__codelineno-0-381">381</a></span>
<span class="normal"><a href="#__codelineno-0-382">382</a></span>
<span class="normal"><a href="#__codelineno-0-383">383</a></span>
<span class="normal"><a href="#__codelineno-0-384">384</a></span>
<span class="normal"><a href="#__codelineno-0-385">385</a></span>
<span class="normal"><a href="#__codelineno-0-386">386</a></span>
<span class="normal"><a href="#__codelineno-0-387">387</a></span>
<span class="normal"><a href="#__codelineno-0-388">388</a></span>
<span class="normal"><a href="#__codelineno-0-389">389</a></span>
<span class="normal"><a href="#__codelineno-0-390">390</a></span>
<span class="normal"><a href="#__codelineno-0-391">391</a></span>
<span class="normal"><a href="#__codelineno-0-392">392</a></span>
<span class="normal"><a href="#__codelineno-0-393">393</a></span>
<span class="normal"><a href="#__codelineno-0-394">394</a></span>
<span class="normal"><a href="#__codelineno-0-395">395</a></span>
<span class="normal"><a href="#__codelineno-0-396">396</a></span>
<span class="normal"><a href="#__codelineno-0-397">397</a></span>
<span class="normal"><a href="#__codelineno-0-398">398</a></span>
<span class="normal"><a href="#__codelineno-0-399">399</a></span>
<span class="normal"><a href="#__codelineno-0-400">400</a></span>
<span class="normal"><a href="#__codelineno-0-401">401</a></span>
<span class="normal"><a href="#__codelineno-0-402">402</a></span>
<span class="normal"><a href="#__codelineno-0-403">403</a></span>
<span class="normal"><a href="#__codelineno-0-404">404</a></span>
<span class="normal"><a href="#__codelineno-0-405">405</a></span>
<span class="normal"><a href="#__codelineno-0-406">406</a></span>
<span class="normal"><a href="#__codelineno-0-407">407</a></span>
<span class="normal"><a href="#__codelineno-0-408">408</a></span>
<span class="normal"><a href="#__codelineno-0-409">409</a></span>
<span class="normal"><a href="#__codelineno-0-410">410</a></span>
<span class="normal"><a href="#__codelineno-0-411">411</a></span>
<span class="normal"><a href="#__codelineno-0-412">412</a></span>
<span class="normal"><a href="#__codelineno-0-413">413</a></span>
<span class="normal"><a href="#__codelineno-0-414">414</a></span>
<span class="normal"><a href="#__codelineno-0-415">415</a></span>
<span class="normal"><a href="#__codelineno-0-416">416</a></span>
<span class="normal"><a href="#__codelineno-0-417">417</a></span>
<span class="normal"><a href="#__codelineno-0-418">418</a></span>
<span class="normal"><a href="#__codelineno-0-419">419</a></span>
<span class="normal"><a href="#__codelineno-0-420">420</a></span>
<span class="normal"><a href="#__codelineno-0-421">421</a></span>
<span class="normal"><a href="#__codelineno-0-422">422</a></span>
<span class="normal"><a href="#__codelineno-0-423">423</a></span>
<span class="normal"><a href="#__codelineno-0-424">424</a></span>
<span class="normal"><a href="#__codelineno-0-425">425</a></span>
<span class="normal"><a href="#__codelineno-0-426">426</a></span>
<span class="normal"><a href="#__codelineno-0-427">427</a></span>
<span class="normal"><a href="#__codelineno-0-428">428</a></span>
<span class="normal"><a href="#__codelineno-0-429">429</a></span>
<span class="normal"><a href="#__codelineno-0-430">430</a></span>
<span class="normal"><a href="#__codelineno-0-431">431</a></span>
<span class="normal"><a href="#__codelineno-0-432">432</a></span>
<span class="normal"><a href="#__codelineno-0-433">433</a></span>
<span class="normal"><a href="#__codelineno-0-434">434</a></span>
<span class="normal"><a href="#__codelineno-0-435">435</a></span>
<span class="normal"><a href="#__codelineno-0-436">436</a></span>
<span class="normal"><a href="#__codelineno-0-437">437</a></span>
<span class="normal"><a href="#__codelineno-0-438">438</a></span>
<span class="normal"><a href="#__codelineno-0-439">439</a></span>
<span class="normal"><a href="#__codelineno-0-440">440</a></span>
<span class="normal"><a href="#__codelineno-0-441">441</a></span>
<span class="normal"><a href="#__codelineno-0-442">442</a></span>
<span class="normal"><a href="#__codelineno-0-443">443</a></span>
<span class="normal"><a href="#__codelineno-0-444">444</a></span>
<span class="normal"><a href="#__codelineno-0-445">445</a></span>
<span class="normal"><a href="#__codelineno-0-446">446</a></span>
<span class="normal"><a href="#__codelineno-0-447">447</a></span>
<span class="normal"><a href="#__codelineno-0-448">448</a></span>
<span class="normal"><a href="#__codelineno-0-449">449</a></span>
<span class="normal"><a href="#__codelineno-0-450">450</a></span>
<span class="normal"><a href="#__codelineno-0-451">451</a></span>
<span class="normal"><a href="#__codelineno-0-452">452</a></span>
<span class="normal"><a href="#__codelineno-0-453">453</a></span>
<span class="normal"><a href="#__codelineno-0-454">454</a></span>
<span class="normal"><a href="#__codelineno-0-455">455</a></span>
<span class="normal"><a href="#__codelineno-0-456">456</a></span>
<span class="normal"><a href="#__codelineno-0-457">457</a></span>
<span class="normal"><a href="#__codelineno-0-458">458</a></span>
<span class="normal"><a href="#__codelineno-0-459">459</a></span>
<span class="normal"><a href="#__codelineno-0-460">460</a></span>
<span class="normal"><a href="#__codelineno-0-461">461</a></span>
<span class="normal"><a href="#__codelineno-0-462">462</a></span>
<span class="normal"><a href="#__codelineno-0-463">463</a></span>
<span class="normal"><a href="#__codelineno-0-464">464</a></span>
<span class="normal"><a href="#__codelineno-0-465">465</a></span>
<span class="normal"><a href="#__codelineno-0-466">466</a></span>
<span class="normal"><a href="#__codelineno-0-467">467</a></span>
<span class="normal"><a href="#__codelineno-0-468">468</a></span>
<span class="normal"><a href="#__codelineno-0-469">469</a></span>
<span class="normal"><a href="#__codelineno-0-470">470</a></span>
<span class="normal"><a href="#__codelineno-0-471">471</a></span>
<span class="normal"><a href="#__codelineno-0-472">472</a></span>
<span class="normal"><a href="#__codelineno-0-473">473</a></span>
<span class="normal"><a href="#__codelineno-0-474">474</a></span>
<span class="normal"><a href="#__codelineno-0-475">475</a></span>
<span class="normal"><a href="#__codelineno-0-476">476</a></span>
<span class="normal"><a href="#__codelineno-0-477">477</a></span>
<span class="normal"><a href="#__codelineno-0-478">478</a></span>
<span class="normal"><a href="#__codelineno-0-479">479</a></span>
<span class="normal"><a href="#__codelineno-0-480">480</a></span>
<span class="normal"><a href="#__codelineno-0-481">481</a></span>
<span class="normal"><a href="#__codelineno-0-482">482</a></span>
<span class="normal"><a href="#__codelineno-0-483">483</a></span>
<span class="normal"><a href="#__codelineno-0-484">484</a></span>
<span class="normal"><a href="#__codelineno-0-485">485</a></span>
<span class="normal"><a href="#__codelineno-0-486">486</a></span>
<span class="normal"><a href="#__codelineno-0-487">487</a></span>
<span class="normal"><a href="#__codelineno-0-488">488</a></span>
<span class="normal"><a href="#__codelineno-0-489">489</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-369" name="__codelineno-0-369"></a><span class="k">def</span><span class="w"> </span><span class="nf">dprime_test</span><span class="p">(</span>
<a id="__codelineno-0-370" name="__codelineno-0-370"></a>    <span class="n">correct</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span>
<a id="__codelineno-0-371" name="__codelineno-0-371"></a>    <span class="n">total</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span>
<a id="__codelineno-0-372" name="__codelineno-0-372"></a>    <span class="n">protocol</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span>
<a id="__codelineno-0-373" name="__codelineno-0-373"></a>    <span class="n">conf_level</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.95</span><span class="p">,</span>
<a id="__codelineno-0-374" name="__codelineno-0-374"></a>    <span class="n">dprime0</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
<a id="__codelineno-0-375" name="__codelineno-0-375"></a>    <span class="n">statistic</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;likelihood&quot;</span><span class="p">,</span> <span class="s2">&quot;Wald&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;likelihood&quot;</span><span class="p">,</span>
<a id="__codelineno-0-376" name="__codelineno-0-376"></a>    <span class="n">alternative</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span>
<a id="__codelineno-0-377" name="__codelineno-0-377"></a>        <span class="s2">&quot;difference&quot;</span><span class="p">,</span> <span class="s2">&quot;similarity&quot;</span><span class="p">,</span> <span class="s2">&quot;two.sided&quot;</span><span class="p">,</span> <span class="s2">&quot;less&quot;</span><span class="p">,</span> <span class="s2">&quot;greater&quot;</span>
<a id="__codelineno-0-378" name="__codelineno-0-378"></a>    <span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;difference&quot;</span><span class="p">,</span>
<a id="__codelineno-0-379" name="__codelineno-0-379"></a>    <span class="n">estim</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;ML&quot;</span><span class="p">,</span> <span class="s2">&quot;weighted_avg&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;ML&quot;</span><span class="p">,</span>
<a id="__codelineno-0-380" name="__codelineno-0-380"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DprimeTestResult</span><span class="p">:</span>
<a id="__codelineno-0-381" name="__codelineno-0-381"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Test if a common d-prime equals a specified value.</span>
<a id="__codelineno-0-382" name="__codelineno-0-382"></a>
<a id="__codelineno-0-383" name="__codelineno-0-383"></a><span class="sd">    This function estimates a common d-prime from multiple groups (potentially</span>
<a id="__codelineno-0-384" name="__codelineno-0-384"></a><span class="sd">    using different protocols) and tests whether it equals a specified null</span>
<a id="__codelineno-0-385" name="__codelineno-0-385"></a><span class="sd">    hypothesis value.</span>
<a id="__codelineno-0-386" name="__codelineno-0-386"></a>
<a id="__codelineno-0-387" name="__codelineno-0-387"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-388" name="__codelineno-0-388"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-389" name="__codelineno-0-389"></a><span class="sd">    correct : ArrayLike</span>
<a id="__codelineno-0-390" name="__codelineno-0-390"></a><span class="sd">        Number of correct responses in each group.</span>
<a id="__codelineno-0-391" name="__codelineno-0-391"></a><span class="sd">    total : ArrayLike</span>
<a id="__codelineno-0-392" name="__codelineno-0-392"></a><span class="sd">        Total number of trials in each group.</span>
<a id="__codelineno-0-393" name="__codelineno-0-393"></a><span class="sd">    protocol : ArrayLike</span>
<a id="__codelineno-0-394" name="__codelineno-0-394"></a><span class="sd">        Protocol name for each group (e.g., &quot;triangle&quot;, &quot;duotrio&quot;).</span>
<a id="__codelineno-0-395" name="__codelineno-0-395"></a><span class="sd">    conf_level : float</span>
<a id="__codelineno-0-396" name="__codelineno-0-396"></a><span class="sd">        Confidence level for interval. Default is 0.95.</span>
<a id="__codelineno-0-397" name="__codelineno-0-397"></a><span class="sd">    dprime0 : float</span>
<a id="__codelineno-0-398" name="__codelineno-0-398"></a><span class="sd">        Null hypothesis value for d-prime. Default is 0.</span>
<a id="__codelineno-0-399" name="__codelineno-0-399"></a><span class="sd">    statistic : str</span>
<a id="__codelineno-0-400" name="__codelineno-0-400"></a><span class="sd">        Test statistic: &quot;likelihood&quot; or &quot;Wald&quot;. Default is &quot;likelihood&quot;.</span>
<a id="__codelineno-0-401" name="__codelineno-0-401"></a><span class="sd">    alternative : str</span>
<a id="__codelineno-0-402" name="__codelineno-0-402"></a><span class="sd">        Alternative hypothesis:</span>
<a id="__codelineno-0-403" name="__codelineno-0-403"></a><span class="sd">        - &quot;difference&quot; or &quot;greater&quot;: d-prime &gt; dprime0 (default)</span>
<a id="__codelineno-0-404" name="__codelineno-0-404"></a><span class="sd">        - &quot;similarity&quot; or &quot;less&quot;: d-prime &lt; dprime0</span>
<a id="__codelineno-0-405" name="__codelineno-0-405"></a><span class="sd">        - &quot;two.sided&quot;: d-prime != dprime0</span>
<a id="__codelineno-0-406" name="__codelineno-0-406"></a><span class="sd">    estim : str</span>
<a id="__codelineno-0-407" name="__codelineno-0-407"></a><span class="sd">        Estimation method: &quot;ML&quot; or &quot;weighted_avg&quot;. Default is &quot;ML&quot;.</span>
<a id="__codelineno-0-408" name="__codelineno-0-408"></a>
<a id="__codelineno-0-409" name="__codelineno-0-409"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-410" name="__codelineno-0-410"></a><span class="sd">    -------</span>
<a id="__codelineno-0-411" name="__codelineno-0-411"></a><span class="sd">    DprimeTestResult</span>
<a id="__codelineno-0-412" name="__codelineno-0-412"></a><span class="sd">        Test results including estimate, confidence interval, and p-value.</span>
<a id="__codelineno-0-413" name="__codelineno-0-413"></a>
<a id="__codelineno-0-414" name="__codelineno-0-414"></a><span class="sd">    Raises</span>
<a id="__codelineno-0-415" name="__codelineno-0-415"></a><span class="sd">    ------</span>
<a id="__codelineno-0-416" name="__codelineno-0-416"></a><span class="sd">    ValueError</span>
<a id="__codelineno-0-417" name="__codelineno-0-417"></a><span class="sd">        If inputs are invalid.</span>
<a id="__codelineno-0-418" name="__codelineno-0-418"></a>
<a id="__codelineno-0-419" name="__codelineno-0-419"></a><span class="sd">    Examples</span>
<a id="__codelineno-0-420" name="__codelineno-0-420"></a><span class="sd">    --------</span>
<a id="__codelineno-0-421" name="__codelineno-0-421"></a><span class="sd">    &gt;&gt;&gt; result = dprime_test(</span>
<a id="__codelineno-0-422" name="__codelineno-0-422"></a><span class="sd">    ...     correct=[60, 45, 55],</span>
<a id="__codelineno-0-423" name="__codelineno-0-423"></a><span class="sd">    ...     total=[100, 100, 100],</span>
<a id="__codelineno-0-424" name="__codelineno-0-424"></a><span class="sd">    ...     protocol=[&quot;triangle&quot;, &quot;duotrio&quot;, &quot;twoAFC&quot;]</span>
<a id="__codelineno-0-425" name="__codelineno-0-425"></a><span class="sd">    ... )</span>
<a id="__codelineno-0-426" name="__codelineno-0-426"></a><span class="sd">    &gt;&gt;&gt; print(f&quot;Common d-prime: {result.d_prime:.3f}&quot;)</span>
<a id="__codelineno-0-427" name="__codelineno-0-427"></a><span class="sd">    &gt;&gt;&gt; print(f&quot;p-value: {result.p_value:.4f}&quot;)</span>
<a id="__codelineno-0-428" name="__codelineno-0-428"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-429" name="__codelineno-0-429"></a>    <span class="c1"># Map alternative names</span>
<a id="__codelineno-0-430" name="__codelineno-0-430"></a>    <span class="k">if</span> <span class="n">alternative</span> <span class="o">==</span> <span class="s2">&quot;difference&quot;</span><span class="p">:</span>
<a id="__codelineno-0-431" name="__codelineno-0-431"></a>        <span class="n">alternative</span> <span class="o">=</span> <span class="s2">&quot;greater&quot;</span>
<a id="__codelineno-0-432" name="__codelineno-0-432"></a>    <span class="k">elif</span> <span class="n">alternative</span> <span class="o">==</span> <span class="s2">&quot;similarity&quot;</span><span class="p">:</span>
<a id="__codelineno-0-433" name="__codelineno-0-433"></a>        <span class="n">alternative</span> <span class="o">=</span> <span class="s2">&quot;less&quot;</span>
<a id="__codelineno-0-434" name="__codelineno-0-434"></a>
<a id="__codelineno-0-435" name="__codelineno-0-435"></a>    <span class="c1"># Validate</span>
<a id="__codelineno-0-436" name="__codelineno-0-436"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="mi">0</span> <span class="o">&lt;</span> <span class="n">conf_level</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-437" name="__codelineno-0-437"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;conf_level must be between 0 and 1&quot;</span><span class="p">)</span>
<a id="__codelineno-0-438" name="__codelineno-0-438"></a>    <span class="k">if</span> <span class="n">dprime0</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-439" name="__codelineno-0-439"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;dprime0 must be non-negative&quot;</span><span class="p">)</span>
<a id="__codelineno-0-440" name="__codelineno-0-440"></a>    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">dprime0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span> <span class="ow">and</span> <span class="n">alternative</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;difference&quot;</span><span class="p">,</span> <span class="s2">&quot;greater&quot;</span><span class="p">]:</span>
<a id="__codelineno-0-441" name="__codelineno-0-441"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-442" name="__codelineno-0-442"></a>            <span class="s2">&quot;&#39;alternative&#39; has to be &#39;difference&#39;/&#39;greater&#39; if &#39;dprime0&#39; is 0&quot;</span>
<a id="__codelineno-0-443" name="__codelineno-0-443"></a>        <span class="p">)</span>
<a id="__codelineno-0-444" name="__codelineno-0-444"></a>
<a id="__codelineno-0-445" name="__codelineno-0-445"></a>    <span class="c1"># Get data table</span>
<a id="__codelineno-0-446" name="__codelineno-0-446"></a>    <span class="n">data</span> <span class="o">=</span> <span class="n">dprime_table</span><span class="p">(</span><span class="n">correct</span><span class="p">,</span> <span class="n">total</span><span class="p">,</span> <span class="n">protocol</span><span class="p">)</span>
<a id="__codelineno-0-447" name="__codelineno-0-447"></a>
<a id="__codelineno-0-448" name="__codelineno-0-448"></a>    <span class="c1"># Estimate common d-prime</span>
<a id="__codelineno-0-449" name="__codelineno-0-449"></a>    <span class="n">d_exp</span><span class="p">,</span> <span class="n">se_exp</span><span class="p">,</span> <span class="n">nll_exp</span> <span class="o">=</span> <span class="n">_dprime_estim</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">estim</span><span class="p">)</span>
<a id="__codelineno-0-450" name="__codelineno-0-450"></a>
<a id="__codelineno-0-451" name="__codelineno-0-451"></a>    <span class="c1"># Compute test statistic</span>
<a id="__codelineno-0-452" name="__codelineno-0-452"></a>    <span class="k">if</span> <span class="n">statistic</span> <span class="o">==</span> <span class="s2">&quot;likelihood&quot;</span><span class="p">:</span>
<a id="__codelineno-0-453" name="__codelineno-0-453"></a>        <span class="n">nll_0</span> <span class="o">=</span> <span class="n">_dprime_nll</span><span class="p">(</span><span class="n">dprime0</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
<a id="__codelineno-0-454" name="__codelineno-0-454"></a>        <span class="k">if</span> <span class="n">nll_exp</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-455" name="__codelineno-0-455"></a>            <span class="n">nll_exp</span> <span class="o">=</span> <span class="n">_dprime_nll</span><span class="p">(</span><span class="n">d_exp</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
<a id="__codelineno-0-456" name="__codelineno-0-456"></a>        <span class="n">LR</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">nll_0</span> <span class="o">-</span> <span class="n">nll_exp</span><span class="p">)</span>
<a id="__codelineno-0-457" name="__codelineno-0-457"></a>        <span class="c1"># Signed likelihood root statistic</span>
<a id="__codelineno-0-458" name="__codelineno-0-458"></a>        <span class="n">stat_value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">d_exp</span> <span class="o">-</span> <span class="n">dprime0</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">LR</span><span class="p">))</span>
<a id="__codelineno-0-459" name="__codelineno-0-459"></a>    <span class="k">else</span><span class="p">:</span>  <span class="c1"># Wald</span>
<a id="__codelineno-0-460" name="__codelineno-0-460"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isfinite</span><span class="p">([</span><span class="n">d_exp</span><span class="p">,</span> <span class="n">se_exp</span><span class="p">])):</span>
<a id="__codelineno-0-461" name="__codelineno-0-461"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-462" name="__codelineno-0-462"></a>                <span class="s2">&quot;Boundary cases occurred: use &#39;statistic = likelihood&#39; instead&quot;</span>
<a id="__codelineno-0-463" name="__codelineno-0-463"></a>            <span class="p">)</span>
<a id="__codelineno-0-464" name="__codelineno-0-464"></a>        <span class="n">stat_value</span> <span class="o">=</span> <span class="p">(</span><span class="n">d_exp</span> <span class="o">-</span> <span class="n">dprime0</span><span class="p">)</span> <span class="o">/</span> <span class="n">se_exp</span>
<a id="__codelineno-0-465" name="__codelineno-0-465"></a>
<a id="__codelineno-0-466" name="__codelineno-0-466"></a>    <span class="c1"># Compute p-value</span>
<a id="__codelineno-0-467" name="__codelineno-0-467"></a>    <span class="n">p_value</span> <span class="o">=</span> <span class="n">normal_pvalue</span><span class="p">(</span><span class="n">stat_value</span><span class="p">,</span> <span class="n">alternative</span><span class="p">)</span>
<a id="__codelineno-0-468" name="__codelineno-0-468"></a>
<a id="__codelineno-0-469" name="__codelineno-0-469"></a>    <span class="c1"># Compute Wald confidence interval</span>
<a id="__codelineno-0-470" name="__codelineno-0-470"></a>    <span class="n">alpha</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">conf_level</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
<a id="__codelineno-0-471" name="__codelineno-0-471"></a>    <span class="n">z</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">alpha</span><span class="p">)</span>
<a id="__codelineno-0-472" name="__codelineno-0-472"></a>    <span class="n">ci_lower</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">d_exp</span> <span class="o">-</span> <span class="n">z</span> <span class="o">*</span> <span class="n">se_exp</span><span class="p">)</span> <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isfinite</span><span class="p">(</span><span class="n">se_exp</span><span class="p">)</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
<a id="__codelineno-0-473" name="__codelineno-0-473"></a>    <span class="n">ci_upper</span> <span class="o">=</span> <span class="n">d_exp</span> <span class="o">+</span> <span class="n">z</span> <span class="o">*</span> <span class="n">se_exp</span> <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isfinite</span><span class="p">(</span><span class="n">se_exp</span><span class="p">)</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
<a id="__codelineno-0-474" name="__codelineno-0-474"></a>    <span class="n">conf_int</span> <span class="o">=</span> <span class="p">(</span><span class="n">ci_lower</span><span class="p">,</span> <span class="n">ci_upper</span><span class="p">)</span>
<a id="__codelineno-0-475" name="__codelineno-0-475"></a>
<a id="__codelineno-0-476" name="__codelineno-0-476"></a>    <span class="k">return</span> <span class="n">DprimeTestResult</span><span class="p">(</span>
<a id="__codelineno-0-477" name="__codelineno-0-477"></a>        <span class="n">d_prime</span><span class="o">=</span><span class="n">d_exp</span><span class="p">,</span>
<a id="__codelineno-0-478" name="__codelineno-0-478"></a>        <span class="n">se_d_prime</span><span class="o">=</span><span class="n">se_exp</span><span class="p">,</span>
<a id="__codelineno-0-479" name="__codelineno-0-479"></a>        <span class="n">conf_int</span><span class="o">=</span><span class="n">conf_int</span><span class="p">,</span>
<a id="__codelineno-0-480" name="__codelineno-0-480"></a>        <span class="n">conf_level</span><span class="o">=</span><span class="n">conf_level</span><span class="p">,</span>
<a id="__codelineno-0-481" name="__codelineno-0-481"></a>        <span class="n">conf_method</span><span class="o">=</span><span class="s2">&quot;Wald&quot;</span><span class="p">,</span>
<a id="__codelineno-0-482" name="__codelineno-0-482"></a>        <span class="n">stat_value</span><span class="o">=</span><span class="n">stat_value</span><span class="p">,</span>
<a id="__codelineno-0-483" name="__codelineno-0-483"></a>        <span class="n">p_value</span><span class="o">=</span><span class="n">p_value</span><span class="p">,</span>
<a id="__codelineno-0-484" name="__codelineno-0-484"></a>        <span class="n">statistic</span><span class="o">=</span><span class="n">statistic</span><span class="p">,</span>
<a id="__codelineno-0-485" name="__codelineno-0-485"></a>        <span class="n">alternative</span><span class="o">=</span><span class="n">alternative</span><span class="p">,</span>
<a id="__codelineno-0-486" name="__codelineno-0-486"></a>        <span class="n">dprime0</span><span class="o">=</span><span class="n">dprime0</span><span class="p">,</span>
<a id="__codelineno-0-487" name="__codelineno-0-487"></a>        <span class="n">estim</span><span class="o">=</span><span class="n">estim</span><span class="p">,</span>
<a id="__codelineno-0-488" name="__codelineno-0-488"></a>        <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
<a id="__codelineno-0-489" name="__codelineno-0-489"></a>    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div><h3 id="dprime_compare">dprime_compare</h3>


<div class="doc doc-object doc-function">


<h2 id="senspy.dprime_compare" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">dprime_compare</span><span class="p">(</span><span class="n">correct</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span> <span class="n">total</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span> <span class="n">protocol</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span> <span class="n">conf_level</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.95</span><span class="p">,</span> <span class="n">statistic</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;likelihood&#39;</span><span class="p">,</span> <span class="s1">&#39;Pearson&#39;</span><span class="p">,</span> <span class="s1">&#39;Wald.p&#39;</span><span class="p">,</span> <span class="s1">&#39;Wald.d&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;likelihood&#39;</span><span class="p">,</span> <span class="n">estim</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;ML&#39;</span><span class="p">,</span> <span class="s1">&#39;weighted_avg&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;ML&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DprimeCompareResult</span></code>

</h2>


    <div class="doc doc-contents first">

        <p>Test if all d-primes are equal (any-difference test).</p>
<p>This function tests the null hypothesis that all groups share a common
d-prime value against the alternative that at least two differ.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>correct</code>
            </td>
            <td>
                  <code><span title="numpy.typing.ArrayLike">ArrayLike</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of correct responses in each group.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>total</code>
            </td>
            <td>
                  <code><span title="numpy.typing.ArrayLike">ArrayLike</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Total number of trials in each group.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>protocol</code>
            </td>
            <td>
                  <code><span title="numpy.typing.ArrayLike">ArrayLike</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Protocol name for each group.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>conf_level</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Confidence level for interval. Default is 0.95.</p>
              </div>
            </td>
            <td>
                  <code>0.95</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>statistic</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Test statistic:
- "likelihood": Likelihood ratio test (default)
- "Pearson": Pearson chi-square
- "Wald.p": Wald test on proportions
- "Wald.d": Wald test on d-primes</p>
              </div>
            </td>
            <td>
                  <code>&#39;likelihood&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>estim</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Estimation method: "ML" or "weighted_avg". Default is "ML".</p>
              </div>
            </td>
            <td>
                  <code>&#39;ML&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="DprimeCompareResult(d_prime: float, se_d_prime: float, conf_int: tuple[float, float], conf_level: float, conf_method: str, stat_value: float, df: int, p_value: float, statistic: str, estim: str, data: list[DprimeTableRow])

  
      dataclass
   (senspy.dprime_tests.DprimeCompareResult)" href="#senspy.DprimeCompareResult">DprimeCompareResult</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Test results including chi-square statistic, df, and p-value.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">dprime_compare</span><span class="p">(</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">... </span>    <span class="n">correct</span><span class="o">=</span><span class="p">[</span><span class="mi">60</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">55</span><span class="p">],</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">... </span>    <span class="n">total</span><span class="o">=</span><span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">],</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">... </span>    <span class="n">protocol</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;triangle&quot;</span><span class="p">,</span> <span class="s2">&quot;duotrio&quot;</span><span class="p">,</span> <span class="s2">&quot;twoAFC&quot;</span><span class="p">]</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="gp">... </span><span class="p">)</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Chi-square: </span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">stat_value</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">, df=</span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">df</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;p-value: </span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">p_value</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>senspy/dprime_tests.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-492">492</a></span>
<span class="normal"><a href="#__codelineno-0-493">493</a></span>
<span class="normal"><a href="#__codelineno-0-494">494</a></span>
<span class="normal"><a href="#__codelineno-0-495">495</a></span>
<span class="normal"><a href="#__codelineno-0-496">496</a></span>
<span class="normal"><a href="#__codelineno-0-497">497</a></span>
<span class="normal"><a href="#__codelineno-0-498">498</a></span>
<span class="normal"><a href="#__codelineno-0-499">499</a></span>
<span class="normal"><a href="#__codelineno-0-500">500</a></span>
<span class="normal"><a href="#__codelineno-0-501">501</a></span>
<span class="normal"><a href="#__codelineno-0-502">502</a></span>
<span class="normal"><a href="#__codelineno-0-503">503</a></span>
<span class="normal"><a href="#__codelineno-0-504">504</a></span>
<span class="normal"><a href="#__codelineno-0-505">505</a></span>
<span class="normal"><a href="#__codelineno-0-506">506</a></span>
<span class="normal"><a href="#__codelineno-0-507">507</a></span>
<span class="normal"><a href="#__codelineno-0-508">508</a></span>
<span class="normal"><a href="#__codelineno-0-509">509</a></span>
<span class="normal"><a href="#__codelineno-0-510">510</a></span>
<span class="normal"><a href="#__codelineno-0-511">511</a></span>
<span class="normal"><a href="#__codelineno-0-512">512</a></span>
<span class="normal"><a href="#__codelineno-0-513">513</a></span>
<span class="normal"><a href="#__codelineno-0-514">514</a></span>
<span class="normal"><a href="#__codelineno-0-515">515</a></span>
<span class="normal"><a href="#__codelineno-0-516">516</a></span>
<span class="normal"><a href="#__codelineno-0-517">517</a></span>
<span class="normal"><a href="#__codelineno-0-518">518</a></span>
<span class="normal"><a href="#__codelineno-0-519">519</a></span>
<span class="normal"><a href="#__codelineno-0-520">520</a></span>
<span class="normal"><a href="#__codelineno-0-521">521</a></span>
<span class="normal"><a href="#__codelineno-0-522">522</a></span>
<span class="normal"><a href="#__codelineno-0-523">523</a></span>
<span class="normal"><a href="#__codelineno-0-524">524</a></span>
<span class="normal"><a href="#__codelineno-0-525">525</a></span>
<span class="normal"><a href="#__codelineno-0-526">526</a></span>
<span class="normal"><a href="#__codelineno-0-527">527</a></span>
<span class="normal"><a href="#__codelineno-0-528">528</a></span>
<span class="normal"><a href="#__codelineno-0-529">529</a></span>
<span class="normal"><a href="#__codelineno-0-530">530</a></span>
<span class="normal"><a href="#__codelineno-0-531">531</a></span>
<span class="normal"><a href="#__codelineno-0-532">532</a></span>
<span class="normal"><a href="#__codelineno-0-533">533</a></span>
<span class="normal"><a href="#__codelineno-0-534">534</a></span>
<span class="normal"><a href="#__codelineno-0-535">535</a></span>
<span class="normal"><a href="#__codelineno-0-536">536</a></span>
<span class="normal"><a href="#__codelineno-0-537">537</a></span>
<span class="normal"><a href="#__codelineno-0-538">538</a></span>
<span class="normal"><a href="#__codelineno-0-539">539</a></span>
<span class="normal"><a href="#__codelineno-0-540">540</a></span>
<span class="normal"><a href="#__codelineno-0-541">541</a></span>
<span class="normal"><a href="#__codelineno-0-542">542</a></span>
<span class="normal"><a href="#__codelineno-0-543">543</a></span>
<span class="normal"><a href="#__codelineno-0-544">544</a></span>
<span class="normal"><a href="#__codelineno-0-545">545</a></span>
<span class="normal"><a href="#__codelineno-0-546">546</a></span>
<span class="normal"><a href="#__codelineno-0-547">547</a></span>
<span class="normal"><a href="#__codelineno-0-548">548</a></span>
<span class="normal"><a href="#__codelineno-0-549">549</a></span>
<span class="normal"><a href="#__codelineno-0-550">550</a></span>
<span class="normal"><a href="#__codelineno-0-551">551</a></span>
<span class="normal"><a href="#__codelineno-0-552">552</a></span>
<span class="normal"><a href="#__codelineno-0-553">553</a></span>
<span class="normal"><a href="#__codelineno-0-554">554</a></span>
<span class="normal"><a href="#__codelineno-0-555">555</a></span>
<span class="normal"><a href="#__codelineno-0-556">556</a></span>
<span class="normal"><a href="#__codelineno-0-557">557</a></span>
<span class="normal"><a href="#__codelineno-0-558">558</a></span>
<span class="normal"><a href="#__codelineno-0-559">559</a></span>
<span class="normal"><a href="#__codelineno-0-560">560</a></span>
<span class="normal"><a href="#__codelineno-0-561">561</a></span>
<span class="normal"><a href="#__codelineno-0-562">562</a></span>
<span class="normal"><a href="#__codelineno-0-563">563</a></span>
<span class="normal"><a href="#__codelineno-0-564">564</a></span>
<span class="normal"><a href="#__codelineno-0-565">565</a></span>
<span class="normal"><a href="#__codelineno-0-566">566</a></span>
<span class="normal"><a href="#__codelineno-0-567">567</a></span>
<span class="normal"><a href="#__codelineno-0-568">568</a></span>
<span class="normal"><a href="#__codelineno-0-569">569</a></span>
<span class="normal"><a href="#__codelineno-0-570">570</a></span>
<span class="normal"><a href="#__codelineno-0-571">571</a></span>
<span class="normal"><a href="#__codelineno-0-572">572</a></span>
<span class="normal"><a href="#__codelineno-0-573">573</a></span>
<span class="normal"><a href="#__codelineno-0-574">574</a></span>
<span class="normal"><a href="#__codelineno-0-575">575</a></span>
<span class="normal"><a href="#__codelineno-0-576">576</a></span>
<span class="normal"><a href="#__codelineno-0-577">577</a></span>
<span class="normal"><a href="#__codelineno-0-578">578</a></span>
<span class="normal"><a href="#__codelineno-0-579">579</a></span>
<span class="normal"><a href="#__codelineno-0-580">580</a></span>
<span class="normal"><a href="#__codelineno-0-581">581</a></span>
<span class="normal"><a href="#__codelineno-0-582">582</a></span>
<span class="normal"><a href="#__codelineno-0-583">583</a></span>
<span class="normal"><a href="#__codelineno-0-584">584</a></span>
<span class="normal"><a href="#__codelineno-0-585">585</a></span>
<span class="normal"><a href="#__codelineno-0-586">586</a></span>
<span class="normal"><a href="#__codelineno-0-587">587</a></span>
<span class="normal"><a href="#__codelineno-0-588">588</a></span>
<span class="normal"><a href="#__codelineno-0-589">589</a></span>
<span class="normal"><a href="#__codelineno-0-590">590</a></span>
<span class="normal"><a href="#__codelineno-0-591">591</a></span>
<span class="normal"><a href="#__codelineno-0-592">592</a></span>
<span class="normal"><a href="#__codelineno-0-593">593</a></span>
<span class="normal"><a href="#__codelineno-0-594">594</a></span>
<span class="normal"><a href="#__codelineno-0-595">595</a></span>
<span class="normal"><a href="#__codelineno-0-596">596</a></span>
<span class="normal"><a href="#__codelineno-0-597">597</a></span>
<span class="normal"><a href="#__codelineno-0-598">598</a></span>
<span class="normal"><a href="#__codelineno-0-599">599</a></span>
<span class="normal"><a href="#__codelineno-0-600">600</a></span>
<span class="normal"><a href="#__codelineno-0-601">601</a></span>
<span class="normal"><a href="#__codelineno-0-602">602</a></span>
<span class="normal"><a href="#__codelineno-0-603">603</a></span>
<span class="normal"><a href="#__codelineno-0-604">604</a></span>
<span class="normal"><a href="#__codelineno-0-605">605</a></span>
<span class="normal"><a href="#__codelineno-0-606">606</a></span>
<span class="normal"><a href="#__codelineno-0-607">607</a></span>
<span class="normal"><a href="#__codelineno-0-608">608</a></span>
<span class="normal"><a href="#__codelineno-0-609">609</a></span>
<span class="normal"><a href="#__codelineno-0-610">610</a></span>
<span class="normal"><a href="#__codelineno-0-611">611</a></span>
<span class="normal"><a href="#__codelineno-0-612">612</a></span>
<span class="normal"><a href="#__codelineno-0-613">613</a></span>
<span class="normal"><a href="#__codelineno-0-614">614</a></span>
<span class="normal"><a href="#__codelineno-0-615">615</a></span>
<span class="normal"><a href="#__codelineno-0-616">616</a></span>
<span class="normal"><a href="#__codelineno-0-617">617</a></span>
<span class="normal"><a href="#__codelineno-0-618">618</a></span>
<span class="normal"><a href="#__codelineno-0-619">619</a></span>
<span class="normal"><a href="#__codelineno-0-620">620</a></span>
<span class="normal"><a href="#__codelineno-0-621">621</a></span>
<span class="normal"><a href="#__codelineno-0-622">622</a></span>
<span class="normal"><a href="#__codelineno-0-623">623</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-492" name="__codelineno-0-492"></a><span class="k">def</span><span class="w"> </span><span class="nf">dprime_compare</span><span class="p">(</span>
<a id="__codelineno-0-493" name="__codelineno-0-493"></a>    <span class="n">correct</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span>
<a id="__codelineno-0-494" name="__codelineno-0-494"></a>    <span class="n">total</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span>
<a id="__codelineno-0-495" name="__codelineno-0-495"></a>    <span class="n">protocol</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span>
<a id="__codelineno-0-496" name="__codelineno-0-496"></a>    <span class="n">conf_level</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.95</span><span class="p">,</span>
<a id="__codelineno-0-497" name="__codelineno-0-497"></a>    <span class="n">statistic</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;likelihood&quot;</span><span class="p">,</span> <span class="s2">&quot;Pearson&quot;</span><span class="p">,</span> <span class="s2">&quot;Wald.p&quot;</span><span class="p">,</span> <span class="s2">&quot;Wald.d&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;likelihood&quot;</span><span class="p">,</span>
<a id="__codelineno-0-498" name="__codelineno-0-498"></a>    <span class="n">estim</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;ML&quot;</span><span class="p">,</span> <span class="s2">&quot;weighted_avg&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;ML&quot;</span><span class="p">,</span>
<a id="__codelineno-0-499" name="__codelineno-0-499"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DprimeCompareResult</span><span class="p">:</span>
<a id="__codelineno-0-500" name="__codelineno-0-500"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Test if all d-primes are equal (any-difference test).</span>
<a id="__codelineno-0-501" name="__codelineno-0-501"></a>
<a id="__codelineno-0-502" name="__codelineno-0-502"></a><span class="sd">    This function tests the null hypothesis that all groups share a common</span>
<a id="__codelineno-0-503" name="__codelineno-0-503"></a><span class="sd">    d-prime value against the alternative that at least two differ.</span>
<a id="__codelineno-0-504" name="__codelineno-0-504"></a>
<a id="__codelineno-0-505" name="__codelineno-0-505"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-506" name="__codelineno-0-506"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-507" name="__codelineno-0-507"></a><span class="sd">    correct : ArrayLike</span>
<a id="__codelineno-0-508" name="__codelineno-0-508"></a><span class="sd">        Number of correct responses in each group.</span>
<a id="__codelineno-0-509" name="__codelineno-0-509"></a><span class="sd">    total : ArrayLike</span>
<a id="__codelineno-0-510" name="__codelineno-0-510"></a><span class="sd">        Total number of trials in each group.</span>
<a id="__codelineno-0-511" name="__codelineno-0-511"></a><span class="sd">    protocol : ArrayLike</span>
<a id="__codelineno-0-512" name="__codelineno-0-512"></a><span class="sd">        Protocol name for each group.</span>
<a id="__codelineno-0-513" name="__codelineno-0-513"></a><span class="sd">    conf_level : float</span>
<a id="__codelineno-0-514" name="__codelineno-0-514"></a><span class="sd">        Confidence level for interval. Default is 0.95.</span>
<a id="__codelineno-0-515" name="__codelineno-0-515"></a><span class="sd">    statistic : str</span>
<a id="__codelineno-0-516" name="__codelineno-0-516"></a><span class="sd">        Test statistic:</span>
<a id="__codelineno-0-517" name="__codelineno-0-517"></a><span class="sd">        - &quot;likelihood&quot;: Likelihood ratio test (default)</span>
<a id="__codelineno-0-518" name="__codelineno-0-518"></a><span class="sd">        - &quot;Pearson&quot;: Pearson chi-square</span>
<a id="__codelineno-0-519" name="__codelineno-0-519"></a><span class="sd">        - &quot;Wald.p&quot;: Wald test on proportions</span>
<a id="__codelineno-0-520" name="__codelineno-0-520"></a><span class="sd">        - &quot;Wald.d&quot;: Wald test on d-primes</span>
<a id="__codelineno-0-521" name="__codelineno-0-521"></a><span class="sd">    estim : str</span>
<a id="__codelineno-0-522" name="__codelineno-0-522"></a><span class="sd">        Estimation method: &quot;ML&quot; or &quot;weighted_avg&quot;. Default is &quot;ML&quot;.</span>
<a id="__codelineno-0-523" name="__codelineno-0-523"></a>
<a id="__codelineno-0-524" name="__codelineno-0-524"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-525" name="__codelineno-0-525"></a><span class="sd">    -------</span>
<a id="__codelineno-0-526" name="__codelineno-0-526"></a><span class="sd">    DprimeCompareResult</span>
<a id="__codelineno-0-527" name="__codelineno-0-527"></a><span class="sd">        Test results including chi-square statistic, df, and p-value.</span>
<a id="__codelineno-0-528" name="__codelineno-0-528"></a>
<a id="__codelineno-0-529" name="__codelineno-0-529"></a><span class="sd">    Examples</span>
<a id="__codelineno-0-530" name="__codelineno-0-530"></a><span class="sd">    --------</span>
<a id="__codelineno-0-531" name="__codelineno-0-531"></a><span class="sd">    &gt;&gt;&gt; result = dprime_compare(</span>
<a id="__codelineno-0-532" name="__codelineno-0-532"></a><span class="sd">    ...     correct=[60, 45, 55],</span>
<a id="__codelineno-0-533" name="__codelineno-0-533"></a><span class="sd">    ...     total=[100, 100, 100],</span>
<a id="__codelineno-0-534" name="__codelineno-0-534"></a><span class="sd">    ...     protocol=[&quot;triangle&quot;, &quot;duotrio&quot;, &quot;twoAFC&quot;]</span>
<a id="__codelineno-0-535" name="__codelineno-0-535"></a><span class="sd">    ... )</span>
<a id="__codelineno-0-536" name="__codelineno-0-536"></a><span class="sd">    &gt;&gt;&gt; print(f&quot;Chi-square: {result.stat_value:.3f}, df={result.df}&quot;)</span>
<a id="__codelineno-0-537" name="__codelineno-0-537"></a><span class="sd">    &gt;&gt;&gt; print(f&quot;p-value: {result.p_value:.4f}&quot;)</span>
<a id="__codelineno-0-538" name="__codelineno-0-538"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-539" name="__codelineno-0-539"></a>    <span class="c1"># Validate</span>
<a id="__codelineno-0-540" name="__codelineno-0-540"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="mi">0</span> <span class="o">&lt;</span> <span class="n">conf_level</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-541" name="__codelineno-0-541"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;conf_level must be between 0 and 1&quot;</span><span class="p">)</span>
<a id="__codelineno-0-542" name="__codelineno-0-542"></a>
<a id="__codelineno-0-543" name="__codelineno-0-543"></a>    <span class="c1"># Get data table</span>
<a id="__codelineno-0-544" name="__codelineno-0-544"></a>    <span class="n">data</span> <span class="o">=</span> <span class="n">dprime_table</span><span class="p">(</span><span class="n">correct</span><span class="p">,</span> <span class="n">total</span><span class="p">,</span> <span class="n">protocol</span><span class="p">)</span>
<a id="__codelineno-0-545" name="__codelineno-0-545"></a>    <span class="n">n_groups</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<a id="__codelineno-0-546" name="__codelineno-0-546"></a>
<a id="__codelineno-0-547" name="__codelineno-0-547"></a>    <span class="c1"># Estimate common d-prime and get test result for conf interval</span>
<a id="__codelineno-0-548" name="__codelineno-0-548"></a>    <span class="n">d_exp</span><span class="p">,</span> <span class="n">se_exp</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">_dprime_estim</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">estim</span><span class="p">)</span>
<a id="__codelineno-0-549" name="__codelineno-0-549"></a>
<a id="__codelineno-0-550" name="__codelineno-0-550"></a>    <span class="c1"># Get confidence interval from dprime_test</span>
<a id="__codelineno-0-551" name="__codelineno-0-551"></a>    <span class="n">test_result</span> <span class="o">=</span> <span class="n">dprime_test</span><span class="p">(</span>
<a id="__codelineno-0-552" name="__codelineno-0-552"></a>        <span class="n">correct</span><span class="p">,</span> <span class="n">total</span><span class="p">,</span> <span class="n">protocol</span><span class="p">,</span>
<a id="__codelineno-0-553" name="__codelineno-0-553"></a>        <span class="n">conf_level</span><span class="o">=</span><span class="n">conf_level</span><span class="p">,</span>
<a id="__codelineno-0-554" name="__codelineno-0-554"></a>        <span class="n">dprime0</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
<a id="__codelineno-0-555" name="__codelineno-0-555"></a>        <span class="n">statistic</span><span class="o">=</span><span class="s2">&quot;likelihood&quot;</span><span class="p">,</span>
<a id="__codelineno-0-556" name="__codelineno-0-556"></a>        <span class="n">estim</span><span class="o">=</span><span class="n">estim</span><span class="p">,</span>
<a id="__codelineno-0-557" name="__codelineno-0-557"></a>    <span class="p">)</span>
<a id="__codelineno-0-558" name="__codelineno-0-558"></a>
<a id="__codelineno-0-559" name="__codelineno-0-559"></a>    <span class="c1"># Compute chi-square test statistic</span>
<a id="__codelineno-0-560" name="__codelineno-0-560"></a>    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">row</span><span class="o">.</span><span class="n">correct</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">data</span><span class="p">])</span>
<a id="__codelineno-0-561" name="__codelineno-0-561"></a>    <span class="n">n</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">row</span><span class="o">.</span><span class="n">total</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">data</span><span class="p">])</span>
<a id="__codelineno-0-562" name="__codelineno-0-562"></a>    <span class="n">O</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">x</span><span class="p">,</span> <span class="n">n</span> <span class="o">-</span> <span class="n">x</span><span class="p">])</span>
<a id="__codelineno-0-563" name="__codelineno-0-563"></a>
<a id="__codelineno-0-564" name="__codelineno-0-564"></a>    <span class="n">protocols</span> <span class="o">=</span> <span class="p">[</span><span class="n">row</span><span class="o">.</span><span class="n">protocol</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">data</span><span class="p">]</span>
<a id="__codelineno-0-565" name="__codelineno-0-565"></a>
<a id="__codelineno-0-566" name="__codelineno-0-566"></a>    <span class="k">if</span> <span class="n">statistic</span> <span class="o">==</span> <span class="s2">&quot;likelihood&quot;</span><span class="p">:</span>
<a id="__codelineno-0-567" name="__codelineno-0-567"></a>        <span class="c1"># Expected counts under common d-prime</span>
<a id="__codelineno-0-568" name="__codelineno-0-568"></a>        <span class="c1"># psy_fun returns arrays, so we extract scalar values</span>
<a id="__codelineno-0-569" name="__codelineno-0-569"></a>        <span class="n">p_exp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">psy_fun</span><span class="p">(</span><span class="n">d_exp</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span><span class="o">.</span><span class="n">item</span><span class="p">()</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">protocols</span><span class="p">])</span>
<a id="__codelineno-0-570" name="__codelineno-0-570"></a>        <span class="n">E</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">n</span> <span class="o">*</span> <span class="n">p_exp</span><span class="p">,</span> <span class="n">n</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">p_exp</span><span class="p">)])</span>
<a id="__codelineno-0-571" name="__codelineno-0-571"></a>        <span class="c1"># Avoid log(0)</span>
<a id="__codelineno-0-572" name="__codelineno-0-572"></a>        <span class="n">O_safe</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">O</span><span class="p">,</span> <span class="mf">1e-10</span><span class="p">)</span>
<a id="__codelineno-0-573" name="__codelineno-0-573"></a>        <span class="n">E_safe</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="mf">1e-10</span><span class="p">)</span>
<a id="__codelineno-0-574" name="__codelineno-0-574"></a>        <span class="n">X</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">O_safe</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">O_safe</span> <span class="o">/</span> <span class="n">E_safe</span><span class="p">))</span>
<a id="__codelineno-0-575" name="__codelineno-0-575"></a>
<a id="__codelineno-0-576" name="__codelineno-0-576"></a>    <span class="k">elif</span> <span class="n">statistic</span> <span class="o">==</span> <span class="s2">&quot;Pearson&quot;</span><span class="p">:</span>
<a id="__codelineno-0-577" name="__codelineno-0-577"></a>        <span class="n">p_exp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">psy_fun</span><span class="p">(</span><span class="n">d_exp</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span><span class="o">.</span><span class="n">item</span><span class="p">()</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">protocols</span><span class="p">])</span>
<a id="__codelineno-0-578" name="__codelineno-0-578"></a>        <span class="n">E</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">n</span> <span class="o">*</span> <span class="n">p_exp</span><span class="p">,</span> <span class="n">n</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">p_exp</span><span class="p">)])</span>
<a id="__codelineno-0-579" name="__codelineno-0-579"></a>        <span class="n">E_safe</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="mf">1e-10</span><span class="p">)</span>
<a id="__codelineno-0-580" name="__codelineno-0-580"></a>        <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">O</span> <span class="o">-</span> <span class="n">E</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">/</span> <span class="n">E_safe</span><span class="p">)</span>
<a id="__codelineno-0-581" name="__codelineno-0-581"></a>
<a id="__codelineno-0-582" name="__codelineno-0-582"></a>    <span class="k">elif</span> <span class="n">statistic</span> <span class="o">==</span> <span class="s2">&quot;Wald.p&quot;</span><span class="p">:</span>
<a id="__codelineno-0-583" name="__codelineno-0-583"></a>        <span class="n">p_exp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">psy_fun</span><span class="p">(</span><span class="n">d_exp</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span><span class="o">.</span><span class="n">item</span><span class="p">()</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">protocols</span><span class="p">])</span>
<a id="__codelineno-0-584" name="__codelineno-0-584"></a>        <span class="n">p_hat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">row</span><span class="o">.</span><span class="n">p_hat</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">data</span><span class="p">])</span>
<a id="__codelineno-0-585" name="__codelineno-0-585"></a>        <span class="n">var_p</span> <span class="o">=</span> <span class="n">p_hat</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">p_hat</span><span class="p">)</span> <span class="o">/</span> <span class="n">n</span>
<a id="__codelineno-0-586" name="__codelineno-0-586"></a>        <span class="n">var_p_safe</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">var_p</span><span class="p">,</span> <span class="mf">1e-10</span><span class="p">)</span>
<a id="__codelineno-0-587" name="__codelineno-0-587"></a>        <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">p_hat</span> <span class="o">-</span> <span class="n">p_exp</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">/</span> <span class="n">var_p_safe</span><span class="p">)</span>
<a id="__codelineno-0-588" name="__codelineno-0-588"></a>
<a id="__codelineno-0-589" name="__codelineno-0-589"></a>    <span class="k">elif</span> <span class="n">statistic</span> <span class="o">==</span> <span class="s2">&quot;Wald.d&quot;</span><span class="p">:</span>
<a id="__codelineno-0-590" name="__codelineno-0-590"></a>        <span class="n">dprimes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">row</span><span class="o">.</span><span class="n">dprime</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">data</span><span class="p">])</span>
<a id="__codelineno-0-591" name="__codelineno-0-591"></a>        <span class="n">se_dprimes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">row</span><span class="o">.</span><span class="n">se_dprime</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">data</span><span class="p">])</span>
<a id="__codelineno-0-592" name="__codelineno-0-592"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isfinite</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">dprimes</span><span class="p">,</span> <span class="n">se_dprimes</span><span class="p">]))):</span>
<a id="__codelineno-0-593" name="__codelineno-0-593"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-594" name="__codelineno-0-594"></a>                <span class="s2">&quot;Boundary cases occurred: use &#39;likelihood&#39; or &#39;Pearson&#39; instead&quot;</span>
<a id="__codelineno-0-595" name="__codelineno-0-595"></a>            <span class="p">)</span>
<a id="__codelineno-0-596" name="__codelineno-0-596"></a>        <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(((</span><span class="n">dprimes</span> <span class="o">-</span> <span class="n">d_exp</span><span class="p">)</span> <span class="o">/</span> <span class="n">se_dprimes</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
<a id="__codelineno-0-597" name="__codelineno-0-597"></a>
<a id="__codelineno-0-598" name="__codelineno-0-598"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-599" name="__codelineno-0-599"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unknown statistic: </span><span class="si">{</span><span class="n">statistic</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-600" name="__codelineno-0-600"></a>
<a id="__codelineno-0-601" name="__codelineno-0-601"></a>    <span class="c1"># Degrees of freedom</span>
<a id="__codelineno-0-602" name="__codelineno-0-602"></a>    <span class="n">df</span> <span class="o">=</span> <span class="n">n_groups</span> <span class="o">-</span> <span class="mi">1</span>
<a id="__codelineno-0-603" name="__codelineno-0-603"></a>
<a id="__codelineno-0-604" name="__codelineno-0-604"></a>    <span class="c1"># P-value from chi-square distribution</span>
<a id="__codelineno-0-605" name="__codelineno-0-605"></a>    <span class="k">if</span> <span class="n">df</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-606" name="__codelineno-0-606"></a>        <span class="kn">from</span><span class="w"> </span><span class="nn">scipy.stats</span><span class="w"> </span><span class="kn">import</span> <span class="n">chi2</span>
<a id="__codelineno-0-607" name="__codelineno-0-607"></a>        <span class="n">p_value</span> <span class="o">=</span> <span class="n">chi2</span><span class="o">.</span><span class="n">sf</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">df</span><span class="p">)</span>
<a id="__codelineno-0-608" name="__codelineno-0-608"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-609" name="__codelineno-0-609"></a>        <span class="n">p_value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
<a id="__codelineno-0-610" name="__codelineno-0-610"></a>
<a id="__codelineno-0-611" name="__codelineno-0-611"></a>    <span class="k">return</span> <span class="n">DprimeCompareResult</span><span class="p">(</span>
<a id="__codelineno-0-612" name="__codelineno-0-612"></a>        <span class="n">d_prime</span><span class="o">=</span><span class="n">d_exp</span><span class="p">,</span>
<a id="__codelineno-0-613" name="__codelineno-0-613"></a>        <span class="n">se_d_prime</span><span class="o">=</span><span class="n">se_exp</span><span class="p">,</span>
<a id="__codelineno-0-614" name="__codelineno-0-614"></a>        <span class="n">conf_int</span><span class="o">=</span><span class="n">test_result</span><span class="o">.</span><span class="n">conf_int</span><span class="p">,</span>
<a id="__codelineno-0-615" name="__codelineno-0-615"></a>        <span class="n">conf_level</span><span class="o">=</span><span class="n">conf_level</span><span class="p">,</span>
<a id="__codelineno-0-616" name="__codelineno-0-616"></a>        <span class="n">conf_method</span><span class="o">=</span><span class="n">test_result</span><span class="o">.</span><span class="n">conf_method</span><span class="p">,</span>
<a id="__codelineno-0-617" name="__codelineno-0-617"></a>        <span class="n">stat_value</span><span class="o">=</span><span class="n">X</span><span class="p">,</span>
<a id="__codelineno-0-618" name="__codelineno-0-618"></a>        <span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">,</span>
<a id="__codelineno-0-619" name="__codelineno-0-619"></a>        <span class="n">p_value</span><span class="o">=</span><span class="n">p_value</span><span class="p">,</span>
<a id="__codelineno-0-620" name="__codelineno-0-620"></a>        <span class="n">statistic</span><span class="o">=</span><span class="n">statistic</span><span class="p">,</span>
<a id="__codelineno-0-621" name="__codelineno-0-621"></a>        <span class="n">estim</span><span class="o">=</span><span class="n">estim</span><span class="p">,</span>
<a id="__codelineno-0-622" name="__codelineno-0-622"></a>        <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
<a id="__codelineno-0-623" name="__codelineno-0-623"></a>    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div><h3 id="posthoc">posthoc</h3>


<div class="doc doc-object doc-function">


<h2 id="senspy.posthoc" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">posthoc</span><span class="p">(</span><span class="n">result</span><span class="p">:</span> <span class="n">DprimeCompareResult</span> <span class="o">|</span> <span class="n">DprimeTestResult</span><span class="p">,</span> <span class="n">alpha</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">,</span> <span class="n">test</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;pairwise&#39;</span><span class="p">,</span> <span class="s1">&#39;common&#39;</span><span class="p">,</span> <span class="s1">&#39;base&#39;</span><span class="p">,</span> <span class="s1">&#39;zero&#39;</span><span class="p">]</span> <span class="o">|</span> <span class="nb">float</span> <span class="o">=</span> <span class="s1">&#39;pairwise&#39;</span><span class="p">,</span> <span class="n">base</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">alternative</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;two.sided&#39;</span><span class="p">,</span> <span class="s1">&#39;less&#39;</span><span class="p">,</span> <span class="s1">&#39;greater&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;two.sided&#39;</span><span class="p">,</span> <span class="n">statistic</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;likelihood&#39;</span><span class="p">,</span> <span class="s1">&#39;Wald&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;likelihood&#39;</span><span class="p">,</span> <span class="n">padj_method</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;holm&#39;</span><span class="p">,</span> <span class="s1">&#39;bonferroni&#39;</span><span class="p">,</span> <span class="s1">&#39;none&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;holm&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PosthocResult</span></code>

</h2>


    <div class="doc doc-contents first">

        <p>Perform post-hoc comparisons of d-primes.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>result</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="DprimeCompareResult(d_prime: float, se_d_prime: float, conf_int: tuple[float, float], conf_level: float, conf_method: str, stat_value: float, df: int, p_value: float, statistic: str, estim: str, data: list[DprimeTableRow])

  
      dataclass
   (senspy.dprime_tests.DprimeCompareResult)" href="#senspy.DprimeCompareResult">DprimeCompareResult</a> | <a class="autorefs autorefs-internal" title="DprimeTestResult(d_prime: float, se_d_prime: float, conf_int: tuple[float, float], conf_level: float, conf_method: str, stat_value: float, p_value: float, statistic: str, alternative: str, dprime0: float, estim: str, data: list[DprimeTableRow])

  
      dataclass
   (senspy.dprime_tests.DprimeTestResult)" href="#senspy.DprimeTestResult">DprimeTestResult</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Result from dprime_compare() or dprime_test().</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>alpha</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Significance level for letter display. Default is 0.05.</p>
              </div>
            </td>
            <td>
                  <code>0.05</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>test</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Type of comparison:
- "pairwise": All pairwise differences
- "common": Compare each to common d-prime
- "base": Compare each to base group
- "zero": Compare each to zero
- float: Compare each to this value</p>
              </div>
            </td>
            <td>
                  <code>&#39;pairwise&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>base</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Index of base group (1-indexed) for "base" test. Default is 1.</p>
              </div>
            </td>
            <td>
                  <code>1</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>alternative</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Alternative hypothesis. Default is "two.sided".</p>
              </div>
            </td>
            <td>
                  <code>&#39;two.sided&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>statistic</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Test statistic. Default is "likelihood".</p>
              </div>
            </td>
            <td>
                  <code>&#39;likelihood&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>padj_method</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>P-value adjustment method. Default is "holm".</p>
              </div>
            </td>
            <td>
                  <code>&#39;holm&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="PosthocResult(posthoc: list[dict], test: str, alternative: str, padj_method: str, letters: dict[str, str] | None, base_result: DprimeCompareResult | DprimeTestResult)

  
      dataclass
   (senspy.dprime_tests.PosthocResult)" href="#senspy.PosthocResult">PosthocResult</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Post-hoc comparison results.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>senspy/dprime_tests.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-749">749</a></span>
<span class="normal"><a href="#__codelineno-0-750">750</a></span>
<span class="normal"><a href="#__codelineno-0-751">751</a></span>
<span class="normal"><a href="#__codelineno-0-752">752</a></span>
<span class="normal"><a href="#__codelineno-0-753">753</a></span>
<span class="normal"><a href="#__codelineno-0-754">754</a></span>
<span class="normal"><a href="#__codelineno-0-755">755</a></span>
<span class="normal"><a href="#__codelineno-0-756">756</a></span>
<span class="normal"><a href="#__codelineno-0-757">757</a></span>
<span class="normal"><a href="#__codelineno-0-758">758</a></span>
<span class="normal"><a href="#__codelineno-0-759">759</a></span>
<span class="normal"><a href="#__codelineno-0-760">760</a></span>
<span class="normal"><a href="#__codelineno-0-761">761</a></span>
<span class="normal"><a href="#__codelineno-0-762">762</a></span>
<span class="normal"><a href="#__codelineno-0-763">763</a></span>
<span class="normal"><a href="#__codelineno-0-764">764</a></span>
<span class="normal"><a href="#__codelineno-0-765">765</a></span>
<span class="normal"><a href="#__codelineno-0-766">766</a></span>
<span class="normal"><a href="#__codelineno-0-767">767</a></span>
<span class="normal"><a href="#__codelineno-0-768">768</a></span>
<span class="normal"><a href="#__codelineno-0-769">769</a></span>
<span class="normal"><a href="#__codelineno-0-770">770</a></span>
<span class="normal"><a href="#__codelineno-0-771">771</a></span>
<span class="normal"><a href="#__codelineno-0-772">772</a></span>
<span class="normal"><a href="#__codelineno-0-773">773</a></span>
<span class="normal"><a href="#__codelineno-0-774">774</a></span>
<span class="normal"><a href="#__codelineno-0-775">775</a></span>
<span class="normal"><a href="#__codelineno-0-776">776</a></span>
<span class="normal"><a href="#__codelineno-0-777">777</a></span>
<span class="normal"><a href="#__codelineno-0-778">778</a></span>
<span class="normal"><a href="#__codelineno-0-779">779</a></span>
<span class="normal"><a href="#__codelineno-0-780">780</a></span>
<span class="normal"><a href="#__codelineno-0-781">781</a></span>
<span class="normal"><a href="#__codelineno-0-782">782</a></span>
<span class="normal"><a href="#__codelineno-0-783">783</a></span>
<span class="normal"><a href="#__codelineno-0-784">784</a></span>
<span class="normal"><a href="#__codelineno-0-785">785</a></span>
<span class="normal"><a href="#__codelineno-0-786">786</a></span>
<span class="normal"><a href="#__codelineno-0-787">787</a></span>
<span class="normal"><a href="#__codelineno-0-788">788</a></span>
<span class="normal"><a href="#__codelineno-0-789">789</a></span>
<span class="normal"><a href="#__codelineno-0-790">790</a></span>
<span class="normal"><a href="#__codelineno-0-791">791</a></span>
<span class="normal"><a href="#__codelineno-0-792">792</a></span>
<span class="normal"><a href="#__codelineno-0-793">793</a></span>
<span class="normal"><a href="#__codelineno-0-794">794</a></span>
<span class="normal"><a href="#__codelineno-0-795">795</a></span>
<span class="normal"><a href="#__codelineno-0-796">796</a></span>
<span class="normal"><a href="#__codelineno-0-797">797</a></span>
<span class="normal"><a href="#__codelineno-0-798">798</a></span>
<span class="normal"><a href="#__codelineno-0-799">799</a></span>
<span class="normal"><a href="#__codelineno-0-800">800</a></span>
<span class="normal"><a href="#__codelineno-0-801">801</a></span>
<span class="normal"><a href="#__codelineno-0-802">802</a></span>
<span class="normal"><a href="#__codelineno-0-803">803</a></span>
<span class="normal"><a href="#__codelineno-0-804">804</a></span>
<span class="normal"><a href="#__codelineno-0-805">805</a></span>
<span class="normal"><a href="#__codelineno-0-806">806</a></span>
<span class="normal"><a href="#__codelineno-0-807">807</a></span>
<span class="normal"><a href="#__codelineno-0-808">808</a></span>
<span class="normal"><a href="#__codelineno-0-809">809</a></span>
<span class="normal"><a href="#__codelineno-0-810">810</a></span>
<span class="normal"><a href="#__codelineno-0-811">811</a></span>
<span class="normal"><a href="#__codelineno-0-812">812</a></span>
<span class="normal"><a href="#__codelineno-0-813">813</a></span>
<span class="normal"><a href="#__codelineno-0-814">814</a></span>
<span class="normal"><a href="#__codelineno-0-815">815</a></span>
<span class="normal"><a href="#__codelineno-0-816">816</a></span>
<span class="normal"><a href="#__codelineno-0-817">817</a></span>
<span class="normal"><a href="#__codelineno-0-818">818</a></span>
<span class="normal"><a href="#__codelineno-0-819">819</a></span>
<span class="normal"><a href="#__codelineno-0-820">820</a></span>
<span class="normal"><a href="#__codelineno-0-821">821</a></span>
<span class="normal"><a href="#__codelineno-0-822">822</a></span>
<span class="normal"><a href="#__codelineno-0-823">823</a></span>
<span class="normal"><a href="#__codelineno-0-824">824</a></span>
<span class="normal"><a href="#__codelineno-0-825">825</a></span>
<span class="normal"><a href="#__codelineno-0-826">826</a></span>
<span class="normal"><a href="#__codelineno-0-827">827</a></span>
<span class="normal"><a href="#__codelineno-0-828">828</a></span>
<span class="normal"><a href="#__codelineno-0-829">829</a></span>
<span class="normal"><a href="#__codelineno-0-830">830</a></span>
<span class="normal"><a href="#__codelineno-0-831">831</a></span>
<span class="normal"><a href="#__codelineno-0-832">832</a></span>
<span class="normal"><a href="#__codelineno-0-833">833</a></span>
<span class="normal"><a href="#__codelineno-0-834">834</a></span>
<span class="normal"><a href="#__codelineno-0-835">835</a></span>
<span class="normal"><a href="#__codelineno-0-836">836</a></span>
<span class="normal"><a href="#__codelineno-0-837">837</a></span>
<span class="normal"><a href="#__codelineno-0-838">838</a></span>
<span class="normal"><a href="#__codelineno-0-839">839</a></span>
<span class="normal"><a href="#__codelineno-0-840">840</a></span>
<span class="normal"><a href="#__codelineno-0-841">841</a></span>
<span class="normal"><a href="#__codelineno-0-842">842</a></span>
<span class="normal"><a href="#__codelineno-0-843">843</a></span>
<span class="normal"><a href="#__codelineno-0-844">844</a></span>
<span class="normal"><a href="#__codelineno-0-845">845</a></span>
<span class="normal"><a href="#__codelineno-0-846">846</a></span>
<span class="normal"><a href="#__codelineno-0-847">847</a></span>
<span class="normal"><a href="#__codelineno-0-848">848</a></span>
<span class="normal"><a href="#__codelineno-0-849">849</a></span>
<span class="normal"><a href="#__codelineno-0-850">850</a></span>
<span class="normal"><a href="#__codelineno-0-851">851</a></span>
<span class="normal"><a href="#__codelineno-0-852">852</a></span>
<span class="normal"><a href="#__codelineno-0-853">853</a></span>
<span class="normal"><a href="#__codelineno-0-854">854</a></span>
<span class="normal"><a href="#__codelineno-0-855">855</a></span>
<span class="normal"><a href="#__codelineno-0-856">856</a></span>
<span class="normal"><a href="#__codelineno-0-857">857</a></span>
<span class="normal"><a href="#__codelineno-0-858">858</a></span>
<span class="normal"><a href="#__codelineno-0-859">859</a></span>
<span class="normal"><a href="#__codelineno-0-860">860</a></span>
<span class="normal"><a href="#__codelineno-0-861">861</a></span>
<span class="normal"><a href="#__codelineno-0-862">862</a></span>
<span class="normal"><a href="#__codelineno-0-863">863</a></span>
<span class="normal"><a href="#__codelineno-0-864">864</a></span>
<span class="normal"><a href="#__codelineno-0-865">865</a></span>
<span class="normal"><a href="#__codelineno-0-866">866</a></span>
<span class="normal"><a href="#__codelineno-0-867">867</a></span>
<span class="normal"><a href="#__codelineno-0-868">868</a></span>
<span class="normal"><a href="#__codelineno-0-869">869</a></span>
<span class="normal"><a href="#__codelineno-0-870">870</a></span>
<span class="normal"><a href="#__codelineno-0-871">871</a></span>
<span class="normal"><a href="#__codelineno-0-872">872</a></span>
<span class="normal"><a href="#__codelineno-0-873">873</a></span>
<span class="normal"><a href="#__codelineno-0-874">874</a></span>
<span class="normal"><a href="#__codelineno-0-875">875</a></span>
<span class="normal"><a href="#__codelineno-0-876">876</a></span>
<span class="normal"><a href="#__codelineno-0-877">877</a></span>
<span class="normal"><a href="#__codelineno-0-878">878</a></span>
<span class="normal"><a href="#__codelineno-0-879">879</a></span>
<span class="normal"><a href="#__codelineno-0-880">880</a></span>
<span class="normal"><a href="#__codelineno-0-881">881</a></span>
<span class="normal"><a href="#__codelineno-0-882">882</a></span>
<span class="normal"><a href="#__codelineno-0-883">883</a></span>
<span class="normal"><a href="#__codelineno-0-884">884</a></span>
<span class="normal"><a href="#__codelineno-0-885">885</a></span>
<span class="normal"><a href="#__codelineno-0-886">886</a></span>
<span class="normal"><a href="#__codelineno-0-887">887</a></span>
<span class="normal"><a href="#__codelineno-0-888">888</a></span>
<span class="normal"><a href="#__codelineno-0-889">889</a></span>
<span class="normal"><a href="#__codelineno-0-890">890</a></span>
<span class="normal"><a href="#__codelineno-0-891">891</a></span>
<span class="normal"><a href="#__codelineno-0-892">892</a></span>
<span class="normal"><a href="#__codelineno-0-893">893</a></span>
<span class="normal"><a href="#__codelineno-0-894">894</a></span>
<span class="normal"><a href="#__codelineno-0-895">895</a></span>
<span class="normal"><a href="#__codelineno-0-896">896</a></span>
<span class="normal"><a href="#__codelineno-0-897">897</a></span>
<span class="normal"><a href="#__codelineno-0-898">898</a></span>
<span class="normal"><a href="#__codelineno-0-899">899</a></span>
<span class="normal"><a href="#__codelineno-0-900">900</a></span>
<span class="normal"><a href="#__codelineno-0-901">901</a></span>
<span class="normal"><a href="#__codelineno-0-902">902</a></span>
<span class="normal"><a href="#__codelineno-0-903">903</a></span>
<span class="normal"><a href="#__codelineno-0-904">904</a></span>
<span class="normal"><a href="#__codelineno-0-905">905</a></span>
<span class="normal"><a href="#__codelineno-0-906">906</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-749" name="__codelineno-0-749"></a><span class="k">def</span><span class="w"> </span><span class="nf">posthoc</span><span class="p">(</span>
<a id="__codelineno-0-750" name="__codelineno-0-750"></a>    <span class="n">result</span><span class="p">:</span> <span class="n">DprimeCompareResult</span> <span class="o">|</span> <span class="n">DprimeTestResult</span><span class="p">,</span>
<a id="__codelineno-0-751" name="__codelineno-0-751"></a>    <span class="n">alpha</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">,</span>
<a id="__codelineno-0-752" name="__codelineno-0-752"></a>    <span class="n">test</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;pairwise&quot;</span><span class="p">,</span> <span class="s2">&quot;common&quot;</span><span class="p">,</span> <span class="s2">&quot;base&quot;</span><span class="p">,</span> <span class="s2">&quot;zero&quot;</span><span class="p">]</span> <span class="o">|</span> <span class="nb">float</span> <span class="o">=</span> <span class="s2">&quot;pairwise&quot;</span><span class="p">,</span>
<a id="__codelineno-0-753" name="__codelineno-0-753"></a>    <span class="n">base</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
<a id="__codelineno-0-754" name="__codelineno-0-754"></a>    <span class="n">alternative</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;two.sided&quot;</span><span class="p">,</span> <span class="s2">&quot;less&quot;</span><span class="p">,</span> <span class="s2">&quot;greater&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;two.sided&quot;</span><span class="p">,</span>
<a id="__codelineno-0-755" name="__codelineno-0-755"></a>    <span class="n">statistic</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;likelihood&quot;</span><span class="p">,</span> <span class="s2">&quot;Wald&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;likelihood&quot;</span><span class="p">,</span>
<a id="__codelineno-0-756" name="__codelineno-0-756"></a>    <span class="n">padj_method</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;holm&quot;</span><span class="p">,</span> <span class="s2">&quot;bonferroni&quot;</span><span class="p">,</span> <span class="s2">&quot;none&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;holm&quot;</span><span class="p">,</span>
<a id="__codelineno-0-757" name="__codelineno-0-757"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PosthocResult</span><span class="p">:</span>
<a id="__codelineno-0-758" name="__codelineno-0-758"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Perform post-hoc comparisons of d-primes.</span>
<a id="__codelineno-0-759" name="__codelineno-0-759"></a>
<a id="__codelineno-0-760" name="__codelineno-0-760"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-761" name="__codelineno-0-761"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-762" name="__codelineno-0-762"></a><span class="sd">    result : DprimeCompareResult | DprimeTestResult</span>
<a id="__codelineno-0-763" name="__codelineno-0-763"></a><span class="sd">        Result from dprime_compare() or dprime_test().</span>
<a id="__codelineno-0-764" name="__codelineno-0-764"></a><span class="sd">    alpha : float</span>
<a id="__codelineno-0-765" name="__codelineno-0-765"></a><span class="sd">        Significance level for letter display. Default is 0.05.</span>
<a id="__codelineno-0-766" name="__codelineno-0-766"></a><span class="sd">    test : str | float</span>
<a id="__codelineno-0-767" name="__codelineno-0-767"></a><span class="sd">        Type of comparison:</span>
<a id="__codelineno-0-768" name="__codelineno-0-768"></a><span class="sd">        - &quot;pairwise&quot;: All pairwise differences</span>
<a id="__codelineno-0-769" name="__codelineno-0-769"></a><span class="sd">        - &quot;common&quot;: Compare each to common d-prime</span>
<a id="__codelineno-0-770" name="__codelineno-0-770"></a><span class="sd">        - &quot;base&quot;: Compare each to base group</span>
<a id="__codelineno-0-771" name="__codelineno-0-771"></a><span class="sd">        - &quot;zero&quot;: Compare each to zero</span>
<a id="__codelineno-0-772" name="__codelineno-0-772"></a><span class="sd">        - float: Compare each to this value</span>
<a id="__codelineno-0-773" name="__codelineno-0-773"></a><span class="sd">    base : int</span>
<a id="__codelineno-0-774" name="__codelineno-0-774"></a><span class="sd">        Index of base group (1-indexed) for &quot;base&quot; test. Default is 1.</span>
<a id="__codelineno-0-775" name="__codelineno-0-775"></a><span class="sd">    alternative : str</span>
<a id="__codelineno-0-776" name="__codelineno-0-776"></a><span class="sd">        Alternative hypothesis. Default is &quot;two.sided&quot;.</span>
<a id="__codelineno-0-777" name="__codelineno-0-777"></a><span class="sd">    statistic : str</span>
<a id="__codelineno-0-778" name="__codelineno-0-778"></a><span class="sd">        Test statistic. Default is &quot;likelihood&quot;.</span>
<a id="__codelineno-0-779" name="__codelineno-0-779"></a><span class="sd">    padj_method : str</span>
<a id="__codelineno-0-780" name="__codelineno-0-780"></a><span class="sd">        P-value adjustment method. Default is &quot;holm&quot;.</span>
<a id="__codelineno-0-781" name="__codelineno-0-781"></a>
<a id="__codelineno-0-782" name="__codelineno-0-782"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-783" name="__codelineno-0-783"></a><span class="sd">    -------</span>
<a id="__codelineno-0-784" name="__codelineno-0-784"></a><span class="sd">    PosthocResult</span>
<a id="__codelineno-0-785" name="__codelineno-0-785"></a><span class="sd">        Post-hoc comparison results.</span>
<a id="__codelineno-0-786" name="__codelineno-0-786"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-787" name="__codelineno-0-787"></a>    <span class="n">data</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">data</span>
<a id="__codelineno-0-788" name="__codelineno-0-788"></a>    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<a id="__codelineno-0-789" name="__codelineno-0-789"></a>
<a id="__codelineno-0-790" name="__codelineno-0-790"></a>    <span class="c1"># Determine dprime0 for testing</span>
<a id="__codelineno-0-791" name="__codelineno-0-791"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">test</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">))</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">test</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
<a id="__codelineno-0-792" name="__codelineno-0-792"></a>        <span class="n">dprime0</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">test</span><span class="p">)</span>
<a id="__codelineno-0-793" name="__codelineno-0-793"></a>        <span class="n">test_type</span> <span class="o">=</span> <span class="s2">&quot;value&quot;</span>
<a id="__codelineno-0-794" name="__codelineno-0-794"></a>    <span class="k">elif</span> <span class="n">test</span> <span class="o">==</span> <span class="s2">&quot;zero&quot;</span><span class="p">:</span>
<a id="__codelineno-0-795" name="__codelineno-0-795"></a>        <span class="n">dprime0</span> <span class="o">=</span> <span class="mf">0.0</span>
<a id="__codelineno-0-796" name="__codelineno-0-796"></a>        <span class="n">test_type</span> <span class="o">=</span> <span class="s2">&quot;zero&quot;</span>
<a id="__codelineno-0-797" name="__codelineno-0-797"></a>    <span class="k">elif</span> <span class="n">test</span> <span class="o">==</span> <span class="s2">&quot;base&quot;</span><span class="p">:</span>
<a id="__codelineno-0-798" name="__codelineno-0-798"></a>        <span class="n">dprime0</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">base</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">dprime</span>  <span class="c1"># 1-indexed</span>
<a id="__codelineno-0-799" name="__codelineno-0-799"></a>        <span class="n">test_type</span> <span class="o">=</span> <span class="s2">&quot;base&quot;</span>
<a id="__codelineno-0-800" name="__codelineno-0-800"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-801" name="__codelineno-0-801"></a>        <span class="n">dprime0</span> <span class="o">=</span> <span class="mf">0.0</span>
<a id="__codelineno-0-802" name="__codelineno-0-802"></a>        <span class="n">test_type</span> <span class="o">=</span> <span class="n">test</span>
<a id="__codelineno-0-803" name="__codelineno-0-803"></a>
<a id="__codelineno-0-804" name="__codelineno-0-804"></a>    <span class="n">posthoc_results</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-805" name="__codelineno-0-805"></a>    <span class="n">stat_values</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-806" name="__codelineno-0-806"></a>
<a id="__codelineno-0-807" name="__codelineno-0-807"></a>    <span class="k">if</span> <span class="n">test_type</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;pairwise&quot;</span><span class="p">,</span> <span class="s2">&quot;base&quot;</span><span class="p">]:</span>
<a id="__codelineno-0-808" name="__codelineno-0-808"></a>        <span class="c1"># Pairwise or Dunnett-style comparisons</span>
<a id="__codelineno-0-809" name="__codelineno-0-809"></a>        <span class="k">if</span> <span class="n">test_type</span> <span class="o">==</span> <span class="s2">&quot;pairwise&quot;</span><span class="p">:</span>
<a id="__codelineno-0-810" name="__codelineno-0-810"></a>            <span class="c1"># All pairs</span>
<a id="__codelineno-0-811" name="__codelineno-0-811"></a>            <span class="n">pairs</span> <span class="o">=</span> <span class="p">[(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">)]</span>
<a id="__codelineno-0-812" name="__codelineno-0-812"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-813" name="__codelineno-0-813"></a>            <span class="c1"># Compare to base</span>
<a id="__codelineno-0-814" name="__codelineno-0-814"></a>            <span class="n">pairs</span> <span class="o">=</span> <span class="p">[(</span><span class="n">base</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">if</span> <span class="n">j</span> <span class="o">!=</span> <span class="n">base</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-815" name="__codelineno-0-815"></a>
<a id="__codelineno-0-816" name="__codelineno-0-816"></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">pairs</span><span class="p">:</span>
<a id="__codelineno-0-817" name="__codelineno-0-817"></a>            <span class="n">diff</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">dprime</span> <span class="o">-</span> <span class="n">data</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">dprime</span>
<a id="__codelineno-0-818" name="__codelineno-0-818"></a>            <span class="n">se_diff</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">se_dprime</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">data</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">se_dprime</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<a id="__codelineno-0-819" name="__codelineno-0-819"></a>
<a id="__codelineno-0-820" name="__codelineno-0-820"></a>            <span class="k">if</span> <span class="n">statistic</span> <span class="o">==</span> <span class="s2">&quot;likelihood&quot;</span><span class="p">:</span>
<a id="__codelineno-0-821" name="__codelineno-0-821"></a>                <span class="c1"># Likelihood ratio for pairwise test</span>
<a id="__codelineno-0-822" name="__codelineno-0-822"></a>                <span class="c1"># Fit common model to just these two groups</span>
<a id="__codelineno-0-823" name="__codelineno-0-823"></a>                <span class="n">sub_correct</span> <span class="o">=</span> <span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">correct</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">correct</span><span class="p">]</span>
<a id="__codelineno-0-824" name="__codelineno-0-824"></a>                <span class="n">sub_total</span> <span class="o">=</span> <span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">total</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">total</span><span class="p">]</span>
<a id="__codelineno-0-825" name="__codelineno-0-825"></a>                <span class="n">sub_protocol</span> <span class="o">=</span> <span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">protocol</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">protocol</span><span class="p">]</span>
<a id="__codelineno-0-826" name="__codelineno-0-826"></a>                <span class="n">sub_data</span> <span class="o">=</span> <span class="n">dprime_table</span><span class="p">(</span><span class="n">sub_correct</span><span class="p">,</span> <span class="n">sub_total</span><span class="p">,</span> <span class="n">sub_protocol</span><span class="p">)</span>
<a id="__codelineno-0-827" name="__codelineno-0-827"></a>
<a id="__codelineno-0-828" name="__codelineno-0-828"></a>                <span class="c1"># NLL under null (common d-prime)</span>
<a id="__codelineno-0-829" name="__codelineno-0-829"></a>                <span class="n">nll_0</span> <span class="o">=</span> <span class="n">optimize</span><span class="o">.</span><span class="n">minimize_scalar</span><span class="p">(</span>
<a id="__codelineno-0-830" name="__codelineno-0-830"></a>                    <span class="k">lambda</span> <span class="n">dp</span><span class="p">:</span> <span class="n">_dprime_nll</span><span class="p">(</span><span class="n">dp</span><span class="p">,</span> <span class="n">sub_data</span><span class="p">),</span>
<a id="__codelineno-0-831" name="__codelineno-0-831"></a>                    <span class="n">bounds</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span>
<a id="__codelineno-0-832" name="__codelineno-0-832"></a>                    <span class="n">method</span><span class="o">=</span><span class="s2">&quot;bounded&quot;</span><span class="p">,</span>
<a id="__codelineno-0-833" name="__codelineno-0-833"></a>                <span class="p">)</span><span class="o">.</span><span class="n">fun</span>
<a id="__codelineno-0-834" name="__codelineno-0-834"></a>
<a id="__codelineno-0-835" name="__codelineno-0-835"></a>                <span class="c1"># NLL under alternative (separate d-primes)</span>
<a id="__codelineno-0-836" name="__codelineno-0-836"></a>                <span class="c1"># Use safe log-likelihood to handle perfect scores</span>
<a id="__codelineno-0-837" name="__codelineno-0-837"></a>                <span class="n">nll_i</span> <span class="o">=</span> <span class="o">-</span><span class="n">_safe_binomial_loglik</span><span class="p">(</span>
<a id="__codelineno-0-838" name="__codelineno-0-838"></a>                    <span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">correct</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">total</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">p_hat</span>
<a id="__codelineno-0-839" name="__codelineno-0-839"></a>                <span class="p">)</span>
<a id="__codelineno-0-840" name="__codelineno-0-840"></a>                <span class="n">nll_j</span> <span class="o">=</span> <span class="o">-</span><span class="n">_safe_binomial_loglik</span><span class="p">(</span>
<a id="__codelineno-0-841" name="__codelineno-0-841"></a>                    <span class="n">data</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">correct</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">total</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">p_hat</span>
<a id="__codelineno-0-842" name="__codelineno-0-842"></a>                <span class="p">)</span>
<a id="__codelineno-0-843" name="__codelineno-0-843"></a>                <span class="n">nll_alt</span> <span class="o">=</span> <span class="n">nll_i</span> <span class="o">+</span> <span class="n">nll_j</span>
<a id="__codelineno-0-844" name="__codelineno-0-844"></a>
<a id="__codelineno-0-845" name="__codelineno-0-845"></a>                <span class="n">LR</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">nll_alt</span> <span class="o">-</span> <span class="n">nll_0</span><span class="p">)</span>
<a id="__codelineno-0-846" name="__codelineno-0-846"></a>                <span class="n">stat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">diff</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">LR</span><span class="p">))</span>
<a id="__codelineno-0-847" name="__codelineno-0-847"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-848" name="__codelineno-0-848"></a>                <span class="n">stat</span> <span class="o">=</span> <span class="n">diff</span> <span class="o">/</span> <span class="n">se_diff</span> <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isfinite</span><span class="p">(</span><span class="n">se_diff</span><span class="p">)</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
<a id="__codelineno-0-849" name="__codelineno-0-849"></a>
<a id="__codelineno-0-850" name="__codelineno-0-850"></a>            <span class="n">stat_values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">stat</span><span class="p">)</span>
<a id="__codelineno-0-851" name="__codelineno-0-851"></a>            <span class="n">name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;group</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2"> - group</span><span class="si">{</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-852" name="__codelineno-0-852"></a>            <span class="n">posthoc_results</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
<a id="__codelineno-0-853" name="__codelineno-0-853"></a>                <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
<a id="__codelineno-0-854" name="__codelineno-0-854"></a>                <span class="s2">&quot;estimate&quot;</span><span class="p">:</span> <span class="n">diff</span><span class="p">,</span>
<a id="__codelineno-0-855" name="__codelineno-0-855"></a>                <span class="s2">&quot;se&quot;</span><span class="p">:</span> <span class="n">se_diff</span><span class="p">,</span>
<a id="__codelineno-0-856" name="__codelineno-0-856"></a>                <span class="s2">&quot;stat_value&quot;</span><span class="p">:</span> <span class="n">stat</span><span class="p">,</span>
<a id="__codelineno-0-857" name="__codelineno-0-857"></a>            <span class="p">})</span>
<a id="__codelineno-0-858" name="__codelineno-0-858"></a>
<a id="__codelineno-0-859" name="__codelineno-0-859"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-860" name="__codelineno-0-860"></a>        <span class="c1"># Compare each group to dprime0 (common, zero, or value)</span>
<a id="__codelineno-0-861" name="__codelineno-0-861"></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
<a id="__codelineno-0-862" name="__codelineno-0-862"></a>            <span class="n">diff</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">dprime</span> <span class="o">-</span> <span class="n">dprime0</span>
<a id="__codelineno-0-863" name="__codelineno-0-863"></a>            <span class="n">se</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">se_dprime</span>
<a id="__codelineno-0-864" name="__codelineno-0-864"></a>
<a id="__codelineno-0-865" name="__codelineno-0-865"></a>            <span class="k">if</span> <span class="n">statistic</span> <span class="o">==</span> <span class="s2">&quot;likelihood&quot;</span> <span class="ow">and</span> <span class="n">test_type</span> <span class="o">==</span> <span class="s2">&quot;common&quot;</span><span class="p">:</span>
<a id="__codelineno-0-866" name="__codelineno-0-866"></a>                <span class="c1"># Compare to common d-prime using likelihood</span>
<a id="__codelineno-0-867" name="__codelineno-0-867"></a>                <span class="n">sub_data</span> <span class="o">=</span> <span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
<a id="__codelineno-0-868" name="__codelineno-0-868"></a>                <span class="n">d_common</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">d_prime</span>
<a id="__codelineno-0-869" name="__codelineno-0-869"></a>                <span class="n">nll_0</span> <span class="o">=</span> <span class="n">_dprime_nll</span><span class="p">(</span><span class="n">d_common</span><span class="p">,</span> <span class="n">sub_data</span><span class="p">)</span>
<a id="__codelineno-0-870" name="__codelineno-0-870"></a>                <span class="n">nll_alt</span> <span class="o">=</span> <span class="n">_dprime_nll</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">dprime</span><span class="p">,</span> <span class="n">sub_data</span><span class="p">)</span>
<a id="__codelineno-0-871" name="__codelineno-0-871"></a>                <span class="n">LR</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">nll_alt</span> <span class="o">-</span> <span class="n">nll_0</span><span class="p">)</span>
<a id="__codelineno-0-872" name="__codelineno-0-872"></a>                <span class="n">stat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">diff</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">LR</span><span class="p">))</span>
<a id="__codelineno-0-873" name="__codelineno-0-873"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-874" name="__codelineno-0-874"></a>                <span class="n">stat</span> <span class="o">=</span> <span class="n">diff</span> <span class="o">/</span> <span class="n">se</span> <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isfinite</span><span class="p">(</span><span class="n">se</span><span class="p">)</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
<a id="__codelineno-0-875" name="__codelineno-0-875"></a>
<a id="__codelineno-0-876" name="__codelineno-0-876"></a>            <span class="n">stat_values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">stat</span><span class="p">)</span>
<a id="__codelineno-0-877" name="__codelineno-0-877"></a>            <span class="n">posthoc_results</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
<a id="__codelineno-0-878" name="__codelineno-0-878"></a>                <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;group</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
<a id="__codelineno-0-879" name="__codelineno-0-879"></a>                <span class="s2">&quot;estimate&quot;</span><span class="p">:</span> <span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">dprime</span><span class="p">,</span>
<a id="__codelineno-0-880" name="__codelineno-0-880"></a>                <span class="s2">&quot;se&quot;</span><span class="p">:</span> <span class="n">se</span><span class="p">,</span>
<a id="__codelineno-0-881" name="__codelineno-0-881"></a>                <span class="s2">&quot;stat_value&quot;</span><span class="p">:</span> <span class="n">stat</span><span class="p">,</span>
<a id="__codelineno-0-882" name="__codelineno-0-882"></a>            <span class="p">})</span>
<a id="__codelineno-0-883" name="__codelineno-0-883"></a>
<a id="__codelineno-0-884" name="__codelineno-0-884"></a>    <span class="c1"># Compute p-values</span>
<a id="__codelineno-0-885" name="__codelineno-0-885"></a>    <span class="n">pvals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">normal_pvalue</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">alternative</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">stat_values</span><span class="p">])</span>
<a id="__codelineno-0-886" name="__codelineno-0-886"></a>    <span class="n">adjusted_pvals</span> <span class="o">=</span> <span class="n">_p_adjust</span><span class="p">(</span><span class="n">pvals</span><span class="p">,</span> <span class="n">padj_method</span><span class="p">)</span>
<a id="__codelineno-0-887" name="__codelineno-0-887"></a>
<a id="__codelineno-0-888" name="__codelineno-0-888"></a>    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">res</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">posthoc_results</span><span class="p">):</span>
<a id="__codelineno-0-889" name="__codelineno-0-889"></a>        <span class="n">res</span><span class="p">[</span><span class="s2">&quot;p_value&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">adjusted_pvals</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
<a id="__codelineno-0-890" name="__codelineno-0-890"></a>
<a id="__codelineno-0-891" name="__codelineno-0-891"></a>    <span class="c1"># Generate letter display for pairwise comparisons</span>
<a id="__codelineno-0-892" name="__codelineno-0-892"></a>    <span class="n">letters</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-893" name="__codelineno-0-893"></a>    <span class="k">if</span> <span class="n">test_type</span> <span class="o">==</span> <span class="s2">&quot;pairwise&quot;</span> <span class="ow">and</span> <span class="n">alternative</span> <span class="o">==</span> <span class="s2">&quot;two.sided&quot;</span><span class="p">:</span>
<a id="__codelineno-0-894" name="__codelineno-0-894"></a>        <span class="n">signifs</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-895" name="__codelineno-0-895"></a>            <span class="n">res</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]:</span> <span class="n">res</span><span class="p">[</span><span class="s2">&quot;p_value&quot;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">alpha</span> <span class="k">for</span> <span class="n">res</span> <span class="ow">in</span> <span class="n">posthoc_results</span>
<a id="__codelineno-0-896" name="__codelineno-0-896"></a>        <span class="p">}</span>
<a id="__codelineno-0-897" name="__codelineno-0-897"></a>        <span class="n">letters</span> <span class="o">=</span> <span class="n">_get_letters</span><span class="p">(</span><span class="n">signifs</span><span class="p">)</span>
<a id="__codelineno-0-898" name="__codelineno-0-898"></a>
<a id="__codelineno-0-899" name="__codelineno-0-899"></a>    <span class="k">return</span> <span class="n">PosthocResult</span><span class="p">(</span>
<a id="__codelineno-0-900" name="__codelineno-0-900"></a>        <span class="n">posthoc</span><span class="o">=</span><span class="n">posthoc_results</span><span class="p">,</span>
<a id="__codelineno-0-901" name="__codelineno-0-901"></a>        <span class="n">test</span><span class="o">=</span><span class="n">test_type</span><span class="p">,</span>
<a id="__codelineno-0-902" name="__codelineno-0-902"></a>        <span class="n">alternative</span><span class="o">=</span><span class="n">alternative</span><span class="p">,</span>
<a id="__codelineno-0-903" name="__codelineno-0-903"></a>        <span class="n">padj_method</span><span class="o">=</span><span class="n">padj_method</span><span class="p">,</span>
<a id="__codelineno-0-904" name="__codelineno-0-904"></a>        <span class="n">letters</span><span class="o">=</span><span class="n">letters</span><span class="p">,</span>
<a id="__codelineno-0-905" name="__codelineno-0-905"></a>        <span class="n">base_result</span><span class="o">=</span><span class="n">result</span><span class="p">,</span>
<a id="__codelineno-0-906" name="__codelineno-0-906"></a>    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div><h3 id="dprime_table">dprime_table</h3>


<div class="doc doc-object doc-function">


<h2 id="senspy.dprime_table" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">dprime_table</span><span class="p">(</span><span class="n">correct</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span> <span class="n">total</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span> <span class="n">protocol</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span> <span class="n">restrict_above_guess</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">DprimeTableRow</span><span class="p">]</span></code>

</h2>


    <div class="doc doc-contents first">

        <p>Create a table of d-prime estimates for each group.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>correct</code>
            </td>
            <td>
                  <code><span title="numpy.typing.ArrayLike">ArrayLike</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of correct responses in each group.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>total</code>
            </td>
            <td>
                  <code><span title="numpy.typing.ArrayLike">ArrayLike</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Total number of trials in each group.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>protocol</code>
            </td>
            <td>
                  <code><span title="numpy.typing.ArrayLike">ArrayLike</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Protocol name for each group.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>restrict_above_guess</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, restrict p_hat to be at least p_guess. Default is True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<span title="senspy.dprime_tests.DprimeTableRow">DprimeTableRow</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of rows with per-group estimates.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If inputs are invalid.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>senspy/dprime_tests.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-166" name="__codelineno-0-166"></a><span class="k">def</span><span class="w"> </span><span class="nf">dprime_table</span><span class="p">(</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a>    <span class="n">correct</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a>    <span class="n">total</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a>    <span class="n">protocol</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a>    <span class="n">restrict_above_guess</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">DprimeTableRow</span><span class="p">]:</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a table of d-prime estimates for each group.</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a><span class="sd">    correct : ArrayLike</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a><span class="sd">        Number of correct responses in each group.</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a><span class="sd">    total : ArrayLike</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a><span class="sd">        Total number of trials in each group.</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a><span class="sd">    protocol : ArrayLike</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a><span class="sd">        Protocol name for each group.</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a><span class="sd">    restrict_above_guess : bool</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a><span class="sd">        If True, restrict p_hat to be at least p_guess. Default is True.</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a><span class="sd">    -------</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a><span class="sd">    list[DprimeTableRow]</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a><span class="sd">        List of rows with per-group estimates.</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a><span class="sd">    Raises</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a><span class="sd">    ------</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a><span class="sd">    ValueError</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a><span class="sd">        If inputs are invalid.</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a>    <span class="n">correct</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">correct</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a>    <span class="n">total</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">total</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a>    <span class="n">protocol</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">protocol</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">str</span><span class="p">)</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a>    <span class="c1"># Validate inputs</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">correct</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">total</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">protocol</span><span class="p">)):</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;correct, total, and protocol must have the same length&quot;</span><span class="p">)</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">correct</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Need at least one group&quot;</span><span class="p">)</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a>    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">correct</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">total</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">):</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid counts: need correct &gt;= 0 and total &gt; 0&quot;</span><span class="p">)</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a>    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">correct</span> <span class="o">&gt;</span> <span class="n">total</span><span class="p">):</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;correct cannot exceed total&quot;</span><span class="p">)</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a>    <span class="n">valid_protocols</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a>        <span class="s2">&quot;triangle&quot;</span><span class="p">,</span> <span class="s2">&quot;duotrio&quot;</span><span class="p">,</span> <span class="s2">&quot;threeAFC&quot;</span><span class="p">,</span> <span class="s2">&quot;twoAFC&quot;</span><span class="p">,</span> <span class="s2">&quot;tetrad&quot;</span><span class="p">,</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a>        <span class="s2">&quot;hexad&quot;</span><span class="p">,</span> <span class="s2">&quot;twofive&quot;</span><span class="p">,</span> <span class="s2">&quot;twofiveF&quot;</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a>    <span class="p">]</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a>    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">protocol</span><span class="p">:</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a>        <span class="k">if</span> <span class="n">p</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">valid_protocols</span><span class="p">:</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid protocol: </span><span class="si">{</span><span class="n">p</span><span class="si">}</span><span class="s2">. Must be one of </span><span class="si">{</span><span class="n">valid_protocols</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a>    <span class="n">rows</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">correct</span><span class="p">)):</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">correct</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a>        <span class="n">n</span> <span class="o">=</span> <span class="n">total</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a>        <span class="n">prot</span> <span class="o">=</span> <span class="n">protocol</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a>        <span class="n">p_guess</span> <span class="o">=</span> <span class="n">_get_p_guess</span><span class="p">(</span><span class="n">prot</span><span class="p">)</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a>        <span class="c1"># Compute p_hat</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a>        <span class="n">p_hat</span> <span class="o">=</span> <span class="n">x</span> <span class="o">/</span> <span class="n">n</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a>        <span class="k">if</span> <span class="n">restrict_above_guess</span> <span class="ow">and</span> <span class="n">p_hat</span> <span class="o">&lt;</span> <span class="n">p_guess</span><span class="p">:</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a>            <span class="n">p_hat</span> <span class="o">=</span> <span class="n">p_guess</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a>        <span class="n">se_p_hat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">p_hat</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">p_hat</span><span class="p">)</span> <span class="o">/</span> <span class="n">n</span><span class="p">)</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a>        <span class="c1"># Compute d-prime</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a>        <span class="n">dprime</span> <span class="o">=</span> <span class="n">psy_inv</span><span class="p">(</span><span class="n">p_hat</span><span class="p">,</span> <span class="n">prot</span><span class="p">)</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a>        <span class="c1"># Compute se(d-prime) using delta method</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a>        <span class="n">deriv</span> <span class="o">=</span> <span class="n">psy_deriv</span><span class="p">(</span><span class="n">dprime</span><span class="p">,</span> <span class="n">prot</span><span class="p">)</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a>        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isfinite</span><span class="p">(</span><span class="n">deriv</span><span class="p">)</span> <span class="ow">and</span> <span class="n">deriv</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a>            <span class="n">se_dprime</span> <span class="o">=</span> <span class="n">se_p_hat</span> <span class="o">/</span> <span class="n">deriv</span>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a>            <span class="n">se_dprime</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a>        <span class="n">rows</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a>            <span class="n">DprimeTableRow</span><span class="p">(</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a>                <span class="n">correct</span><span class="o">=</span><span class="n">x</span><span class="p">,</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a>                <span class="n">total</span><span class="o">=</span><span class="n">n</span><span class="p">,</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a>                <span class="n">protocol</span><span class="o">=</span><span class="n">prot</span><span class="p">,</span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a>                <span class="n">p_hat</span><span class="o">=</span><span class="n">p_hat</span><span class="p">,</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a>                <span class="n">se_p_hat</span><span class="o">=</span><span class="n">se_p_hat</span><span class="p">,</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a>                <span class="n">dprime</span><span class="o">=</span><span class="n">dprime</span><span class="p">,</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a>                <span class="n">se_dprime</span><span class="o">=</span><span class="n">se_dprime</span><span class="p">,</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a>            <span class="p">)</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a>        <span class="p">)</span>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a>    <span class="k">return</span> <span class="n">rows</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div><h2 id="result-classes">Result Classes</h2>
<h3 id="dprimetestresult">DprimeTestResult</h3>


<div class="doc doc-object doc-class">



<h2 id="senspy.DprimeTestResult" class="doc doc-heading">
              <code class="highlight language-python"><span class="n">DprimeTestResult</span><span class="p">(</span><span class="n">d_prime</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">se_d_prime</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">conf_int</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span> <span class="n">conf_level</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">conf_method</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">stat_value</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">p_value</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">statistic</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">alternative</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">dprime0</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">estim</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">DprimeTableRow</span><span class="p">])</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h2>


    <div class="doc doc-contents first">



        <p>Result from dprime_test function.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="senspy.DprimeTestResult.d_prime">d_prime</span></code></td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Estimated common d-prime.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="senspy.DprimeTestResult.se_d_prime">se_d_prime</span></code></td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Standard error of the common d-prime.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="senspy.DprimeTestResult.conf_int">conf_int</span></code></td>
            <td>
                  <code><span title="tuple">tuple</span>[<span title="float">float</span>, <span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Confidence interval for common d-prime.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="senspy.DprimeTestResult.conf_level">conf_level</span></code></td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Confidence level used.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="senspy.DprimeTestResult.conf_method">conf_method</span></code></td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Method used for confidence interval.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="senspy.DprimeTestResult.stat_value">stat_value</span></code></td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Value of the test statistic.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="senspy.DprimeTestResult.p_value">p_value</span></code></td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>P-value for the hypothesis test.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="senspy.DprimeTestResult.statistic">statistic</span></code></td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Type of test statistic used.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="senspy.DprimeTestResult.alternative">alternative</span></code></td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Alternative hypothesis.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="senspy.DprimeTestResult.dprime0">dprime0</span></code></td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Null hypothesis value for d-prime.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="senspy.DprimeTestResult.estim">estim</span></code></td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Estimation method used ("ML" or "weighted_avg").</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="senspy.DprimeTestResult.data">data</span></code></td>
            <td>
                  <code><span title="list">list</span>[<span title="senspy.dprime_tests.DprimeTableRow">DprimeTableRow</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The input data with per-group estimates.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>











<div class="doc doc-children">












  </div>

    </div>

</div><h3 id="dprimecompareresult">DprimeCompareResult</h3>


<div class="doc doc-object doc-class">



<h2 id="senspy.DprimeCompareResult" class="doc doc-heading">
              <code class="highlight language-python"><span class="n">DprimeCompareResult</span><span class="p">(</span><span class="n">d_prime</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">se_d_prime</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">conf_int</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span> <span class="n">conf_level</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">conf_method</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">stat_value</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">df</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">p_value</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">statistic</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">estim</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">DprimeTableRow</span><span class="p">])</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h2>


    <div class="doc doc-contents first">



        <p>Result from dprime_compare function.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="senspy.DprimeCompareResult.d_prime">d_prime</span></code></td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Estimated common d-prime.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="senspy.DprimeCompareResult.se_d_prime">se_d_prime</span></code></td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Standard error of the common d-prime.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="senspy.DprimeCompareResult.conf_int">conf_int</span></code></td>
            <td>
                  <code><span title="tuple">tuple</span>[<span title="float">float</span>, <span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Confidence interval for common d-prime.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="senspy.DprimeCompareResult.conf_level">conf_level</span></code></td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Confidence level used.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="senspy.DprimeCompareResult.conf_method">conf_method</span></code></td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Method used for confidence interval.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="senspy.DprimeCompareResult.stat_value">stat_value</span></code></td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Chi-square test statistic.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="senspy.DprimeCompareResult.df">df</span></code></td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Degrees of freedom.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="senspy.DprimeCompareResult.p_value">p_value</span></code></td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>P-value for the any-difference test.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="senspy.DprimeCompareResult.statistic">statistic</span></code></td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Type of test statistic used.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="senspy.DprimeCompareResult.estim">estim</span></code></td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Estimation method used.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="senspy.DprimeCompareResult.data">data</span></code></td>
            <td>
                  <code><span title="list">list</span>[<span title="senspy.dprime_tests.DprimeTableRow">DprimeTableRow</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The input data with per-group estimates.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>











<div class="doc doc-children">












  </div>

    </div>

</div><h3 id="posthocresult">PosthocResult</h3>


<div class="doc doc-object doc-class">



<h2 id="senspy.PosthocResult" class="doc doc-heading">
              <code class="highlight language-python"><span class="n">PosthocResult</span><span class="p">(</span><span class="n">posthoc</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">],</span> <span class="n">test</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">alternative</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">padj_method</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">letters</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span> <span class="n">base_result</span><span class="p">:</span> <span class="n">DprimeCompareResult</span> <span class="o">|</span> <span class="n">DprimeTestResult</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h2>


    <div class="doc doc-contents first">



        <p>Result from posthoc function.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="senspy.PosthocResult.posthoc">posthoc</span></code></td>
            <td>
                  <code><span title="list">list</span>[<span title="dict">dict</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Post-hoc comparison results.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="senspy.PosthocResult.test">test</span></code></td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Type of post-hoc test performed.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="senspy.PosthocResult.alternative">alternative</span></code></td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Alternative hypothesis.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="senspy.PosthocResult.padj_method">padj_method</span></code></td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>P-value adjustment method.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="senspy.PosthocResult.letters">letters</span></code></td>
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="str">str</span>] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Letter display for pairwise comparisons (if applicable).</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="senspy.PosthocResult.base_result">base_result</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="DprimeCompareResult(d_prime: float, se_d_prime: float, conf_int: tuple[float, float], conf_level: float, conf_method: str, stat_value: float, df: int, p_value: float, statistic: str, estim: str, data: list[DprimeTableRow])

  
      dataclass
   (senspy.dprime_tests.DprimeCompareResult)" href="#senspy.DprimeCompareResult">DprimeCompareResult</a> | <a class="autorefs autorefs-internal" title="DprimeTestResult(d_prime: float, se_d_prime: float, conf_int: tuple[float, float], conf_level: float, conf_method: str, stat_value: float, p_value: float, statistic: str, alternative: str, dprime0: float, estim: str, data: list[DprimeTableRow])

  
      dataclass
   (senspy.dprime_tests.DprimeTestResult)" href="#senspy.DprimeTestResult">DprimeTestResult</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The original comparison result.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>











<div class="doc doc-children">












  </div>

    </div>

</div><h3 id="dodpowerresult">DODPowerResult</h3>


<div class="doc doc-object doc-class">



<h2 id="senspy.DODPowerResult" class="doc doc-heading">
              <code class="highlight language-python"><span class="n">DODPowerResult</span><span class="p">(</span><span class="n">power</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">se_power</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">n_used</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">d_primeA</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">d_prime0</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">sample_size</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span> <span class="n">nsim</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">alpha</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">statistic</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">alternative</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">tau</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h2>


    <div class="doc doc-contents first">



        <p>Result from dod_power function.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="senspy.DODPowerResult.power">power</span></code></td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Estimated power (proportion of simulations with p &lt; alpha).</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="senspy.DODPowerResult.se_power">se_power</span></code></td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Standard error of the power estimate.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="senspy.DODPowerResult.n_used">n_used</span></code></td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of simulations used (excluding failures).</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="senspy.DODPowerResult.d_primeA">d_primeA</span></code></td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True d-prime value (alternative hypothesis).</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="senspy.DODPowerResult.d_prime0">d_prime0</span></code></td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Null hypothesis d-prime.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="senspy.DODPowerResult.sample_size">sample_size</span></code></td>
            <td>
                  <code><span title="tuple">tuple</span>[<span title="int">int</span>, <span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Sample sizes (same_pairs, diff_pairs).</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="senspy.DODPowerResult.nsim">nsim</span></code></td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Total number of simulations requested.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="senspy.DODPowerResult.alpha">alpha</span></code></td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Significance level.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="senspy.DODPowerResult.statistic">statistic</span></code></td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Test statistic used.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="senspy.DODPowerResult.alternative">alternative</span></code></td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Alternative hypothesis.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="senspy.DODPowerResult.tau">tau</span></code></td>
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Boundary parameters used for simulation.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>











<div class="doc doc-children">












  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../..", "features": ["navigation.sections", "navigation.expand", "navigation.top", "search.suggest", "search.highlight", "content.code.copy", "content.code.annotate"], "search": "../../assets/javascripts/workers/search.7a47a382.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.e71a0d61.min.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>